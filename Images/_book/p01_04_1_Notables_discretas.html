<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Distribuciones Notables I – Laboratorio Análisis de Datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./p01_03_variables_aleatorias.html" rel="prev">
<link href="./100_prisoners_boxes_fixed.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-706344d2ac0d376cb01d0c71f2a45066.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="modae.scss">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p01_basicos.html">Antes de empezar</a></li><li class="breadcrumb-item"><a href="./p01_04_1_Notables_discretas.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables I</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Laboratorio Análisis de Datos</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ricuib/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p01_basicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Antes de empezar</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p01_01_combinatoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Algunos conceptos básicos.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p01_02_probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Cálculo básico de probabilidades</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p01_03_variables_aleatorias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducción a las variables aleatorias</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p01_04_1_Notables_discretas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">4.1</span> Introducción</a></li>
  <li><a href="#distribución-bernoulli" id="toc-distribución-bernoulli" class="nav-link" data-scroll-target="#distribución-bernoulli"><span class="header-section-number">4.2</span> Distribución Bernoulli</a>
  <ul class="collapse">
  <li><a href="#resumen-v.a-con-distribución-bernoulli" id="toc-resumen-v.a-con-distribución-bernoulli" class="nav-link" data-scroll-target="#resumen-v.a-con-distribución-bernoulli"><span class="header-section-number">4.2.1</span> Resumen v.a con distribución Bernoulli</a></li>
  </ul></li>
  <li><a href="#distribución-binomial" id="toc-distribución-binomial" class="nav-link" data-scroll-target="#distribución-binomial"><span class="header-section-number">4.3</span> Distribución binomial</a>
  <ul class="collapse">
  <li><a href="#observaciones-sobre-la-distribución-binomial" id="toc-observaciones-sobre-la-distribución-binomial" class="nav-link" data-scroll-target="#observaciones-sobre-la-distribución-binomial"><span class="header-section-number">4.3.1</span> Observaciones sobre la distribución binomial</a></li>
  <li><a href="#resumen-v.a-con-distribución-binomial-bnp" id="toc-resumen-v.a-con-distribución-binomial-bnp" class="nav-link" data-scroll-target="#resumen-v.a-con-distribución-binomial-bnp"><span class="header-section-number">4.3.2</span> Resumen v.a con distribución binomial <span class="math inline">\(B(n,p)\)</span></a></li>
  <li><a href="#la-distribución-binomial-con-r" id="toc-la-distribución-binomial-con-r" class="nav-link" data-scroll-target="#la-distribución-binomial-con-r"><span class="header-section-number">4.3.3</span> La distribución binomial con R</a></li>
  <li><a href="#generación-de-muestras-aleatorias-con-r" id="toc-generación-de-muestras-aleatorias-con-r" class="nav-link" data-scroll-target="#generación-de-muestras-aleatorias-con-r"><span class="header-section-number">4.3.4</span> Generación de muestras aleatorias con R</a></li>
  <li><a href="#cálculos-distribución-binomial-con-python" id="toc-cálculos-distribución-binomial-con-python" class="nav-link" data-scroll-target="#cálculos-distribución-binomial-con-python"><span class="header-section-number">4.3.5</span> Cálculos distribución binomial con python</a></li>
  <li><a href="#cálculos-distribución-binomial-con-python-1" id="toc-cálculos-distribución-binomial-con-python-1" class="nav-link" data-scroll-target="#cálculos-distribución-binomial-con-python-1"><span class="header-section-number">4.3.6</span> Cálculos distribución binomial con python</a></li>
  <li><a href="#gráficas-de-la-distribución-binomial-con-r" id="toc-gráficas-de-la-distribución-binomial-con-r" class="nav-link" data-scroll-target="#gráficas-de-la-distribución-binomial-con-r"><span class="header-section-number">4.3.7</span> Gráficas de la distribución binomial con R</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ricuib/edit/main/p01_04_1_Notables_discretas.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/ricuib/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p01_basicos.html">Antes de empezar</a></li><li class="breadcrumb-item"><a href="./p01_04_1_Notables_discretas.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables I</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables I</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introducción" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">4.1</span> Introducción</h2>
<p>En este tema estudiaremos diversos tipos de experimentos que son muy frecuentes y algunas de las variables aleatorias asociadas a ellos.</p>
<p>Estas variables reciben distintos nombres que aplicaremos sin distinción al tipo de población del experimento a la variable o a su función de probabilidad, densidad o distribución.</p>
<p>Empezaremos con las variables aleatorias discretas que se presentan con frecuencia ya que están relacionadas con situaciones muy comunes como el número de caras en varios lanzamiento de una moneda, el número de veces que una maquina funciona hasta que se estropea, el numero de clientes en una cola,…</p>
</section>
<section id="distribución-bernoulli" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="distribución-bernoulli"><span class="header-section-number">4.2</span> Distribución Bernoulli</h2>
<div class="definition">
<div class="definition-header">
<p>Definición</p>
</div>
<div class="definition-container">
<p>Distribución Bernoulli * Consideremos un experimento con dos resultados posibles éxito (E) y fracaso (F). El espacio de sucesos será <span class="math inline">\(\Omega=\{E,F\}\)</span>. * Supongamos que la probabilidad de éxito es <span class="math inline">\(P(E)=p\)</span>, y naturalmente <span class="math inline">\(P(F)=1-p=q\)</span> con <span class="math inline">\(0&lt;p&lt;1\)</span>. * Consideremos la aplicación</p>
<p><span class="math display">\[
X:\Omega=\{E,F\}\to \mathbb{R}
\]</span></p>
<p>definida por</p>
<p><span class="math display">\[
X(E)=1\mbox{, }X(F)=0.
\]</span></p>
</div>
</div>
<p>Su función de probabilidad es</p>
<p><span class="math display">\[
P_{X}(x)=
\left\{
\begin{array}{ll} 1-p=q &amp; \mbox{si } x=0\\
p &amp; \mbox{si } x=1\\
0 &amp; \mbox{en cualquier otro caso}
\end{array}
\right..
\]</span></p>
<p>Su función de distribución es</p>
<p><span class="math display">\[
F_{X}(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0 &amp; \mbox{si } x&lt;0\\
1-p=q &amp; \mbox{si } 0\leq x &lt;1\\
1 &amp; \mbox{si } 1\leq x \\
\end{array}
\right..
\]</span></p>
<p>Bajo estas condiciones diremos que <span class="math inline">\(X\)</span> <strong>es una v.a. Bernoulli</strong> o que sigue una ley de <strong>distribución de probabilidad Bernoulli</strong> de parámetro <span class="math inline">\(p\)</span>.</p>
<p>Lo denotaremos por <span class="math display">\[X\sim Ber(p)\mbox{ o también } X\sim B(1,p).\]</span> A este tipo de experimentos (éxito/fracaso)se les denomina experimentos Bernoulli.</p>
<p>Su descubridor fue un científico suizo <a href="https://es.wikipedia.org/wiki/Jakob_Bernoulli">Jacob Bernoulli</a>, uno más de la conocida <a href="https://es.wikipedia.org/wiki/Familia_Bernoulli">familia de científicos suizos Bernoulli</a>.</p>
<p>Su <strong>valor esperado</strong> es</p>
<p><span class="math display">\[E(X)=\displaystyle\sum_{x=0}^1 x\cdot P(X=x)= 0\cdot(1-p)+1\cdot p=p.\]</span></p>
<p>Calculemos también <span class="math inline">\(E(X^2)\)</span></p>
<p><span class="math display">\[E(X^2)=\displaystyle\sum_{x=0}^1 x^2\cdot P(X=x)= 0^2\cdot(1-p)+1^2\cdot p=p.\]</span></p>
<p>Su <strong>varianza</strong> es</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=p-p^2=p\cdot (1-p)=p\cdot q.\]</span></p>
<p>Su desviación típica es</p>
<p><span class="math display">\[
\sqrt{Var(X)}=\sqrt{p \cdot (1-p)}.
\]</span></p>
<section id="resumen-v.a-con-distribución-bernoulli" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="resumen-v.a-con-distribución-bernoulli"><span class="header-section-number">4.2.1</span> Resumen v.a con distribución Bernoulli</h3>
<div class="ex">
<div class="exe-header">
<p>Ejemplo</p>
</div>
<div class="exe-container">
<p>Veamos los cálculos básicos <span class="math inline">\(Ber(p=0.25)\)</span> en <code>R</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">1</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">20</span>,<span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 0 0 1 1 0 0 0 0 1 1 0 1 0 0 0 0 1 0</code></pre>
</div>
</div>
<p>El siguiente código dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(Ber(p=0.25)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> Ber(p=0.25)"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.75</span>,<span class="dv">0</span>,<span class="fl">0.25</span>), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ber(p=0.25)"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-out.fig="80%">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/ber_plot_1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="distribución-binomial" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="distribución-binomial"><span class="header-section-number">4.3</span> Distribución binomial</h2>
<div class="definition">
<div class="definition-header">
<p>Distribución binomial</p>
</div>
<div class="definition-container">
<p>Si repetimos <span class="math inline">\(n\)</span> veces de forma independiente un experimento Bernoulli de parámetro <span class="math inline">\(p\)</span>.</p>
<p>El espacio muestral <span class="math inline">\(\Omega\)</span> estará formado por cadenas de <span class="math inline">\(E\)</span>’s y <span class="math inline">\(F\)</span>’s de longitud <span class="math inline">\(n\)</span> Consideremos la v.a.</p>
<p><span class="math display">\[X(\overbrace{EFFF\ldots EEF}^{n})=\mbox{número de éxitos en la cadena}.\]</span> A la variable aleatoria anterior se le conoce como distribución binomial de parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span>, y lo denotaremos por <span class="math inline">\(X\sim B(n,p).\)</span></p>
<p>Calculemos su <strong>función de probabilidad</strong>:</p>
<p><span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
{n\choose x}\cdot  p^x \cdot(1-p)^{n-x} &amp;\mbox{ si } x=0,1,\ldots,n\\
0  &amp; \mbox{ en otro caso}
\end{array}\right..
\]</span></p>
<p>Su <strong>función de distribución</strong> no tiene una fórmula cerrada. Hay que acumular la función de probabilidad:</p>
<p><span class="math display">\[\begin{eqnarray*}
F_{X}(x)=P(X\leq x) &amp; = &amp; \sum_{i=0}^x P_X(i)\\
&amp; = &amp;
\left\{
\begin{array}{ll}
0 &amp; \mbox{ si } x&lt;0\\\displaystyle
\sum_{i=0}^k {n\choose i}\cdot  p^i \cdot (1-p)^{n-i} &amp; \mbox{ si }
\left\{
  \begin{array}{l}
  k\leq x&lt; k+1\\
  k=0,1,\ldots,n.
  \end{array}
\right.\\
1 &amp; \mbox{ si } n\leq x
\end{array}
\right.
\end{eqnarray*}\]</span></p>
</div>
</div>
<p>Los números binomiales calculan el número de equipos de baloncesto distintos que (<span class="math inline">\(k=5\)</span> jugadores) se pueden hacer con 6 jugadores (<span class="math inline">\(n=6\)</span>).</p>
<p>Es decir cuántas maneras distintas hay para elegir (<em>choose</em>) 5 jugadores en un conjunto de 6 jugadores. Todo el mundo diría ¡¡¡6!!!. Efectivamente con R es</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">6</span>,<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Con 10 jugadores el número de equipos de 5 distintos es bastante más grande</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">10</span>,<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 252</code></pre>
</div>
</div>
<p>Y, por ejemplo, con un equipo de fútbol profesional que tiene en plantilla 22 jugadores (quitando los guardametas) se pueden formar ¡¡nada menos que!!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">22</span>,<span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 646646</code></pre>
</div>
</div>
<p>un bonito número capicúa que nos da el número de equipos distintos que se pueden formar.</p>
<p>Obviamente se tiene que una v.a. Bernoulli es una binomial con <span class="math inline">\(n=1\)</span></p>
<p><span class="math display">\[B(1,p)=Ber(p).\]</span></p>
<div class="ex">
<div class="exe-header">
<p>Ejercicio</p>
</div>
<div class="exe-container">
<p>Calculad las funciones de distribución de una binomial <span class="math inline">\(B(n=1,p=0.3)\)</span> y comprobar que coinciden con las distribuciones de una <span class="math inline">\(Ber(p=0.3)\)</span>.</p>
</div>
</div>
<section id="observaciones-sobre-la-distribución-binomial" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="observaciones-sobre-la-distribución-binomial"><span class="header-section-number">4.3.1</span> Observaciones sobre la distribución binomial</h3>
<ul>
<li>La probabilidad de fracaso se suele denotar con <span class="math inline">\(q=1-p\)</span>, <strong>sin ningún aviso adicional</strong>, con el fin de acortar y agilizar la escritura de las fórmulas.</li>
<li>Su <strong>función de distribución no tienen una formula general</strong>, hay que calcularla con una función de R o python… En el siglo pasado se tabulaban en los libros de papel :-).</li>
<li>En el material adicional os pondremos unas tablas de esta distribución para distintos valores de <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span> para que disfrutéis de tan ancestral método de cálculo.</li>
<li>Cualquier paquete estadístico, hoja de cálculo dispone de funciones para el cálculo de estas probabilidades, así que el <strong>uso de las tablas</strong> queda <strong>totalmente anticuado</strong>.</li>
</ul>
<p>La <strong>esperanza</strong> de una <span class="math inline">\(B(n,p)\)</span> es</p>
<p><span class="math display">\[E(X)=\displaystyle\sum_{k=0}^n k \cdot  {n \choose k }\cdot p^k\cdot q^{n-k} = n\cdot p.\]</span></p>
<p>La esperanza de <span class="math inline">\(X^2\)</span> es</p>
<p><span class="math display">\[\begin{eqnarray*}
E(X^2)&amp;=&amp; \displaystyle\sum_{k=0}^n k^2 \cdot  {n \choose k }\cdot p^k\cdot q^{n-k}\\
&amp;=&amp; n\cdot p\cdot q+(n\cdot p)^2.
\end{eqnarray*}\]</span></p>
<p>La <strong>varianza</strong> de una <span class="math inline">\(B(n,p)\)</span> es</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=n\cdot p \cdot q=n\cdot p\cdot (1-p).\]</span></p>
<p>Su desviación típica es</p>
<p><span class="math display">\[\sqrt{n\cdot p\cdot q}=\sqrt{n\cdot p\cdot (1-p)}.\]</span></p>
<p>En temas posteriores veremos una forma sencilla del cálculo de la esperanza y varianza de una <span class="math inline">\(B(n,p)\)</span> como las suma de <span class="math inline">\(n\)</span> v.a. <span class="math inline">\(Ber(p)\)</span> independientes.</p>
<div class="ex">
<div class="exe-header">
<p>Ejemplo</p>
</div>
<div class="exe-container">
<p>Justificar de forma intuitiva que si <span class="math inline">\(X_i\)</span> con <span class="math inline">\(i=1,2,\ldots, n\)</span> son v.a. <span class="math inline">\(Ber(p)\)</span> independientes entonces <span class="math inline">\(X=\displaystyle\sum_{i=1}^n X_i\)</span> sigue una distribución <span class="math inline">\(B(n,p).\)</span></p>
</div>
</div>
</section>
<section id="resumen-v.a-con-distribución-binomial-bnp" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="resumen-v.a-con-distribución-binomial-bnp"><span class="header-section-number">4.3.2</span> Resumen v.a con distribución binomial <span class="math inline">\(B(n,p)\)</span></h3>

</section>
<section id="la-distribución-binomial-con-r" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="la-distribución-binomial-con-r"><span class="header-section-number">4.3.3</span> La distribución binomial con R</h3>
<p>Veamos los cálculos básicos con funciones de R para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Si queremos calcular con <code>R</code> algún valor de la función de distribución como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span>, tenemos que hacer:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05631351</code></pre>
</div>
</div>
<p>y si queremos por ejemplo <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span>, tenemos que hacer:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9218731</code></pre>
</div>
</div>
<p>Sin embargo, si queremos calcular algún valor de la función de probabilidad como por ejemplo <span class="math inline">\(P(X=0)\)</span>, tenemos que hacer:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05631351</code></pre>
</div>
</div>
<p>o por ejemplo para <span class="math inline">\(P(X=4)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.145998</code></pre>
</div>
</div>
</section>
<section id="generación-de-muestras-aleatorias-con-r" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="generación-de-muestras-aleatorias-con-r"><span class="header-section-number">4.3.4</span> Generación de muestras aleatorias con R</h3>
<p>Generaremos una muestra aleatoria de 100 valores de una población con distribución <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="at">size =</span> <span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 12 11  9 11  6  6 12  5  7 11 12 11  8  8 11 11  7 11  9 10  9 10 14
 [24]  8  8  5 11 14 11 10 11  5 12  8  6  7  9 10  5 12 11  9 12 11 12 10
 [47] 13 13  8  8  9  7  6  9 10  9 16 13  6  6  8  8 11  9 12 15  9  7 12
 [70] 11  9  8  9  8 11 15  7 10  9 12  6 13 14  8 10  8 10 11 11  9 10 11
 [93] 12  8 10 12  9 13  9 13</code></pre>
</div>
</div>
<p>Que corresponde a los resultados de repetir 100 veces el experimento de lanzar una moneda 20 veces y contar el número de caras.</p>
</section>
<section id="cálculos-distribución-binomial-con-python" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="cálculos-distribución-binomial-con-python"><span class="header-section-number">4.3.5</span> Cálculos distribución binomial con python</h3>
<p>Veamos los cálculos básicos con funciones de python para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Primero importamos la función <code>binom</code> de la librería <code>scipy.stat</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En general en el paquete <code>scipy</code>, la función de probabilidad se invocará con el método <code>pmf</code>, la de distribución con el método <code>cdf</code> mientras que una muestra aleatoria que siga esta distribución con el método <code>rvs</code>. En todos ellos aparecerá siempre el parámetro <code>loc</code> que se utiliza para desplazar el dominio de la variable aleatoria. Por ejemplo, en este caso</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(k, n, p, loc) <span class="op">=</span>  binom.pmf(k <span class="op">-</span> loc, n, p)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cálculos-distribución-binomial-con-python-1" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="cálculos-distribución-binomial-con-python-1"><span class="header-section-number">4.3.6</span> Cálculos distribución binomial con python</h3>
<p>Para calcular los valores de la función de distribución como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span> y <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span> utilizamos la función <code>cdf</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.056313514709472684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9218730926513672</code></pre>
</div>
</div>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Para calcular los valores de la función de probabilidad <span class="math inline">\(P(X=0)\)</span> y <span class="math inline">\(P(X=4)\)</span> utilizamos la función <code>pmf</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.056313514709472656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14599800109863284</code></pre>
</div>
</div>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Si queremos generar una muestras aleatorias que siga una distribución binomial, podemos usar la función <code>rvs</code>. En este caso, generaremos una muestra aleatoria de 100 valores de una población <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 5,  7,  8,  4,  3,  6,  4,  4,  4,  4,  7,  3,  6,  6,  6,  5,  6,
        6,  6,  4,  6,  5,  5,  6,  3,  8,  9,  6,  7,  4,  4,  8,  8,  3,
        7,  3,  2,  6,  7, 10,  5,  7,  7,  6,  6,  7,  4,  9,  5,  9,  3,
        6,  6,  6,  5,  5,  6,  5,  7,  4,  6,  4,  4,  4,  7,  4,  4,  5,
        5,  8,  6,  4,  3,  4,  7,  4,  6,  5, 10,  5,  3,  5,  5,  6,  7,
        3,  6,  4,  5,  7,  5,  3,  7,  5,  6,  3,  0,  6,  5,  6],
      dtype=int64)</code></pre>
</div>
</div>
<p><span style="color:red;"><strong>Alerta</strong></span> Notemos que la secuencia aleatoria generada no es la misma que con <code>R</code>. De hecho, si volvemos a ejecutar esta función obtendremos una muestra aleatoria distinta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 6,  5,  8,  5,  5,  6,  9,  6,  7,  7,  6,  6,  6,  3, 10,  3,  5,
        2,  2,  5, 10,  5,  3,  5,  7,  2,  7,  5,  5,  1,  3,  5,  6,  2,
        4,  7,  5,  3,  6,  5,  6,  4,  6,  4,  3,  5,  3,  6, 12,  6,  3,
        3,  4,  3,  4,  6,  8,  7,  8,  5,  6,  9,  6,  5,  5,  6,  3,  7,
        5,  5,  6,  6,  2,  1,  6,  6, 10,  8,  4,  2,  6,  6,  5,  4,  4,
        8,  8,  6,  3,  5,  5,  7,  5,  4,  8,  5,  4,  5,  7,  3],
      dtype=int64)</code></pre>
</div>
</div>
<p>Veamos algunos cálculos básicos con funciones de python para la binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">5</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9802722930908203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">1</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1877117156982421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([6, 3, 3, 4, 5, 6, 4, 8, 5, 8], dtype=int64)</code></pre>
</div>
</div>
</section>
<section id="gráficas-de-la-distribución-binomial-con-r" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored"><span class="header-section-number">4.3.7</span> Gráficas de la distribución binomial con R</h3>
<p>El siguiente código de R dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(B(n=10,p=0.25)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> B(n=10,p=0.25)"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> B(n=10,p=0.25)"</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El siguiente código de R dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(B(n=10,p=0.25)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejercicio</p>
</div>
<div class="exe-container">
<p>Buscad en la documentación de python cómo se dibuja la función de probabilidad y de distribución de una binomial y recread los gráficos anteriores.</p>
<p>Pista: Necesitaremos investigar más librerías:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(binom.ppf(<span class="fl">0.01</span>, n, p),binom.ppf(<span class="fl">0.99</span>, n, p))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, binom.pmf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">'binom pmf'</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, binom.pmf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, binom.cdf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">'binom pmf'</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, binom.cdf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Binomial'</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/dibu_python2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: Número de bolas rojas extraídas de una urna con reposición</p>
</div>
<div class="exe-container">
<p>Tenemos una urna con <span class="math inline">\(100\)</span> bolas de las cuales 40 son rojas y 60 son blancas. Extraemos al azar una bola, anotamos su color y la devolvemos a (reponemos en) la urna.</p>
<p>Supongamos que repetimos este proceso <span class="math inline">\(n=10\)</span> reponiendo en cada ocasión la bola extraída.</p>
<p>Consideremos la variable aleatoria <span class="math inline">\(X\)</span> como el número de bolas rojas extraídas (con reposición) en <span class="math inline">\(n=10\)</span> repeticiones del mismo experimento de Bernoulli.</p>
<p>Bajo estas condiciones repetimos <span class="math inline">\(n=10\)</span> veces el mismo experimento de Bernoulli con probabilidad de éxito (sacar bola roja) <span class="math display">\[P(Roja)=P(Éxito)=p=\frac{40}{100}=0.4.\]</span></p>
<p>Así que la variable <span class="math inline">\(X\)</span> que es el número de bolas rojas extraídas de la urna (con reposición) en <span class="math inline">\(n=10\)</span> ocasiones sigue una ley binomial <span class="math inline">\(B(n=10,p=0.4).\)</span></p>
<p>Nos preguntamos:</p>
<ol type="1">
<li>¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</li>
<li>¿Cuál es el valor esperado del número de bolas rojas?</li>
<li>¿Cuál es la desviación típica del número de bolas rojas?</li>
</ol>
<p><strong>Solución 1</strong>. ¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> rojas?</p>
<p>Utilizando la función de probabilidad, tenemos que: <span class="math display">\[\begin{eqnarray*}
P(X=4)&amp;=&amp;{10\choose 4}\cdot 0.4^4\cdot (1-0.4)^{10-4}
= \frac{10!}{(10-4)!\cdot 4!}\cdot 0.4^4\cdot 0.6^6\\
&amp;=&amp; \frac{7\cdot 8\cdot 9\cdot 10}{1\cdot 2\cdot 3\cdot 4}\cdot 0.4^4\cdot 0.6^6=0.2508227.
\end{eqnarray*}\]</span></p>
<p>Con R</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob =</span> <span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2508227</code></pre>
</div>
</div>
<p><strong>Solución 2</strong>. ¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</p>
<p>La probabilidad de sacar al menos 4 rojas se expresa como</p>
<p><span class="math inline">\(P(X \geq  4)=1-P(X&lt;4)=1-P(X\leq 3):\)</span></p>
<p><span class="math display">\[\begin{eqnarray*}
P(x\leq 3)&amp;=&amp; P(X=0)+P(X=1)+P(X=2)+P(X=3)\\
&amp;=&amp;
{10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;+&amp;{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}+ {10\choose 3}\cdot 0.4^3\cdot (1-0.4)^{10-3}\\
&amp;=&amp;0.3822806.
\end{eqnarray*}\]</span></p>
<p>Con <code>R</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3822806</code></pre>
</div>
</div>
<p>Así que</p>
<p><span class="math display">\[P(X \geq 4 )=1-P(X&lt; 4)=1-P(X\leq 3)=1-0.3822806=0.6177194.\]</span></p>
<p>Otra manera usando <code>R</code> sería:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6177194</code></pre>
</div>
</div>
<p>Aunque en estos casos el parámetro <code>lower.tail = FALSE</code> es sin duda nuestra mejor opción:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6177194</code></pre>
</div>
</div>
<p><strong>Solución 3</strong>. ¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</p>
<p><span class="math display">\[\begin{eqnarray*}
P(X&lt; 3)&amp;=&amp; P(X\leq 2)=  P(X=0)+P(X=1)+P(X=2)\\
&amp;=&amp;
{10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;&amp;+
{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}\\
&amp;=&amp;0.1672898.
\end{eqnarray*}\]</span></p>
<p>Con código R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1672898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1672898</code></pre>
</div>
</div>
<p><strong>Solución 4</strong>. ¿Cuál es el valor esperado del número de bolas rojas?</p>
<p>Como <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=10,p=0.4)\)</span> sabemos que</p>
<p><span class="math display">\[E(X)=n\cdot p = 10\cdot 0.4=4.\]</span></p>
<p>Aunque en python tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X) = </span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">'m'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Solución 5</strong>. ¿Cuál es la desviación típica del número de bolas rojas?</p>
<p>La varianza es: <span class="math display">\[
Var(X)=n\cdot p \cdot(1-p)=10\cdot 0.4\cdot 0.6=2.4.
\]</span></p>
<p>Por lo tanto la desviación típica es</p>
<p><span class="math display">\[\sqrt{Var(X)}=\sqrt{2.4}= 1.5491933.\]</span></p>
<p>Aunque en python tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X) = </span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">'v'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="distribución-geométrica" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="distribución-geométrica"><span class="header-section-number">4.4</span> Distribución geométrica</h2>
<p>Todos hemos jugado a, por ejemplo, tirar una moneda hasta que obtengamos la primera cara.</p>
<p>O también tirar una pelota a una canasta de baloncesto hasta obtener la primera canasta.</p>
<p>Desde otro punto de vista también podemos intentar modelar el número de veces que accionamos una interruptor y la bombilla se ilumina hasta que falla.</p>
<p>O también el número de veces que un cajero automático nos da dinero hasta que falla.</p>
<p>La <strong>modelización de este tipo de problemas se consigue con la llamada distribución geométrica</strong>.</p>
<div class="definition">
<div class="definition-header">
<p>Definición: Distribución geométrica</p>
</div>
<div class="definition-container">
<ul>
<li>Repitamos un experimento Bernoulli, de parámetro <span class="math inline">\(p\)</span>, de forma independiente hasta obtener el primer éxito.</li>
<li>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de fracasos antes del primer éxito. Por ejemplo que hayamos tenido <span class="math inline">\(x\)</span> fracasos será una cadena de <span class="math inline">\(x\)</span> fracasos culminada con un éxito. Más concretamente</li>
</ul>
<p><span class="math display">\[P(\overbrace{FFF\ldots F}^{x}E)=P(F)^{x}\cdot P(E)=(1-p)^{x}\cdot p=q^{x}\cdot p.\]</span></p>
</div>
</div>
<p>Así su función de probabilidad es</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}
(1-p)^{x}\cdot p &amp; \mbox{ si } x=0,1,2,\ldots\\
0 &amp;\mbox{ en otro caso}
\end{array}\right..
\]</span></p>
<p>La v.a. definida anteriormente diremos que sigue una distribución geométrica de parámetro <span class="math inline">\(p\)</span> La denotaremos por <span class="math inline">\(Ge(p)\)</span>. Su dominio es <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>.</p>
<div class="ex">
<div class="exe-header">
<p>Ejemplo</p>
</div>
<div class="exe-container">
<p>Calculemos P(<span class="math inline">\(X\leq 3\)</span>).</p>
<p>Por la propiedad de la probabilidad del suceso complementario tenemos que</p>
<p><span class="math display">\[
P(X\leq 3 )=1-P(X&gt; 3)=1-P(X\geq 4)
\]</span></p>
<p>Efectivamente, el complementario del evento <span class="math inline">\(X\leq 3\)</span> nos dice que hemos fracasado más de tres veces hasta conseguir el primer éxito, es decir, <strong>hemos fracasado 4 o más veces</strong>. Podemos simbolizar dicho evento de la forma siguiente: <span class="math display">\[
\{X&gt;3\}=\{X\geq 4\}= \{FFFF\}
\]</span></p>
<p>Ahora, al ser los intentos independientes, tenemos que:</p>
<p><span class="math display">\[\begin{eqnarray*}
P(X&gt;3) &amp; = &amp; P(\{FFFF\})= P(F)\cdot P(F)\cdot P(F)\cdot P(F)\\
&amp;=&amp; (1-p)\cdot (1-p)\cdot (1-p)\cdot (1-p)= (1-p)^{3+1}\\
&amp;=&amp;(1-p)^{4}.
\end{eqnarray*}\]</span></p>
<p>El valor de la función de distribución de <span class="math inline">\(X\)</span> en <span class="math inline">\(x=3\)</span> será, pues: <span class="math display">\[F_X(3)=P(X\leq 3)=1-P(X&gt;3)=1-(1-p)^{3+1}.\]</span> Generalizando el resultado anterior a cualquier entero positivo <span class="math inline">\(k=0,1,2,\ldots\)</span>, tenemos: <span class="math display">\[F_X(k)=P(X\leq k)=1-(1-p)^{k+1},\mbox{ si } k=0,1,2,\ldots\]</span></p>
</div>
</div>
<p>En general, tendremos que la función de distribución de una v.a.a <span class="math inline">\(Ge(p)\)</span> es :</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll}
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p),  &amp; \mbox{ si } k=0\leq x &lt;1,\\
1- (1-p)^2, &amp; \mbox{ si } k=1\leq x &lt;2,\\
1- (1-p)^3, &amp; \mbox{ si } k=2\leq x &lt;3,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
    \right.
\end{array}
\right..
\]</span></p>
<section id="función-de-distribución-geométrica" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="función-de-distribución-geométrica"><span class="header-section-number">4.4.1</span> Función de distribución geométrica</h3>
<p>De forma más compacta, tendremos que <span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll}
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
\right.
\end{array}
\right..
\]</span></p>
<p>Notemos que el límite de la función de distribución es: <span class="math display">\[
\displaystyle\lim_{k\to +\infty } F_X(k)=\lim_{k\to +\infty } 1-(1-p)^{k+1}=
1,
\]</span> ya que <span class="math inline">\(0&lt;1-p&lt;1\)</span>.</p>
<p>Recordemos del tema de variables aleatorias que</p>
<div class="theorem">
<div class="theorem-header">
<p>Propiedades</p>
</div>
<div class="theorem-container">
<ul>
<li>Si <span class="math inline">\(|r|&lt;1\)</span> también son convergentes las derivadas, respecto de <span class="math inline">\(r\)</span>, de la serie geométrica y convergen a la derivada correspondiente. Así tenemos que</li>
</ul>
<p><span class="math display">\[
\begin{array}{rlrl}
\left(\sum_{k=0}^{+\infty} r^k\right)'&amp;= \sum_{k=1}^{+\infty}k\cdot
r^{k-1} &amp;= \left(\frac1{1-r}\right)'=\frac1{(1-r)^2}\\
\left(\sum_{k=0}^{+\infty} r^k\right)^{''}&amp;= \sum_{k=2}^{+\infty}k \cdot(k-1)\cdot
r^{k-2}&amp;=\left(\frac1{1-r}\right)^{''}=\frac2{(1-r)^3}
\end{array}
\]</span></p>
</div>
</div>
<p>Vamos a calcular el valor esperado de una <span class="math inline">\(Geo(p)\)</span> Recordemos que <span class="math inline">\(P(X=x)=(1-p)^x\cdot p\)</span> si <span class="math inline">\(x=0,1,2,\ldots\)</span> y aplicado la fórmula anterior con <span class="math inline">\(r=1-p\)</span></p>
<p><span class="math display">\[\begin{eqnarray*}
E(X)&amp;=&amp;\sum_{x=0}^{+\infty} x\cdot P_x(x)=\sum_{x=0}^{+\infty} x\cdot (1-p)^x\cdot p\\
&amp;=&amp; p\cdot (1-p) \cdot \sum_{x=1}^{+\infty} x\cdot (1-p)^{x-1}\\
&amp;=&amp; p\cdot (1-p)\cdot \frac{1}{(1-(1-p))^2}=p\cdot (1-p)\cdot \frac{1}{p^2}=\frac{1-p}{p}
\end{eqnarray*}\]</span></p>
<p>Ahora caclulamos <span class="math inline">\(E(X^2)\)</span></p>
<p><span class="math display">\[\begin{eqnarray*}
E(X^2)&amp;=&amp;\sum_{x=0}^{+\infty} x^2\cdot P_X(x)=\sum_{x=1}^{+\infty} x^2\cdot (1-p)^x\cdot p\\
&amp;=&amp;
\sum_{x=1}^{+\infty} (x\cdot (x-1)+x)\cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
\sum_{x=1}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x}\cdot p+\sum_{x=1}^{+\infty} x \cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\
&amp;  +&amp;   (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1} = \ldots
\end{eqnarray*}\]</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
E(X^2)&amp;=&amp;\ldots\\
&amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\
&amp;  +&amp;   (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{(1-(1-p))^3}+  (1-p)\cdot p \frac{1}{(1-(1-p))^2}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{p^3}+  (1-p)\cdot p \frac{1}{p^2}\\
&amp;=&amp;\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}.
\end{eqnarray*}\]</span></p>
<p>Ahora varianza de una v.a. <span class="math inline">\(Ge(p)\)</span> es</p>
<p><span class="math display">\[\begin{eqnarray*}
Var(X)&amp;=&amp;E(X^2)-E(X)^2=\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}-\left(\frac{1-p}{p}\right)^2\\
&amp;=&amp;
\frac{2\cdot (1-p)^2+p\cdot(1-p)-(1-p)^2}{p^2}=\frac{(1-p)^2+p\cdot(1-p)}{p^2}\\
&amp;=&amp;
\frac{1-2\cdot p + p^2+p-p^2}{p^2}\\
&amp;=&amp; \frac{1-p}{p^2}.
\end{eqnarray*}\]</span></p>
<p>Y su desviación típica será</p>
<p><span class="math display">\[\sqrt{Var(X)}=\sqrt{\frac{1-p}{p^2}}.\]</span></p>
</section>
<section id="resumen-distribución-geométrica-gep-empezando-en-0" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="resumen-distribución-geométrica-gep-empezando-en-0"><span class="header-section-number">4.4.2</span> Resumen distribución geométrica <span class="math inline">\(Ge(p)\)</span> empezando en 0</h3>

</section>
<section id="la-variable-geométrica-que-cuenta-los-intentos-para-obtener-el-primer-éxito." class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="la-variable-geométrica-que-cuenta-los-intentos-para-obtener-el-primer-éxito."><span class="header-section-number">4.4.3</span> La variable geométrica que cuenta los intentos para obtener el primer éxito.</h3>
<ul>
<li>Supongamos que sólo estamos interesados en el <strong>número de intentos</strong> para obtener el primer éxito.</li>
<li>Si definimos <span class="math inline">\(Y\)</span>= número de intentos para obtener el primer éxito. Entonces <span class="math inline">\(Y=X+1\)</span> donde <span class="math inline">\(X\sim Ge(p)\)</span>.</li>
<li>Su dominio es <span class="math inline">\(D_Y=\{1,2,\ldots\}\)</span></li>
<li>La media se incrementa en un intento debido al éxito <span class="math inline">\(E(Y)=E(X+1)=E(X)+1=\frac{1-p}{p}+1=\frac1{p}\)</span>.</li>
<li>La varianza es la misma <span class="math inline">\(Var(Y)=Var(X+1)=Var(X)=\frac{1-p}{p^2}\)</span>.</li>
</ul>
</section>
<section id="resumen-distribución-geométrica-gep-empezando-en-1." class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="resumen-distribución-geométrica-gep-empezando-en-1."><span class="header-section-number">4.4.4</span> Resumen distribución geométrica <span class="math inline">\(Ge(p)\)</span> empezando en <span class="math inline">\(1\)</span>.</h3>

</section>
<section id="propiedad-de-la-falta-de-memoria" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored"><span class="header-section-number">4.4.5</span> Propiedad de la falta de memoria</h3>
<div class="theorem">
<div class="theorem-header">
<p>Propiedad de la falta de memoria</p>
</div>
<div class="theorem-container">
<p>Sea <span class="math inline">\(X\)</span> una v.a. discreta con dominio <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>, con <span class="math inline">\(P(X=0)=p\)</span>.</p>
<p>Entonces <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(Ge(p)\)</span> si, y sólo si,</p>
<p><span class="math display">\[
P\left(X&gt; k+j\big| X\geq j\right)=P(X&gt; k)
\]</span> para todo <span class="math inline">\(k,j=0,1,2,3\ldots\)</span>.</p>
</div>
</div>
<p><strong>Demostración</strong></p>
<p>Si <span class="math inline">\(X\)</span> es geométrica entonces el lado derecho de la igualdad es</p>
<p><span class="math display">\[
P(X&gt;k)=1-P(X\leq k)=1-\left(1-(1-p)^{k+1}\right)=(1-p)^{k+1},
\]</span> y el lado de izquierdo es</p>
<p>{ <span class="math display">\[\begin{eqnarray*}
P\left(X&gt; k+j\big| X\geq j\right)&amp;=&amp;\frac{P\left(\{X&gt; k+j\}\cap \{X\geq j\} \right)}{P\left(X\geq j\right)}=
\frac{P\left(X&gt;k+j \right)}{P\left(X\geq j \right)} = \frac{1-P(X\leq k+j)}{1-P(X\leq j-1)}\\
&amp;=&amp;  \frac{1-(1-(1-p)^{k+j+1})}{1-(1-(1-p)^{j-1+1})} =\frac{(1-p)^{k+j+1}}{(1-p)^{j}} = (1-p)^{k+1},
\end{eqnarray*}\]</span> } </p>
<p>lo que demuestra la igualdad.</p>
<p>Para demostrar el recíproco, tomemos <span class="math inline">\(j=1\)</span> y <span class="math inline">\(k\geq 0\)</span>. Entonces, por la propiedad de la pérdida de memoria: <span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=P(X&gt; k)
\]</span> Como <span class="math inline">\(P(X=0)=p\)</span>, tenemos que <span class="math inline">\(P(X \geq 1 )=1-P(X&lt;1)=1-P(X=0)=1-p\)</span>.</p>
<p>Combinado las igualdades, tenemos que:</p>
<p><span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=\frac{P(X&gt;k+1, X\geq 1)}{P(X\geq 1)}=\frac{P(X&gt;k+1)}{P(X\geq 1)}=P(X&gt;k).
\]</span> Así podemos poner que</p>
<p><span class="math display">\[\begin{eqnarray*}
P(X&gt;k+1)&amp;=&amp;P(X\geq 1)\cdot P(X&gt;k)=\left(1-P(X&lt;1)\right)\cdot P(X&gt;k)\\
&amp;=&amp;\left(1-P(X=0)\right)\cdot P(X&gt;k)=(1-p)\cdot P(X&gt;k).
\end{eqnarray*}\]</span></p>
<p>Es decir en general tenemos que</p>
<p><span class="math display">\[
P(X&gt;k+1)=(1-p)\cdot P(X&gt;k)
\]</span> Del mismo modo para <span class="math inline">\(j=2\)</span></p>
<p><span class="math display">\[
\scriptsize{P(X&gt;k+2)=(1-p)\cdot P(X&gt;k+1)}
\]</span></p>
<p>Restando la primera igualdad de la última obtenemos.</p>
<p><span class="math display">\[
\scriptsize{P(X&gt;k+1)-P(X&gt;k+2)=(1-p)\cdot P(X&gt;k)-(1-p)\cdot P(X&gt;k+1)}
\]</span></p>
<p>de donde operando en cada lado de la igualdad obtenemos la recurrencia</p>
<p><span class="math display">\[
\scriptsize{[1-P(X\leq k+1)]-[1-P(X\leq k+2)]=(1-p)\cdot [P(X&gt;k)-P(X&gt;k+1)]}
\]</span></p>
<p>Ahora operando <span class="math display">\[
P(X\leq k+2)-P(X\leq k+1)=(1-p)\cdot[1-P(X\leq k)-\left(1-P(X\leq k+1)\right)]
\]</span> <span class="math display">\[
P(X=k+2)=(1-p)\cdot[P(X\leq k+1)-P(X\leq k)]
\]</span> <span class="math display">\[
P(X=k+2)=(1-p)\cdot P(X=k+1)
\]</span></p>
<p>De forma similar obtenemos</p>
<p><span class="math display">\[
P(X=k+1)=(1-p)\cdot P(X=k)
\]</span> Utilizando la recurrencia anterior, podemos calcular todas las probabilidades <span class="math inline">\(P(X=k)\)</span> a partir de la <span class="math inline">\(P(X=0)=p\)</span>: <span class="math display">\[
\scriptsize{
\begin{array}{rl}
P(X=0)&amp;= p,\\
P(X=1)&amp;=P(X=0+1)= (1-p)\cdot P(X=0) =(1-p)\cdot  p,\\
P(X=2)&amp;=P(X=1+1)= (1-p)\cdot P(X=1)=(1-p)\cdot (1-p)\cdot p=(1-p)^2\cdot p,\\
\vdots &amp;    \vdots \\
P(X=k)&amp;=P(X=(k-1)+1)= (1-p)\cdot P(X=k-1)=(1-p)\cdot (1-p)^{k-1}\cdot p=(1-p)^{k}\cdot p,
\end{array}
}
\]</span> lo que demuestra el recíproco, es decir, que <span class="math inline">\(X\)</span> es <span class="math inline">\(Geom(p)\)</span>.</p>
<div class="theorem">
<div class="theorem-header">
<p>Observación: Interpretación de la propiedad</p>
</div>
<div class="theorem-container">
<p>La propiedad de la falta de memoria <span class="math display">\[
P(X&gt; k+j\big|X \geq j)=P(X &gt; k),
\]</span><br>
significa que, aunque <strong>ya llevemos al menos <span class="math inline">\(j\)</span> fracasos</strong>, la probabilidad de <strong>que fracasemos <span class="math inline">\(k\)</span> veces más</strong> no disminuye, es la misma que era cuando empezamos el experimento.</p>
<p>A este efecto se le suele etiquetar con la frase <strong>el experimento carece de memoria</strong> o es un <strong>experimento sin memoria</strong> (<em>Memoryless Property</em>).</p>
</div>
</div>
<p>Un ejemplo muy sencillo nos aclarará el alcance de esta propiedad</p>
<div class="ex">
<div class="exe-header">
<p>Ejemplo:La llave que abre la puerta</p>
</div>
<div class="exe-container">
<p>Tenemos un llavero con 10 llaves, solo una de ellas abre una puerta. Cada vez que probamos una llave y falla olvidamos que llave hemos probado. ¿Cuál es la probabilidad de que si ya lo hemos intentado 5 veces necesitemos más de 4 intentos adicionales para abrir la puerta?</p>
<p>Tomemos <span class="math inline">\(k=4,j=5\)</span>, aplicando la propiedad de la falta de memoria</p>
<p><span class="math display">\[
P(X&gt; 4+5/X \geq 5)=P(X &gt; 4)
\]</span></p>
<p>Después de 5 fracasos no estamos “más cerca” de abrir la puerta. La propiedad de la falta de memoria nos dice que en <strong>después de cada intento es como si empezásemos de nuevo a abrir la puerta</strong>. Tras 5 fracasos la probabilidad de que fallemos más de 4 veces más es la misma que cuando lo intentamos la primera vez.</p>
<p>¿Cuál es el número esperado de fracasos hasta abrir la puerta?</p>
<p><span class="math display">\[
E(X)=\frac{1-p}{p}=\frac{1-\frac{1}{10}}{\frac{1}{10}}=\frac{\frac{9}{10}}{\frac{1}{10}}=9.
\]</span></p>
<p>La varianza es</p>
<p><span class="math display">\[
Var(X)=\frac{1-p}{p^2}=\frac{1-\frac{1}{10}}{\left(\frac{1}{10}\right)^2}=\frac{\frac{9}{10}}{\frac{1}{100}}=
90.
\]</span></p>
<p>La desviación típica es <span class="math inline">\(\sqrt{90}=9.486833.\)</span></p>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: partidos hasta que el Barça gana al Madrid</p>
</div>
<div class="exe-container">
<p><strong>Ejemplo: partidos hasta que el Barça gana al Madrid</strong></p>
<p>Los partidos Real Madrid vs FC Barcelona de <strong>la liga</strong> española se suelen denominar <strong>El Clásico</strong>, sean en el Bernabeu (estadio del Real Madrid) o en el Camp Nou (estadio del Barça)</p>
<p>Sea <span class="math inline">\(X\)</span> la variable que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid sea en el Camp Nou o el Bernabeu.</p>
<p>Nuestra amiga Aina es muy culé (hincha del Barça) y quiere averiguar cuántos partidos consecutivos de <strong>El Clásico</strong> tiene que ver hasta ver ganar al Barça por primera vez.</p>
<p>Le interesa estimar cuánto le va a costar este capricho. Tendrá que comprar las entradas y pagar los viajes de Barcelona a Madrid.</p>
<p>En <a href="https://es.wikipedia.org/wiki/El_Cl%C3%A1sico">datos historicos de <strong>El clásico</strong> en la wikipedia</a> están los datos hasta el 3 de marzo de 2019: se han jugado en total 178 <strong>Clásicos</strong> donde el Real Madrid ganó en 72 ocasiones, el Barça, en 72 y empataron 34 veces.</p>
<p>Nos hacemos las siguientes preguntas:</p>
<ul>
<li>Si Aina solo tiene dinero para ir a ver 3 partidos, ¿cuál es la probabilidad de no ver ganar al Barça en al menos tres partidos consecutivos?</li>
<li>¿Cuántos partidos se tienen que jugar de media para ver ganar al Barça por primera vez?</li>
</ul>
<p>Con los datos anteriores, podemos estimar que la probabilidad de que el Barça gane un clásico cualquiera es:</p>
<p><span class="math display">\[P(\mbox{Barça})=\frac{72}{178}=0.4045.\]</span></p>
<p>Por tanto, podemos modelar la variable <span class="math inline">\(X\)</span>, que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid, con una ley geométrica empezando en cero con probabilidad de éxito <span class="math inline">\(p=P(\mbox{Barça})=\frac{72}{178}\)</span>,</p>
<p><span class="math display">\[X=Ge\left(p=\frac{72}{178}=0.4045\right)\]</span></p>
<p>Así que lo que nos pregunta Aina es la siguiente probabilidad</p>
<p><span class="math display">\[P(X\geq 3)=1-P(X\leq 2)=1-\left(1-\frac{72}{178}\right)^{2+1}=0.7888.\]</span></p>
<p>Así que Aina tiene una probabilidad del <span class="math inline">\(78.88\%\)</span> de no ver ganar al Barça en al menos 3 partidos antes de ver uno en el sí que gane.</p>
<p>Para responder a la segunda pregunta, usando que la distribución de <span class="math inline">\(X\)</span> es:</p>
<p><span class="math display">\[X=Ge\left(p=\frac{72}{178}=0.4045\right)\]</span></p>
<p>entonces</p>
<p><span class="math display">\[E(X)=\frac{1-p}{p}=\frac{1-0.4045}{0.4045}=1.4722\]</span></p>
<p>y</p>
<p><span class="math display">\[Var(X)=\frac{1-p}{p^2}=\frac{1-0.4045}{0.4045^2}=3.6397\]</span></p>
<p>La desviación típica es <span class="math display">\[\sqrt{3.6397}=1.9078.\]</span></p>
<section id="cálculos-de-la-distribución-geométrica-con-r" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="cálculos-de-la-distribución-geométrica-con-r"><span class="header-section-number">4.4.6</span> Cálculos de la distribución geométrica con R</h3>
<p>Veamos los cálculos básicos con R para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. R implementa la geométrica que cuenta el número de fracasos.</p>
<p><span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dgeom</span>(<span class="dv">0</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">0</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953.\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">4</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7626953</code></pre>
</div>
</div>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgeom</span>(<span class="at">n=</span><span class="dv">25</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  5  4  1  6 10  0  0 10  7  0  6  2  1  3  0  2  5  0  0  5  5  3  3
[24]  2  2</code></pre>
</div>
</div>
</section>
<section id="gráficas-con-r" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="gráficas-con-r"><span class="header-section-number">4.4.7</span> Gráficas con R</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="fl">0.25</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="dv">30</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dgeom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">prob=</span>p)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dgeom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">prob=</span>p),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> Ge(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pgeom</span>(x,<span class="at">prob=</span>p),</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ge(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/graficos22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cálculos-de-la-distribución-geométrica-con-python" class="level3" data-number="4.4.8">
<h3 data-number="4.4.8" class="anchored" data-anchor-id="cálculos-de-la-distribución-geométrica-con-python"><span class="header-section-number">4.4.8</span> Cálculos de la distribución geométrica con python</h3>
<p>Veamos los cálculos básicos con python para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. scipy.stats implementa la distribución geométrica que cuenta el número intentos así que empieza en 1</p>
<p>Cargamos la función de la librería</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> geom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La función de probabilidad es <code>geom.pmf(x,p,loc=0)=geom.pmf(x,p)</code> es un geométrica que cuenta el número de intentos para obtener el primer éxito el valor por defecto del último parámetro es <code>loc=0</code>.</p>
<p>Si queremos la que cuenta el número de fracasos para obtener el primer éxito (la geométrica que empieza en 0) tenemos que usar <code>geom.pmf(x,p,loc=-1)</code>.</p>
<p>Es decir <code>geom.pmf(x,p,loc=-1)=geom.pmf(x-1,p,loc=0)</code></p>
<p>Veamos pues los cálculos para la <span class="math inline">\(Ge(p)\)</span> que empieza en <span class="math inline">\(0\)</span>.</p>
<p><span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>geom.pmf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953.\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="dv">4</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>geom.rvs(p<span class="op">=</span><span class="fl">0.25</span>, size<span class="op">=</span><span class="dv">20</span>, loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Ejercicio</strong></p>
<p>Qué probabilidades son las que calcula el siguiente código y qué tipo de variables geométricas son?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con python también podemos calcular directamente algunos parámetros asociado a una función de distribución predefinida</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=</span><span class="dv">0</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=-</span><span class="dv">1</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Ejercicio</strong></p>
<p>Comprobad que las medias y las varianzas calculadas en el código anterior, corresponden a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(1\)</span> y a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(0\)</span>.</p>
<p>¿Son las varianzas siempre iguales?</p>
</section>
<section id="gráficos-con-python" class="level3" data-number="4.4.9">
<h3 data-number="4.4.9" class="anchored" data-anchor-id="gráficos-con-python"><span class="header-section-number">4.4.9</span> Gráficos con python</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(geom.ppf(<span class="fl">0.01</span>, p),geom.ppf(<span class="fl">0.99</span>, p))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, geom.pmf(x, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'geom pmf'</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, geom.pmf(x, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, geom.cdf(x, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'geom pmf'</span>)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, geom.cdf(x, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Geometrica'</span>)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribución-binomial-negativa" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="distribución-binomial-negativa"><span class="header-section-number">4.5</span> Distribución binomial negativa</h2>
<div class="ex">
<div class="exe-header">
<p>El problema de la puerta con dos cerraduras</p>
</div>
<div class="exe-container">
<p>Supongamos que disponemos de 10 llaves distintas y tenemos que abrir una puerta con <strong>dos cerraduras</strong>.</p>
<p>Comenzamos por la primera cerradura, de tal forma que cada vez olvidamos qué llave hemos probado.</p>
<p>Una vez abierta la primera cerradura probamos de igual forma con la segunda hasta que también la abrimos.</p>
<p>Sea <span class="math inline">\(X=\)</span> la v.a. que cuenta el número de fracasos hasta abrir la puerta.</p>
<p>Acertar una llave de la puerta es un experimento Bernoulli con probabilidad de éxito <span class="math inline">\(p=0.1\)</span>. Lo repetiremos hasta obtener 2 éxitos.</p>
</div>
</div>
<div class="theorem">
<div class="theorem-header">
<p>Distribución binomial negativa</p>
</div>
<div class="theorem-container">
<p>En general tendremos un experimento de Bernoulli con probabilidad de éxito <span class="math inline">\(0&lt;p&lt;1\)</span> tal que:</p>
<ul>
<li>Repetimos el experimento hasta obtener el <span class="math inline">\(n\)</span>-ésimo éxito ¡¡abrir la maldita puerta!!.</li>
<li>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número fallos hasta abrir la puerta, es decir, hasta conseguir el n-ésimo éxito. Notemos que no contamos los éxitos, solo contamos los fracasos.</li>
</ul>
<p>Si representamos como es habitual un suceso como una cadena de F’s y E’s, para <span class="math inline">\(n=2\)</span>, algunos sucesos elementales serán: <span class="math display">\[\small{\{EE,FEE,EFE, FFEE,FEFE,EFFE,FFFEE,FFEFE,FEFFE,EFFFE\}.}\]</span></p>
<p>Calculemos algunas probabilidades para <span class="math inline">\(n=2\)</span>: <span class="math display">\[
\small{
\begin{array}{rl}
P(X=0) &amp; =P(\{EE\})=p^2, \\
P(X=1) &amp; =P(\{FEE,EFE\})=2\cdot (1-p)\cdot p^2, \\
P(X=2) &amp; =P(\{FFEE,FEFE,EFFE\})=3\cdot (1-p)^2\cdot p^2, \\
P(X=3) &amp; =P(\{FFFEE,FFEFE,FEFFE,EFFFE\})=4\cdot (1-p)^3\cdot p^2.
\end{array}
}
\]</span></p>
</div>
</div>
<p>En general su función de probabilidad es</p>
<p><span class="math display">\[
P_{X}(k)=P(X=k)=\left\{\begin{array}{ll}
     {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n &amp; \mbox{si } k=0,1,\ldots\\
     0 &amp; \mbox{en otro caso}\end{array}\right.
\]</span> Una v.a. con este tipo de distribución recibe el nombre de <strong>binomial negativa</strong> y la denotaremos por <span class="math inline">\(BN(n,p)\)</span>.</p>
<p>Notemos que <span class="math inline">\(BN(1,p)=Ge(p)\)</span>.</p>
<p><strong>Demostración</strong></p>
<p>Justifiquemos el resultado. Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(BN(n,p)\)</span> y sea <span class="math inline">\(k=0,1,2,\ldots\)</span>.</p>
<p><span class="math display">\[\scriptsize{P(X=k)=P(\mbox{Todas las cadenas de E's y F' con $k$ F, con $n$ E y acabadas en E})}\]</span></p>
<p><span class="math display">\[
\scriptsize{\overbrace{\underbrace{\overbrace{EFFF\ldots EEF}^{n-1 \quad \mbox{Éxitos}.}}}_{k \quad\mbox{Fracasos}}^{k+n-1\mbox{ posiciones}}E}
\]</span></p>
<p>De estas cadenas hay tantas como maneras de elegir de entre las <span class="math inline">\(k+n-1\)</span> primeras posiciones <span class="math inline">\(n-1\)</span> para colocar los éxitos. Esta cantidad es el número binomial <span class="math inline">\({k+n-1\choose n-1}.\)</span></p>
<div class="definition">
<div class="definition-header">
<p>Números binomiales negativos</p>
</div>
<div class="definition-container">
<p>Dados dos enteros positivos <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span> se define el número binomial negativo como</p>
<p><span class="math display">\[\binom{-n}{k}=\frac{(-n)(-n-1)\cdots (-n-k+1)}{k!}.\]</span></p>
</div>
</div>
<p>Los números binomiales negativos generalizan la fórmula de Newton para exponentes negativos; obnetiendose el binomio geralizado de Newton:</p>
<p><span class="math display">\[
(t+1)^{-n}=\sum_{k=0}^{+\infty}\left(\begin{array}{c} -n
\\ k\end{array}\right) t^{k}
\]</span></p>
<p><code>R</code> usa la función <code>choose</code> para calcular números binomiales, sean negativos o no. Veámoslo con un ejemplo:</p>
<p><span class="math display">\[
\begin{array}{rl}
{-6\choose 4}&amp;=\frac{-6\cdot (-6-1)\cdot \cdot (-6-2)\cdot (-6-3) }{4!}\\
&amp;=  \frac{-6\cdot(-7)\cdot (-8)\cdot (-9)}{24}\\
&amp;= \frac{3024}{24}=126.
\end{array}
\]</span></p>
<p>Si realizamos el cálculo con <code>R</code> obtenemos el mismo resultado:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 126</code></pre>
</div>
</div>
<p>La <strong>esperanza</strong> de una <span class="math inline">\(BN(n,p)\)</span> es</p>
<p><span class="math display">\[E(X)=\sum_{k=0}^{+\infty} k\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p}.\]</span></p>
<p>La <strong>esperanza de <span class="math inline">\(X^2\)</span> es</strong></p>
<p><span class="math display">\[E(X^2)=\sum_{k=0}^{+\infty} k^2\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2.\]</span></p>
<p>Por último la <strong>varianza es</strong></p>
<p><span class="math display">\[
Var(X)=E(X^2)-E(X)^2=
\]</span></p>
<p><span class="math display">\[=n\cdot \frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2-\left(n\cdot \frac{1-p}{p}\right)^2=
n\cdot \frac{1-p}{p^2}.\]</span></p>
<p>y por tanto la desviación típica es</p>
<p><span class="math display">\[\sqrt{Var(X)} = \frac{\sqrt{n(1-p)}}{p}\]</span></p>
<section id="resumen-distribución-binomial-negativa-bnnp" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored"><span class="header-section-number">4.5.1</span> Resumen distribución Binomial Negativa <span class="math inline">\(BN(n,p)\)</span></h3>
<div class="ex">
<div class="exe-header">
<p><strong>Ejercicio: Puerta con dos cerraduras</strong></p>
</div>
<div class="exe-container">
<p>Recordemos nuestra puerta con dos cerraduras que se abren secuencialmente. Tenemos un manojo de 10 llaves casi idénticas de manera que cada vez que probamos una llave olvidamos qué llave hemos usado.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de intentos fallidos hasta abrir abrir la puerta.</p>
<p>Estamos interesado en modelar este problema. La preguntas son:</p>
<ol type="1">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</li>
<li>¿Cuál es la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta?</li>
<li>¿Cuál es la probabilidad de fallar más de 4?</li>
<li>¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</li>
</ol>
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</p>
<p>Bajo estados condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{10}=0.1\)</span>. Como cada vez <em>olvidamos</em> qué llave hemos probado, cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> que queremos modelar cuenta el número fallos de repeticiones sucesivas e independientes de un experimento <span class="math inline">\(Ber(p=0.1)\)</span> hasta conseguir 2 éxitos en un experimento.</p>
<p>Por lo tanto podemos asegurar que <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=2,p=0.1).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es</p>
<p><span class="math display">\[
P_X(k)=P(X=k)=
\left\{
\begin{array}{cc}
{k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n &amp; \mbox{si }  k=0,1,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Si aplicamos la expresión anterior para <span class="math inline">\(n=2\)</span> y <span class="math inline">\(p=0.1\)</span>, obtenemos: <span class="math display">\[
P_X(k)=P(X=k)=
\left\{
\begin{array}{cc}
{k+2-1\choose 2-1} \cdot 0.9^{k}\cdot 0.1^2 &amp; \mbox{si }  k=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Simplificando</p>
<p><span class="math display">\[
P_X(X=k)=P(X=k)=
\left\{
\begin{array}{cc}
0.01\cdot (k+1)\cdot 0.9^{k}, &amp; \mbox{si }  k=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>La función de distribución en general es</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0 &amp; \mbox{si } x&lt;0 \\
\displaystyle\sum_{i=0}^{k }{i+n-1\choose n-1} \cdot (1-p)^{i+n-1}\cdot p^n
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1\\k=0,1,2,\ldots\end{array}\right.
\end{array}
\right.
\]</span></p>
<p>Simplificando para <span class="math inline">\(n=2\)</span>, <span class="math inline">\(p=0.1\)</span>.</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0, \\
\displaystyle\sum_{i=0}^{k }0.01\cdot (i+1) \cdot 0.9^{i+1},
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.
\end{array}
\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta?</p>
<p><span class="math display">\[
P(X=5)= 0.01\cdot (5+1) \cdot 0.9^{5}= 0.06 \cdot 0.9^{5}= 0.0354294.
\]</span></p>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 4?</p>
<p>Nos piden que<br>
<span class="math display">\[
P(X&gt;4)=1-P(X\leq 4).
\]</span></p>
<p>Calculemos primero <span class="math inline">\(P(X\leq 4):\)</span></p>
<p><span class="math display">\[
\begin{array}{rl}
P(X\leq 4) &amp;=  \displaystyle\sum_{x=0}^{4} P(X=x)=P(X=0)+P(X=1)+P(X=2)+P(X=3)+P(X=4)\\
&amp;= 0.01\cdot (0+1) \cdot 0.9^{0}+0.01\cdot (1+1) \cdot 0.9^{1}+0.01\cdot (2+1) \cdot 0.9^{2} \\ &amp;\ \
+0.01\cdot (3+1) \cdot 0.9^{3} + 0.01\cdot (4+1) \cdot 0.9^{4} \\ &amp; =
0.01 +0.018+0.0243+0.02916+0.032805 = 0.114265.
\end{array}
\]</span></p>
<p>Por lo tanto</p>
<p><span class="math display">\[
P(X&gt;4)=1-P(X\leq 4)=1-0.114265=
0.885735.
\]</span></p>
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</p>
<p>Como <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<p><span class="math display">\[E(X)=n\cdot \frac{1-p}{p}=2\cdot \frac{1-0.1}{0.1}=18.\]</span></p>
<p>El número de fallos esperado es 18. La varianza es</p>
<p><span class="math display">\[
Var(X)=n\cdot\frac{1-p}{p^2}=2 \cdot \frac{1-0.1}{0.1^2}=180,
\]</span></p>
<p>y su desviación típica <span class="math inline">\(\sqrt{180}=13.41641.\)</span></p>
<section id="cálculos-binomial-negativa-con-r" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="cálculos-binomial-negativa-con-r"><span class="header-section-number">4.5.2</span> Cálculos binomial negativa con R</h3>
<p>La función de <code>R</code> que calcula la función de probabilidad de la binomial negativa con sus parámetros básicos es:</p>
<pre><code>dnbinom(x, size, prob,...)</code></pre>
<p>donde <code>size</code> (<span class="math inline">\(n\)</span>) es el número de éxitos y <code>prob</code> (<span class="math inline">\(p\)</span>), la probabilidad de éxito.</p>
<p>Así en el ejemplo de la puerta con dos cerraduras, <span class="math inline">\(X\)</span> es una <span class="math inline">\(BN(n=size=2,p=prob=0.1)\)</span>. Por ejemplo, <span class="math inline">\(P(X=5)\)</span> que hemos calculado en el ejemplo anterior, vale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnbinom</span>(<span class="dv">5</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0354294</code></pre>
</div>
</div>
<p>De forma similar calculamos calculamos <span class="math inline">\(P(X\leq 4)\)</span>, <span class="math inline">\(P(X&gt;4)=1-P(X\leq 4)\)</span> y <span class="math inline">\(P(X&gt;4)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.114265</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.885735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.885735</code></pre>
</div>
</div>
</section>
<section id="cálculos-binomial-negativa-con-python" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="cálculos-binomial-negativa-con-python"><span class="header-section-number">4.5.3</span> Cálculos binomial negativa con python</h3>
<p>La función con python es <code>nbinom.pmf(k, n, p, loc)</code>. Hay que cargarla desde <code>scpi.stats</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recordemos que de nuevo se cumple que</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k, n, p, loc) <span class="op">=</span> nbinom.pmf(k<span class="op">-</span>loc, n, p)`</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cálculos <span class="math inline">\(BN(n,p)\)</span> con python</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0354294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>,loc<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0354294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.11426500000000002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8857349999999999</code></pre>
</div>
</div>
<p>Generemos 100 observaciones aleatorias de una <span class="math inline">\(BN(n=2,0.1)\)</span>. Es decir serán las veces que hemos fallado hasta abrir la puerta 100 veces.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>nbinom.rvs(n<span class="op">=</span><span class="dv">2</span>, p<span class="op">=</span><span class="fl">0.1</span>, size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 9, 34, 38, 38, 34, 45, 45, 20, 20,  9,  6, 15, 16, 26, 21, 37,  6,
       15,  1, 21, 10, 16, 14, 22,  2, 22, 25, 22, 18, 36, 17, 34, 13, 35,
       18, 31,  6, 32, 19, 16,  4,  8,  1,  1, 24, 20,  6, 12,  6, 30, 18,
       27, 18,  5, 18, 24, 21, 22, 16,  8, 12, 11, 18, 16, 18, 26,  6, 32,
       21, 41, 28, 14,  6,  8, 23, 18, 20,  9,  3, 14, 42, 13, 21,  0, 15,
       12, 17, 26, 23,  8, 19,  6, 10,  1, 18,  7,  6, 14, 15,  9],
      dtype=int64)</code></pre>
</div>
</div>
<p>La <strong>esperanza</strong> y la <strong>varianza</strong>de una <span class="math inline">\(BN(n=2,0.1)\)</span> valen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>n, p<span class="op">=</span><span class="dv">2</span>,<span class="fl">0.1</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> nbinom.stats(n,p,moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X)=</span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(X)=18.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X)=</span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(X)=179.99999999999997</code></pre>
</div>
</div>
</section>
<section id="gráficas-de-la-binomial-negativa-con-r" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="gráficas-de-la-binomial-negativa-con-r"><span class="header-section-number">4.5.4</span> Gráficas de la binomial negativa con R</h3>
<p>El siguiente código de R dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<div class="small">
<div class="cell" data-layout-align="center" data-fig.out="60%">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="fl">0.1</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">y=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="fl">0.1</span>),</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> BN(n=2,p=0.1)"</span>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnbinom</span>(x,<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> BN(n=2,p=0.1)"</span>)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Ejercicio</strong></p>
<p>Buscad en los manuales de python cómo se dibuja la función de probabilidad y de distribución de una binomial negativa.</p>
<p>Necesitamos de nuevo más librerías</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gráficos-de-la-binomial-negativa-con-python" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="gráficos-de-la-binomial-negativa-con-python"><span class="header-section-number">4.5.5</span> Gráficos de la binomial negativa con python</h3>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>,nbinom.ppf(<span class="fl">0.99</span>, n, p))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, nbinom.pmf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'nbinom pmf'</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, nbinom.pmf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, nbinom.cdf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'nbinom pmf'</span>)</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, nbinom.cdf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Binomial Negativa'</span>)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/negativa_py_show-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="un-ejemplo-de-la-binomial-negativa" class="level3" data-number="4.5.6">
<h3 data-number="4.5.6" class="anchored" data-anchor-id="un-ejemplo-de-la-binomial-negativa"><span class="header-section-number">4.5.6</span> Un ejemplo de la binomial negativa</h3>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: Sistema con tres claves de acceso</p>
</div>
<div class="exe-container">
<p>Supongamos que tenemos un sistema informático tiene un programa de seguridad que genera accesos con claves de 3 dígitos <span class="math inline">\(000,001,\ldots 999\)</span>. En total 1000 posibilidades.</p>
<p>Como una clave de tres dígitos es fácil de romper proponemos considerar tres claves consecutivas de acceso al sistema, cada una de 3 dígitos.</p>
<p>Para acceder al sistema hay que dar las tres claves de forma consecutiva y por orden.</p>
<p>Es decir hasta que no averiguamos la primera clave no pasamos a la segunda clave.</p>
<p>Supongamos que cada vez que ponemos las dos claves olvidamos el resultado y seguimos poniendo claves al azar hasta adivinar la contraseña.</p>
<p>Así hasta conseguir entrar en el sistema.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de fallos antes de entrar en el sistema.</p>
<p>Estamos interesados en modelar este problema. La preguntas son:</p>
<ol type="1">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema.</li>
<li>¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</li>
<li>¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</li>
<li>¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?</li>
</ol>
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema?</p>
<p>Bajo estados condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{1000}=0.001\)</span>. Y como cada vez <em>olvidamos</em> en los dígitos cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> cuenta el número de fracasos independientes hasta conseguir 3 éxitos en un experimento <span class="math inline">\(Ber(p=0.001)\)</span> por lo tanto <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=3,p=0.001).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span></p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc}
{x+n-1\choose n-1} \cdot (1-p)^{x}\cdot p^n &amp; \mbox{si }  x=0,1,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span> En particular la función de probabilidad de una <span class="math inline">\(BN(n=3,p=0.001)\)</span> es</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc}
{x+2\choose 2} \cdot 0.999^{x}\cdot 0.001^3 &amp; \mbox{si }  x=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</p>
<p>Nos piden</p>
<p><span class="math display">\[
\scriptsize{P(X=150)= {152\choose 2} \cdot 0.999^{150}\cdot 0.001^3.}
\]</span></p>
<p>Lo calcularemos operando con R</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">152</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="fl">0.999</span><span class="sc">^</span><span class="dv">150</span><span class="sc">*</span><span class="fl">0.001</span><span class="sc">^</span><span class="dv">3</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.876743e-06</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnbinom</span>(<span class="dv">150</span>,<span class="at">size=</span><span class="dv">3</span>,<span class="at">p=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.876743e-06</code></pre>
</div>
</div>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</p>
<p>Nos piden, lo resolveremos con python</p>
<p><span class="math display">\[
P(X=150)= {152\choose 2} \cdot 0.999^{150}\cdot 0.001^3
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span>  scipy.special <span class="im">import</span> binom</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>binom(<span class="dv">152</span>,<span class="dv">2</span>)<span class="op">*</span><span class="fl">0.999</span><span class="op">**</span><span class="dv">150</span><span class="op">*</span><span class="fl">0.001</span><span class="op">**</span><span class="dv">3</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9.876743459670526e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9.876743459670532e-06</code></pre>
</div>
</div>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</p>
<p><span class="math display">\[P(X&gt;150)=1-P(X\leq 150)\]</span></p>
<p>Calculemos <span class="math inline">\(P(X\leq 150)\)</span></p>
<p><span class="math display">\[\begin{eqnarray*}
P(X\leq 150) &amp;=&amp; P(X=0)+P(X=1)+P(X=2)+\ldots+P(X=150)\\
&amp;=&amp; \sum_{k=0}^{150} {k+3-1\choose 3-1} \cdot (0.999)^{k}\cdot 0.001^3\ldots = \ldots =5.2320035\times 10^{-4}
\end{eqnarray*}\]</span></p>
<p><strong>Con R</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">150</span>,<span class="dv">3</span>,<span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0005232003</code></pre>
</div>
</div>
<p>Con python</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>nbinom.cdf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0005232003490824064</code></pre>
</div>
</div>
<p>El valor pedido será pues: <span class="math display">\[
P(X&gt;150)=1-P(X\leq 150)=1-5.2320035\times 10^{-4}=0.9994768.
\]</span> Vemos que es muy probable que fallemos más de 150 veces antes de entrar en el sistema.</p>
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su desviación típica?</p>
<p>Tenemos que <span class="math inline">\(E(X)=n\cdot \frac{1-p}{p}=3\cdot \frac{1- 0.001}{0.001}=2997\)</span> y <span class="math inline">\(Var(X)=n\cdot \frac{1-p}{p^2}=3\cdot \frac{1- 0.001^2}{0.001^2}=2.997\times 10^{6}.\)</span></p>
<p><strong>Con python</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> nbinom.stats(n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>,moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X) = </span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(X) = 2997.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X) = </span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(X) = 2997000.0</code></pre>
</div>
</div>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: ¿Tres claves de tres dígitos o una de 9 dígitos?</p>
</div>
<div class="exe-container">
<p>Supongamos que ponemos una sola clave de 9 dígitos. Estudiemos en este caso la variable aleatoria que da el número de fallos antes de entrar en el sistema y comparemos los resultados.</p>
<p>Si seguimos suponiendo que cada vez ponemos la contraseña al azar pero esta vez con una clave de 9 dígitos. La probabilidad de éxito será ahora <span class="math inline">\(p=\frac{1}{10^{9}}\)</span>.</p>
<p>Si llamamos <span class="math inline">\(X_9\)</span> a la variable aleatoria que nos da el número de fallos antes de entra en el sistema seguirá una distribución <span class="math inline">\(Ge(p=\frac{1}{10^9}=0.000000001)\)</span>.</p>
<p>¿Qué da más seguridad? ¿tres claves de tres dígitos o una de 9 dígitos?</p>
<p>Su valor esperado es</p>
<p><span class="math display">\[
E(X_9)=\frac{1-p}{p}=\frac{1-0.000000001}{0.000000001}=10\times 10^{8}.
\]</span></p>
<p><span class="math inline">\(1000 000 000\)</span> son 1000 millones de fallos esperados hasta abrir la puerta.</p>
<p>Recordemos que con tres contraseñas de 3 dígitos el valor esperado de fallos es</p>
<p><span class="math display">\[3\cdot \frac{1-0.001}{0.001}=2997.\]</span></p>
<p>Por lo tanto, desde el punto de vista de la seguridad, es mejor una clave larga de 9 dígitos que tres cortas si escribimos las contraseñas al azar.</p>
</div>
</div>
</section>
<section id="distribución-poisson" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="distribución-poisson"><span class="header-section-number">4.6</span> Distribución Poisson</h2>
<p>Definiremos formamente la distribución de Poisson dadndo su dominio y función de probabilidad</p>
<div class="definition">
<div class="definition-header">
<p>Definición: Distribución de Poisson</p>
</div>
<div class="definition-container">
<p>Diremos que una v.a. discreta <span class="math inline">\(X\)</span> con <span class="math inline">\(X(\Omega)=\mathbf{N}\)</span> tiene distribución de Poisson con parámetro <span class="math inline">\(\lambda&gt;0\)</span>, y lo denotaremos por <span class="math inline">\(Po(\lambda)\)</span> si su función de probabilidad es:</p>
<p><span class="math display">\[
P_{X}(x)=P(X=x)=
\left\{\begin{array}{ll}
\frac{\lambda^x}{x!} e^{-\lambda}&amp; \mbox{ si } x=0,1,\ldots\\
0 &amp; \mbox{en otro caso}\end{array}\right..
\]</span></p>
</div>
</div>
<p>Usando que el desarrollo en serie de Taylor de la función exponencial es <span class="math display">\[
e^{\lambda}=\sum_{x=0}^{+\infty} \frac{\lambda^x}{x!},
\]</span> es fácil comprobar que la suma de la función de probabilidad en todos los valores del dominio de <span class="math inline">\(X\)</span>, o sea, los enteros positivos, vale 1.</p>
<p>Además recordemos que dado <span class="math inline">\(x\in\mathbb{R}-\{0\}\)</span> se tiene que</p>
<p><span class="math display">\[
\lim_{n\to\infty} \left(1+\frac{x}{n}\right)^n=e^x.
\]</span></p>
<p>Usando la expresión anterior para <span class="math inline">\(x=-\lambda\)</span>, tenemos:</p>
<p><span class="math display">\[
\lim_{n\to\infty} \left(1-\frac{\lambda}{n}\right)^n=\lim_{n\to\infty} \left(1+\frac{-\lambda}{n}\right)^n=e^{-\lambda}.
\]</span></p>
<section id="la-distribución-de-poisson-como-límite-de-una-binomial." class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="la-distribución-de-poisson-como-límite-de-una-binomial."><span class="header-section-number">4.6.1</span> La distribución de Poisson como “límite” de una binomial.</h3>
<p>La distribución de Poisson (<a href="https://es.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson">Siméon Denis Poisson</a>) aparece en el conteo de determinados eventos que se producen en un intervalo de tiempo o en el espacio.</p>
<p>Supongamos que nuestra variable de interés es <span class="math inline">\(X\)</span>, el número de eventos en el intervalo de tiempo <span class="math inline">\((0,t]\)</span>, como por ejemplo el número de llamadas a un <em>call center</em> en una hora donde suponemos que se cumplen las siguientes condiciones:</p>
<ol type="1">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es <span class="math inline">\(\lambda&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo en un gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más eventos en un subintervalo es despreciable.</li>
<li>El número de ocurrencias de eventos en un intervalo es independiente del número de ocurrencias en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>·</li>
</ul></li>
</ol>
<p>Bajo estas condiciones, podemos considerar que el número de eventos en el intervalo <span class="math inline">\((0,t]\)</span> será el número de “éxitos” en <span class="math inline">\(n\)</span> repeticiones independientes de un proceso Bernoulli de parámetro <span class="math inline">\(p_n\)</span></p>
<p>Entonces si <span class="math inline">\(n\to\infty\)</span> y <span class="math inline">\(p_n\cdot n\)</span> se mantiene igual a <span class="math inline">\(\lambda\)</span> resulta que la función de probabilidad de <span class="math inline">\(X\)</span> se puede escribir como</p>
<p><span class="math display">\[
\begin{array}{rl}
P(X_n=k)&amp;=\left(\begin{array}{c} n\\ k\end{array}\right) \cdot p_n^k\cdot  (1-p_n)^{n-k}
\\
&amp;= {n\choose k}\cdot \left(\frac{\lambda}{n}\right)^{k}\cdot \left(1-\frac{\lambda}{n}\right)^{n-k}\\
&amp;=
\frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k}\cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\end{array}
\]</span></p>
<p>Si hacemos tender <span class="math inline">\(n\)</span> hacia <span class="math inline">\(\infty\)</span>, obtenemos: <span class="math display">\[
\lim_{n\to \infty} P(X_n=k) = \lim_{n\to \infty} \frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k} \cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\]</span></p>
<p>Calculemos el límite de algunos de los factores de la expresión</p>
<p><span class="math display">\[
\displaystyle\lim_{n\to \infty}\frac{n!}{(n-k)!\cdot n^k}= \lim_{n\to \infty}\frac{n\cdot (n-1)\cdots (n-k-1)}{n^k}
=\lim_{n\to \infty}\frac{n^{k}+\cdots}{n^k}=1.
\]</span></p>
<p><span class="math display">\[
\lim_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{n}=e^{-\lambda}
\]</span></p>
<p>Y también teniendo en cuenta que <span class="math inline">\(k\)</span> es constante.</p>
<p><span class="math display">\[
\lim_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{-k}=\lim_{n\to \infty} 1^{-k}=\lim_{n\to \infty}  1=1.
\]</span></p>
<p>Para acabar</p>
<p><span class="math display">\[
\displaystyle\lim_{n\to\infty} P(X_n=k)=
\lim_{n\to\infty} \left(\begin{array}{c} n\\ k\end{array}\right)
\cdot p_n^k \cdot (1-p_n)^{n-k}= \frac{\lambda^k}{k!}\cdot 1 \cdot e^{-\lambda}\cdot 1=\frac{\lambda^k}{k!}\cdot e^{-\lambda}.
\]</span></p>
<p>Lo que confirma que límite de una serie de variables <span class="math inline">\(B(n,p_n=\frac{\lambda}{n})\)</span> sigue una ley <span class="math inline">\(Po(\lambda)\)</span>.</p>
</section>
<section id="procesos-de-poisson" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="procesos-de-poisson"><span class="header-section-number">4.6.2</span> Procesos de Poisson</h3>
<p>Lo interesante de las variables Poisson es que podemos modificar (si el modelo lo permite) el intervalo de tiempo <span class="math inline">\((0,t]\)</span> en el que contamos los eventos.</p>
<p>Claro que esto no tiene que poder ser así.</p>
<p>Pero en general si la variable es poisson en <span class="math inline">\((0,t]\)</span> también lo será en cualquier subintervalo <span class="math inline">\((0,t']\)</span> para todo <span class="math inline">\(t'\)</span> tal que <span class="math inline">\(0&lt;t'&lt;t\)</span>.</p>
<p>Así que podremos definir una serie de variables <span class="math inline">\(X_t\)</span> de distribución <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<div class="definition">
<div class="definition-header">
<p>Definición: Procesos de Poisson</p>
</div>
<div class="definition-container">
<p>Consideremos un experimento <em>Poisson</em> con <span class="math inline">\(\lambda\)</span> igual al promedio de eventos en una unidad de tiempo (u.t.).</p>
<p>Si <span class="math inline">\(t\)</span> es una cantidad de tiempo en u.t., la v.a. <span class="math inline">\(X_{t}\)</span>=numero de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es una <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>El conjunto de variables <span class="math inline">\(\{X_t\}_{t&gt;0}\)</span> recibe el nombre de <strong>proceso de Poisson</strong>.</p>
</div>
</div>
</section>
<section id="resumen-distribución-poisson-xsim-polambda" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="resumen-distribución-poisson-xsim-polambda"><span class="header-section-number">4.6.3</span> Resumen distribución Poisson <span class="math inline">\(X\sim Po(\lambda)\)</span></h3>

</section>
<section id="aproximación-de-la-distribución-binomial-por-la-poisson" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="aproximación-de-la-distribución-binomial-por-la-poisson"><span class="header-section-number">4.6.4</span> Aproximación de la distribución binomial por la Poisson</h3>
<p>Bajo el punto de vista anterior y si <span class="math inline">\(p\)</span> es pequeño y <span class="math inline">\(n\)</span> suficientemente grande la distribución <span class="math inline">\(B(n,p)\)</span> se aproxima a una <span class="math inline">\(Po(\lambda=n\cdot p)\)</span>.</p>
<p>Existen distintos criterios (ninguno perfecto) de cuando la aproximación es buena.</p>
<p>Por ejemplo si</p>
<p><span class="math display">\[n\geq 20\mbox{ o mejor }n\geq 30, n\cdot p &lt; 10 \mbox{ y } p\leq 0.05,\]</span></p>
<p>la aproximación de una <span class="math inline">\(B(n,p)\)</span> por una <span class="math inline">\(Po(n\cdot p)\)</span> es buena. Sobre todo para los valores cercanos a <span class="math inline">\(E(X)=\lambda\)</span>.</p>
<p>Condición deseable <span class="math inline">\(n\geq 20\)</span>, <span class="math inline">\(n\cdot p &lt; 10\)</span>, <span class="math inline">\(p\leq 0.05\)</span>.</p>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: Trampa insectos.</p>
</div>
<div class="exe-container">
<p>La conocida <a href="https://es.wikipedia.org/wiki/Insecticida_el%C3%A9ctrico">lámpara antiinsectos o insecticida eléctrico</a> atrae a los insectos voladores con una luz ultravioleta y los mata por electrocución.</p>
<p>Consideremos la v.a. <span class="math inline">\(X\)</span> que cuenta el número de insectos caídos en la trampa en una hora. Supongamos que el número promedio de insectos que captura la trampa en una hora es <span class="math inline">\(E(X)=20\)</span> y que podemos admitir que <span class="math inline">\(X\)</span> sigue una ley de probabilidad <span class="math inline">\(Po(\lambda=20)\)</span>.</p>
<p>Nos piden</p>
<ol type="1">
<li>Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</li>
<li>Escribir de forma explicita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</li>
<li>¿Cuál es el valor esperando, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</li>
</ol>
<p><strong>Solución 1.</strong> Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</p>
<ol type="1">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,1]\)</span>, una hora es <span class="math inline">\(\lambda=20&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo de una hora en un gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más electrocuciones un subintervalo es despreciable. No es posible que dos mosquitos se electrocuten al mismo tiempo.</li>
<li>El número de ocurrencias, electrocuciones de insectos, en un intervalo es independiente del número de electrocuciones en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>· Podemos dividir los 20 insectos promedio entre los <span class="math inline">\(n\)</span> intervalos (trozo de hora) de forma que <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
<li>Por ejemplo si <span class="math inline">\(n=60\)</span> tenemos que <span class="math inline">\(p_n=\frac{20}{60}=\frac{1}{3}\)</span>. La probabilidad de que en un minuto la trampa chisporrotee es <span class="math inline">\(\frac{1}{3}\)</span>.</li>
</ul></li>
</ol>
<p><strong>Solución 2.</strong> Escribid de forma explicita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</p>
<p>La distribución de probabilidad de un <span class="math inline">\(Po(\lambda)\)</span> es</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}  \frac{\lambda^x}{x!}e^{-\lambda} &amp; \mbox{ si } x=0,1,\ldots\\ 0  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span></p>
<p>En nuestro caso, <span class="math inline">\(\lambda =20\)</span>:</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}\frac{20^x}{x!}e^{-20} &amp; \mbox{ si } x=0,1,\ldots\\ 0  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span></p>
<p>La función de distribución es</p>
<p><span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll}
0 &amp; \mbox{si } x&lt;0\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{\lambda^i}{i!}\cdot e^{-\lambda} &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span></p>
<p>En nuestro caso <span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll}
0 &amp; \mbox{si } x&lt;0\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{20^i}{i!}\cdot e^{-20} &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span></p>
<p><strong>Solución 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Nos piden la probabilidad siguiente: <span class="math display">\[
P(X=21)=\frac{20^{21}}{21!} e^{-20}=0.0846051.
\]</span></p>
<p>Para realizar el cálculo anterior, podemos usar <code>R</code> como calculadora o usar la función <code>dpois</code> que nos calcula la función de distribución de la variable de Poisson:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span><span class="sc">^</span><span class="dv">21</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">21</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">21</span>,<span class="at">lambda =</span> <span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
</div>
<p><strong>Solución 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Nos piden la probabilidad siguiente: <span class="math display">\[
\begin{array}{rl}
P(X\geq 6)&amp;=1- P(X&lt;6)=1-P(X\leq 5)=1-F_X(5)=1-\displaystyle\sum_{x=0}^{5} \frac{20^{x}}{x!}\cdot e^{-20}\\
&amp;=
1-\left(\frac{20^{0}}{0!}\cdot e^{-20}+\frac{20^{1}}{1!}\cdot e^{-20}+\frac{20^{2}}{2!}\cdot e^{-20}+\frac{20^{3}}{3!}\cdot e^{-20}+\frac{20^{4}}{4!}\cdot e^{-20}+\frac{20^{5}}{5!}\cdot e^{-20}\right)\\
&amp;=
1-e^{-20}\cdot \left(1+20+\frac{400}{4}+\frac{8000}{6}+\frac{160000}{24}+\frac{3200000}{120}\right)\\
&amp;=
1-e^{-20} \cdot \left(\frac{1 \cdot 120+20\cdot 120+400\cdot 30+8000\cdot 20+160000\cdot 24+3200000\cdot 1}{120}\right)\\
&amp;= 1-e^{-20}\cdot\left(\frac{4186520}{120}\right)=1-7.1908841\times 10^{-5} =0.9999281.
\end{array}
\]</span></p>
<p>Solución 5.** ¿Cuál es el valor esperado, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</p>
<p>El valor esperado del número de insectos caídos en la trampa en una hora es</p>
<p><span class="math display">\[E(X)=\lambda=20\]</span></p>
<p>Su varianza es <span class="math display">\[Var(X)=\lambda=20\]</span></p>
<p>y su desviación típica vale <span class="math display">\[\sqrt{Var(X)}=+\sqrt{\lambda}=+\sqrt{20}=4.47214.\]</span></p>
</div>
</div>
</section>
<section id="cálculos-poisson-con-con-r" class="level3" data-number="4.6.5">
<h3 data-number="4.6.5" class="anchored"><span class="header-section-number">4.6.5</span> Cálculos Poisson con con R</h3>
<p>Consideremos por ejemplo una v.a. <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(Po(\lambda=3)\)</span>. Calculemos <span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> con <code>R</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04978707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1493612</code></pre>
</div>
</div>
<p>Si quisiéramos hallar la función de distribución en los mismos valores anteriores, <span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span>, haríamos lo siguiente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04978707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1991483</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)<span class="sc">+</span><span class="fu">dpois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>) <span class="do">## es igual a ppois(1,lambda=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1991483</code></pre>
</div>
</div>
<p>A continuación, comprobemos que <span class="math inline">\(F_X(10)=\sum\limits_{x=0}^{10} P_X(x)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0497870684 0.1493612051 0.2240418077 0.2240418077 0.1680313557
 [6] 0.1008188134 0.0504094067 0.0216040315 0.0081015118 0.0027005039
[11] 0.0008101512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9997077</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">10</span>,<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9997077</code></pre>
</div>
</div>
<p>Si quisiéramos generar una secuencia de <span class="math inline">\(100\)</span> observaciones para una distribución de Poisson de parámetro <span class="math inline">\(\lambda=3\)</span>, <span class="math inline">\(Po(3)\)</span>, tendríamos que hacer:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2 5 3 3 2 2 5 2 4 4 2 3 2 2 2 2 2 3 3 5 3 3 2 4 2 3 2 1 1 3 4 6 2 5 3
 [36] 4 1 1 6 3 4 1 4 3 4 3 0 2 1 4 3 0 2 4 2 3 5 2 1 3 3 4 2 5 0 3 1 1 4 6
 [71] 4 5 0 4 0 3 3 3 4 1 2 6 2 2 2 2 1 2 5 2 5 3 7 3 5 2 3 2 1 3</code></pre>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejemplo: Trampa para insectos (continuación)</p>
</div>
<div class="exe-container">
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con R a la preguntas 3 y 4 de este ejercicio</p>
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X=21)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">21</span>,<span class="at">lambda=</span><span class="dv">20</span>)<span class="co"># P(X=21)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
</div>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X\geq 6)=1-P(X&lt;6)=1-P(X\leq 5)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.190884e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>) <span class="co"># es 1-P(X&lt;=5)=P(X&gt;=6)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>,<span class="at">lower.tail =</span><span class="cn">FALSE</span> ) <span class="co"># acumula hacia arriba </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X&gt;5)=P(X&gt;=6)=P(X=6)+P(X=7)+...</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tiny">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">20</span>; <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)); n<span class="ot">=</span><span class="fu">qpois</span>(<span class="fl">0.99</span>,<span class="at">lambda=</span>lambda)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>); aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>ymax<span class="ot">=</span><span class="fu">max</span>(<span class="fu">ppois</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">lambda=</span>lambda)) </span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda),</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"Función de probabilidad"</span>,</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st">  Po(lambda="</span>,lambda,<span class="st">")"</span>)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ppois</span>(x,<span class="at">lambda=</span>lambda),</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">ylab=</span><span class="st">"Función de Distribución"</span>,</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución </span><span class="sc">\n</span><span class="st"> Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/graficosPOISON-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<section id="cálculos-poisson-con-python" class="level3" data-number="4.6.6">
<h3 data-number="4.6.6" class="anchored" data-anchor-id="cálculos-poisson-con-python"><span class="header-section-number">4.6.6</span> Cálculos Poisson con python</h3>
<p>Sea <span class="math inline">\(X\)</span> un una v.a. <span class="math inline">\(Po(\lambda=3)\)</span>. Entonces</p>
<p><span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> en este orden son</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.049787068367863944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14936120510359185</code></pre>
</div>
</div>
<p>Sea <span class="math inline">\(X\)</span> un una v.a. <span class="math inline">\(Po(\lambda=3)\)</span>. Entonces</p>
<p><span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span> en este orden son</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.04978706836786395</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1991482734714558</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)<span class="op">+</span>poisson.pmf(<span class="dv">1</span>,mu<span class="op">=</span> <span class="dv">3</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1991482734714558</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">## es igual a poisson.cdf(1,lambda=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por ejemplo podemos comprobar que <span class="math inline">\(F_X(10)=\displaystyle\sum_{0}^{10} P_X(x)\)</span></p>
<div class="tiny">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.04978707, 0.14936121, 0.22404181, 0.22404181, 0.16803136,
       0.10081881, 0.05040941, 0.02160403, 0.00810151, 0.0027005 ])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9988975118698846</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">10</span>,mu<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9997076630493527</code></pre>
</div>
</div>
</div>
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con python a la preguntas 3 y 4 de este ejercicio</p>
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>La respuesta a la pregunta 3 es calcular <span class="math inline">\(P(X=21)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">21</span>,mu<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.08460506418293791</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X=21)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>La pregunta 4 nos pide calcular <span class="math inline">\(P(X\geq 6)=1-P(X\leq 5)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>poisson.cdf(<span class="dv">5</span>,mu<span class="op">=</span><span class="dv">20</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9999280911594716</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># es 1-P(X&lt;=5)=P(X&gt;=6)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como ya hemos visto con <code>scipy.stats</code> podemos pedir los momentos de una variable aleatoria <span class="math inline">\(Po(3)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>poisson.stats(mu<span class="op">=</span><span class="dv">3</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(array(3.), array(3.))</code></pre>
</div>
</div>
<p>Y también generar secuencias de observaciones aleatorias de una población <span class="math inline">\(Po(3)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>poisson.rvs(mu<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">40</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([1, 4, 1, 5, 3, 3, 0, 0, 3, 5, 7, 3, 2, 2, 4, 3, 3, 2, 2, 2, 2, 3,
       5, 2, 2, 6, 5, 3, 1, 1, 2, 4, 3, 5, 3, 4, 2, 2, 2, 6], dtype=int64)</code></pre>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">10</span> <span class="co"># mu = lambda</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(poisson.ppf(<span class="fl">0.01</span>, mu),poisson.ppf(<span class="fl">0.99</span>, mu))</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, poisson.pmf(x, mu), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'poisson pmf'</span>)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, poisson.pmf(x, mu), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks(): </span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>ax.plot(x, poisson.cdf(x, mu), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'poisson cdf'</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, poisson.cdf(x, mu), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion de Poisson'</span>)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/py_poiss2_plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<div class="ex">
<div class="exe-header">
<p>Ejemplo:Número de impactos de insectos en la visera de un casco</p>
</div>
<div class="exe-container">
<p>Un colega de trabajo, al que llamaremos JG, es muy aficionado a los grandes premios de velocidad tanto en coches como en motos.</p>
<p>Como es tan aficionado está obsesionado con muchas de las más extravagantes estadísticas de estos deportes. En particular le propusimos que estudiara el número de insectos que chocan contra la visera de un casco de un motorista GP o de un conductor de fórmula 1 .</p>
<p>La idea es que el número de insectos está igualmente repartido por todo el circuito y de promedio impactan <span class="math inline">\(\lambda&gt;0\)</span> insectos por minuto. También es razonable suponer que:</p>
<ul>
<li>podemos dividir la superficie de la visera en cuadrados suficientemente pequeños de forma que la probabilidad de que caigan dos insectos en la misma zona es prácticamente 0.</li>
<li>la probabilidad de que un insecto impacte en un cuadrado cualquiera de la visera es independiente de cualquier otro cuadrado.</li>
<li>si hemos dividido la visera en <span class="math inline">\(n\)</span> cuadrados la probabilidad <span class="math inline">\(p_n\)</span> de impacto de un cuadrado vale <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
</ul>
<p>Bajo estas condiciones, si denotamos por <span class="math inline">\(X_t\)</span> como el número de insectos que ha impactado en la visera en el intervalo <span class="math inline">\((0,t]\)</span> (en <span class="math inline">\(t\)</span> minutos), podemos afirmar que <span class="math inline">\(X_t\)</span> es un proceso de Poisson <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>Supongamos que nos dicen que <span class="math inline">\(\lambda=3\)</span> insectos por minuto. Entonces el proceso de poisson <span class="math inline">\(X_t\)</span> seguirá un ley <span class="math inline">\(Po(3\cdot t).\)</span></p>
<p>Ahora estamos en condiciones de preguntar al proceso de Poisson.</p>
<p>¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?</p>
<p>En este caso <span class="math inline">\(t=10\)</span> <span class="math inline">\(X_{10}\)</span>= número de insectos que impactan en 10 minutos, el intervalo <span class="math inline">\([0,10)\)</span> que sigue una <span class="math inline">\(P(3\cdot 10=30)\)</span>. Por lo tanto</p>
<p><span class="math display">\[P(X&gt;25)=1-P(X\leq 25)\]</span></p>
<p>lo resolvemos con R</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(<span class="dv">25</span>,<span class="at">lambda=</span><span class="dv">30</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7916426</code></pre>
</div>
</div>
<p>Otra pregunta interesante es que tengamos que esperar más de 2 minutos para observar el primer impacto</p>
<p><span class="math display">\[P(X_2=0)=\frac{(3\cdot 2)^0}{0!}\cdot e^{-3\cdot 2}= e^{-6}=0.002479.\]</span></p>
<p>Con R</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">^</span><span class="dv">0</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">0</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002478752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">0</span>,<span class="at">lambda=</span><span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002478752</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="distribución-hipergeométrica" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="distribución-hipergeométrica"><span class="header-section-number">4.7</span> Distribución hipergeométrica</h2>
<p>Supongamos que disponemos de una urna de de sorteos que contiene <span class="math inline">\(m\)</span> bolas blancas y <span class="math inline">\(n\)</span> bolas rojas.</p>
<p>En total en esta urna hay <span class="math inline">\(m+n\)</span> bolas, <span class="math inline">\(m\)</span> blancas y <span class="math inline">\(n\)</span> rojas. Si extraemos dos bolas de la urna lo podemos hacer de dos formas:</p>
<ul>
<li>Extraer una anotar su color y reponerla. Sacar otra y anotar su color. Hemos extraído la bola con reposición.</li>
<li>Extraer simultáneamente dos bolas (sin reposición) y contar el número de bolas blancas.</li>
</ul>
<p>Sea <span class="math inline">\(X\)</span> es la v.a. que cuenta el número de bolas blancas extraídas.</p>
<ul>
<li>En el primer caso, <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=2,p=\frac{m}{m+n})\)</span> ya que consiste en repetir dos veces el mismo experimento de Bernoulli.</li>
<li>En el segundo caso, <span class="math inline">\(X\)</span> sigue una distribución hipergeométrica que estudiaremos en esta sección.</li>
</ul>
<div class="definition">
<div class="definition-header">
<p>Distribución hipergeométrica</p>
</div>
<div class="definition-container">
<p>Sean <span class="math inline">\(n\)</span>, <span class="math inline">\(m\)</span> y <span class="math inline">\(k\)</span> tres número enteros positivos y tales que <span class="math inline">\(k&lt;m+n\)</span>.</p>
<p>Consideremos una urna que contiene <span class="math inline">\(m+n\)</span> bolas de las que <span class="math inline">\(m\)</span> son blancas y las restantes <span class="math inline">\(n\)</span> no (son no blancas).</p>
<p>El número total de bolas es <span class="math inline">\(m+n\)</span>. Extraemos de forma aleatoria <span class="math inline">\(k\)</span> bolas de la urna sin reemplazarlas.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de bolas blancas extraídas. Diremos que la distribución de <span class="math inline">\(X\)</span> es hipergeométrica de parámetros <span class="math inline">\(m\)</span>, <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span> y la denotaremos por <span class="math inline">\(H(m,n,k)\)</span>.</p>
<p>Su dominio es</p>
<p><span class="math display">\[D_X=\left\{x\in\mathbf{N}\mid \max\{0,k-n\}\leq  x \leq \min\{m,k\}\right\}\]</span></p>
</div>
</div>
<p>Fijemos ideas de cómo varía el dominio según los paraámetros <span class="math inline">\(m\)</span>, <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span>.</p>
<p>Para explicarlo, veamos varios ejemplos:</p>
<ul>
<li><span class="math inline">\(H(m=5,n=2,k=3)\)</span>. Tenemos <span class="math inline">\(m=5\)</span> bolas blancas, <span class="math inline">\(n=2\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas extraídas es <span class="math inline">\(1=k-n=3-2\)</span>, ya que sólo hay dos no blancas.</li>
<li>En cambio, el máximo si es <span class="math inline">\(k=3\)</span>, ya que tenemos bolas blancas de “sobra”.</li>
</ul></li>
</ul>
<p><span class="math display">\[D_X=\left\{x\in\mathbf{N}\mid \max\{0,k-n\}\leq  x \leq \min\{m,k\}\right\}\]</span></p>
<ul>
<li><span class="math inline">\(H(m=2,n=5,k=3)\)</span>. Tenemos <span class="math inline">\(m=2\)</span> bolas blancas, <span class="math inline">\(n=5\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas es <span class="math inline">\(0\)</span> ya que puedo sacar 3 no blancas.</li>
<li>En cambio, el máximo si es <span class="math inline">\(m=2\)</span>, ya que aunque saquemos <span class="math inline">\(k=3\)</span> bolas, al llegar a 2 ya hemos extraído todas las bolas blancas de la urna.</li>
</ul></li>
<li><span class="math inline">\(H(m=10,n=10,k=3)\)</span>. Tenemos <span class="math inline">\(m=10\)</span> bolas blancas, <span class="math inline">\(n=10\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso podemos obtener desde <span class="math inline">\(0\)</span> blancas hasta <span class="math inline">\(k=3\)</span> blancas.</li>
</ul></li>
</ul>
<p>Su función de probabilidad es: <span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\}, \mbox { para  } x\in \mathbf{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Observación: otras parametrizaciones</strong></p>
<p>En ocasiones se parametriza una v.a. hipergeométrica mediante <span class="math inline">\(N=m+n\)</span>, número total de bolas, <span class="math inline">\(k\)</span>, número de extracciones y <span class="math inline">\(p\)</span>, probabilidad de extraer una bola blanca.</p>
<p>Así podemos <strong>parametrizar alternativamente</strong> la distribución hipergeométrica así</p>
<p><span class="math display">\[H(N,k,p)\mbox{ donde } p=\frac{m}{N}.\]</span></p>
<section id="resumen-distribución-hipergeométrica-hmnk." class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="resumen-distribución-hipergeométrica-hmnk."><span class="header-section-number">4.7.1</span> Resumen distribución Hipergeométrica <span class="math inline">\(H(m,n,k)\)</span>.</h3>
<div class="ex">
<div class="exe-header">
<p>Ejemplo clásico urna <span class="math inline">\(m=15\)</span> blancas, <span class="math inline">\(n=10\)</span> rojas y <span class="math inline">\(k=3\)</span> extracciones sin reposición.</p>
</div>
<div class="exe-container">
<p>Tenemos una urna con 15 bolas blancas y 10 bolas rojas. Extraemos al azar tres bolas de la urna sin reposición. Sea <span class="math inline">\(X\)</span> el número de bolas <strong>blancas</strong> extraídas. Bajo esta condiciones, la v.a. <span class="math inline">\(X\)</span> sigue una ley de distribución <span class="math inline">\(H(m=15,n=10,k=3)\)</span>.</p>
<p>Su función de probabilidad es</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}} &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\} \mbox { para  } x\in \mathbf{N}\\
0  &amp; \mbox{en otro caso}\end{array}\right.,
\]</span></p>
<p><span class="math display">\[\mbox{sustituyendo }\scriptsize{
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{15}{x}\cdot \binom{10}{3-x}}{\binom{25}{3}} &amp; \mbox{ si }
0\leq x \leq 3 \mbox { para  } x\in \mathbf{N}\\
0  &amp; \mbox{en otro caso}\end{array}\right.
}\]</span></p>
<p>La probabilidad de sacar 2 blancas será</p>
<p><span class="math display">\[
P(X=2)=\frac{\binom{15}{2}\cdot \binom{10}{3-2}}{\binom{25}{3}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">choose</span>(<span class="dv">15</span>,<span class="dv">2</span>), <span class="fu">choose</span>(<span class="dv">10</span>,<span class="dv">1</span>), <span class="fu">choose</span>(<span class="dv">25</span>,<span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  105   10 2300</code></pre>
</div>
</div>
<p><span class="math inline">\(P(X=2)=\frac{105\cdot10 }{2300}=0.4565217.\)</span></p>
<p>La probabilidad de que saquemos más de 1 bola blanca es</p>
<p><span class="math display">\[
\begin{array}{rl}
P(X&gt; 1)&amp;= 1-P(X\leq 1)=1-(P(X=0)+P(X=1))\\
&amp;=
1-\left(\frac{\binom{15}{0}\cdot \binom{10}{3}}{\binom{25}{3}}+
\frac{\binom{15}{1}\cdot \binom{10}{2}}{\binom{25}{3}}\right)\\
&amp;=
1-\left(
\frac{1\cdot120 }{2300}+\frac{15\cdot45 }{2300}
\right)=1-\frac{120+15\cdot 45}{2300}=0.6543478.
\end{array}
\]</span></p>
<p>El número esperado de bolas blancas extraídas para una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(H(m=15,n=10,k=3)\)</span> es</p>
<p><span class="math display">\[E(X)=\frac{k\cdot m}{m+n}=\frac{3\cdot 15}{15+10}=\frac{45}{35}=1.285714.\]</span></p>
<p>La varianza vale: <span class="math display">\[
\begin{array}{rl}
Var(X)&amp;=k\cdot\frac{m}{m+n}\cdot\left(1-\frac{m}{m+n}\right) \cdot\frac{m+n-k}{m+n-1}\\
&amp;=3\cdot\frac{15}{15+10}\cdot\left(1-\frac{15}{15+10}\right) \cdot\frac{15+10-3}{15+10-1}\\
&amp;=
3\cdot\frac{15}{25}\cdot\left(1-\frac{15}{25}\right) \cdot\frac{22}{24}=
3\cdot\frac{15}{25}\cdot\frac{25-15}{25} \cdot\frac{22}{24}\\
&amp;=
3\cdot\frac{15}{25}\cdot\frac{10}{25}\cdot\frac{22}{24}=0.66.
\end{array}
\]</span></p>
<p>Y por lo tanto su desviación típica es <span class="math inline">\(+\sqrt{Var(X)}=+\sqrt{0.66}=0.812404.\)</span></p>
</div>
</div>
</section>
<section id="cálculos-y-gráficos-distribución-hipergeométrica-con-r" class="level3" data-number="4.7.2">
<h3 data-number="4.7.2" class="anchored" data-anchor-id="cálculos-y-gráficos-distribución-hipergeométrica-con-r"><span class="header-section-number">4.7.2</span> Cálculos y gráficos distribución hipergeométrica con R</h3>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(H(m,n,k)\)</span>. La función de <code>R</code> para calcular la función de probabilidad en un valor <span class="math inline">\(x\)</span>, <span class="math inline">\(P(X=x)\)</span>, es <code>dhyper(x,m,n,k)</code> y para calcular la función de distribución en un valor <span class="math inline">\(q\)</span>, <span class="math inline">\(P(X\leq q)\)</span>, es <code>phyper(q,m,n,k)</code>. Para generar una muestra de valores que siga la distribución <span class="math inline">\(H(m,n,k)\)</span>, hay que usar la función <code>rhyper(nn,m,n,k)</code> donde <code>nn</code> es el número de observaciones aleatorias deseado de la muestra.</p>
<p>Por ejemplo, si <span class="math inline">\(X\)</span> es una <span class="math inline">\(H(m=15,n=10,k=3)\)</span>, los valores de <span class="math inline">\(P(X=2)\)</span> y que <span class="math inline">\(P(X&gt;1)=1-P(X\leq 1)\)</span> son:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dhyper</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4565217</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">phyper</span>(<span class="at">q=</span><span class="dv">1</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)<span class="co"># sí, le han puesto q ya veremos el porqué</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3456522</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">phyper</span>(<span class="at">q=</span><span class="dv">1</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6543478</code></pre>
</div>
</div>
<p>Una muestra aleatoria de este experimento de tamaño 200 sería:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rhyper</span>(<span class="at">nn=</span><span class="dv">200</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2 3 1 3 1 2 2 3 2 2 1 2 1 2 2 3 3 1 1 1 1 0 2 3 2 1 3 2 2 2 2 3 2 3 3
 [36] 2 0 1 2 1 3 2 2 3 2 3 2 2 3 2 3 1 2 2 2 2 3 2 2 1 3 2 2 3 1 2 2 2 2 2
 [71] 3 0 2 0 3 2 2 2 1 2 2 3 1 1 1 2 2 2 2 1 1 3 2 2 3 2 2 1 1 1 3 3 2 2 2
[106] 1 3 2 2 2 1 1 2 3 2 2 1 2 2 2 2 2 2 3 1 2 3 3 1 1 2 2 1 1 3 2 1 1 2 2
[141] 3 1 1 1 2 1 1 3 1 2 2 3 3 2 3 1 2 1 2 2 2 1 2 3 1 3 3 3 2 2 1 3 3 1 1
[176] 2 2 2 2 2 3 2 1 2 1 1 1 1 2 1 1 2 2 2 2 3 3 1 0 2</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(H(m,n,k)\)</span>, las funciones de <code>scipy.stats</code> cambian los parámetros</p>
<ul>
<li><span class="math inline">\(M\)</span> es el número total de bolas. Con nuestra parametrización <span class="math inline">\(M=m+n\)</span>.</li>
<li><span class="math inline">\(n\)</span> es el número de bolas blancas. Con nuestra parametrización <span class="math inline">\(n=m\)</span>.</li>
<li><span class="math inline">\(N\)</span> es el número de extracciones. Con nuestra parametrización <span class="math inline">\(N=k\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cálculos-y-gráficos-distribución-hipergeométrica-con-python" class="level3" data-number="4.7.3">
<h3 data-number="4.7.3" class="anchored" data-anchor-id="cálculos-y-gráficos-distribución-hipergeométrica-con-python"><span class="header-section-number">4.7.3</span> Cálculos y gráficos distribución hipergeométrica con python</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>hypergeom.pmf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2934782608695652</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3456521739130434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.6543478260869566</code></pre>
</div>
</div>
<p>Una muestra aleatoria de este experimento sería…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>hypergeom.rvs(M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([1, 2, 1, 3, 1, 3, 1, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 3, 1, 3, 0, 2,
       1, 1, 3, 2, 1, 2, 3, 3, 0, 2, 3, 1, 2, 2, 2, 2, 3, 3, 1, 2, 2, 1,
       2, 1, 2, 2, 1, 3, 1, 2, 1, 2, 0, 3, 1, 2, 3, 2, 2, 2, 2, 3, 2, 1,
       3, 2, 2, 3, 2, 1, 1, 1, 3, 2, 3, 2, 1, 2, 1, 1, 2, 1, 2, 1, 1, 2,
       2, 3, 1, 2, 0, 0, 2, 1, 2, 2, 2, 1], dtype=int64)</code></pre>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>[M, n, N] <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">7</span>, <span class="dv">12</span>] <span class="co">##20 elementos, 7 del tipo, extraemos 12</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">max</span>(<span class="dv">0</span>, N<span class="op">-</span>M<span class="op">+</span>n),<span class="bu">min</span>(n, N))</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.plot(x, hypergeom.pmf(x, M, n, N), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'hypergeom pmf'</span>)</span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.pmf(x, M, n, N), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.set_ylim([<span class="dv">0</span>, <span class="bu">max</span>(hypergeom.pmf(x, M, n, N))<span class="op">*</span><span class="fl">1.1</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.plot(x, hypergeom.cdf(x, M, n, N), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'hypergeom cdf'</span>)</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.cdf(x, M, n, N), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>fig.suptitle(<span class="st">'Distribucion Hipergeometrica'</span>)</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="p01_04_1_Notables_discretas_files/figure-html/py_hyper2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/uib\.es");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p01_03_variables_aleatorias.html" class="pagination-link" aria-label="Introducción a las variables aleatorias">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducción a las variables aleatorias</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>IZQ.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ricuib/edit/main/p01_04_1_Notables_discretas.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/ricuib/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>DRA.</p>
</div>
  </div>
</footer>




</body></html>