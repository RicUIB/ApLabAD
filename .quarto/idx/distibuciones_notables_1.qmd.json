{"title":"Distribuciones notables 1","markdown":{"headingText":"Distribuciones notables 1","containsRefs":false,"markdown":"\n\n\n```{r setup0, include = FALSE}\nknitr::opts_chunk$set(echo = TRUE, cache = FALSE,\n                      fig.align = 'center',out.width = \"70%\")\nlibrary(reticulate)\noptions(width = 75)\n```\n\n## Introducción\n\nEn este tema estudiaremos diversos tipos de experimentos que son muy frecuentes y algunas de las variables aleatorias asociadas a ellos. \n\nEstas variables reciben distintos nombres que aplicaremos sin distinción al tipo de población del experimento a la variable o a su función de probabilidad, densidad o distribución.\n\nEmpezaremos con las variables aleatorias discretas que se presentan con frecuencia ya que están relacionadas con situaciones muy comunes como el número de caras en varios lanzamiento de una moneda, el número de veces que una maquina funciona hasta que se estropea, el numero de clientes en una cola,...\n\n\n\n\n## Distribución Bernoulli\n\n \n::::: callout-definicion\n::: callout-title\n<i class=\"bi bi-book\"> Distribución Bernoulli </i>\n:::\n::: callout-body\nConsideremos un experimento con dos resultados posibles éxito (E) y\nfracaso (F).  El espacio de sucesos será $\\Omega=\\{E,F\\}$.\n\nSupongamos que la probabilidad de éxito es  $P(E)=p$,  y naturalmente $P(F)=1-p=q$ con $0<p<1$.\n\nConsideremos la  aplicación \n\n$$\nX:\\Omega=\\{E,F\\}\\to \\mathbb{R}\n$$\n\ndefinida por\n\n$$\nX(E)=1\\mbox{, }X(F)=0.\n$$\n\nSu  función de probabilidad es\n\n\n$$\nP_{X}(x)=\n\\left\\{\n\\begin{array}{ll} 1-p=q & \\mbox{si } x=0\\\\\np & \\mbox{si } x=1\\\\\n0 & \\mbox{en cualquier otro caso}\n\\end{array}\n\\right..\n$$\n\nSu función de distribución es \n\n$$\nF_{X}(x)=P(X\\leq x)=\n\\left\\{\n\\begin{array}{ll} \n0 & \\mbox{si } x<0\\\\\n1-p=q & \\mbox{si } 0\\leq x <1\\\\\n1 & \\mbox{si } 1\\leq x \\\\\n\\end{array}\n\\right..\n$$\n\n\nBajo estas condiciones diremos que $X$  **es una v.a. Bernoulli** o que  sigue una ley de  **distribución de probabilidad  Bernoulli** de parámetro $p$.\n* Lo denotaremos por\n$$X\\sim Ber(p)\\mbox{ o también } X\\sim B(1,p).$$\n:::\n:::::\n\n\nEste tipo de experimentos (éxito/fracaso)se reciben el nombre de experimentos Bernoulli.\n\nFue su descubridor un científico suizo  [Jacob Bernoulli](https://es.wikipedia.org/wiki/Jakob_Bernoulli),  uno más de la conocida [familia de científicos suizos Bernoulli](https://es.wikipedia.org/wiki/Familia_Bernoulli).\n\n\nSu **valor esperado** es \n\n$$E(X)=\\displaystyle\\sum_{x=0}^1 x\\cdot P(X=x)= 0\\cdot(1-p)+1\\cdot p=p.$$\n\n\n\nCalculemos también $E(X^2)$\n\n$$E(X^2)=\\displaystyle\\sum_{x=0}^1 x^2\\cdot P(X=x)= 0^2\\cdot(1-p)+1^2\\cdot p=p.$$\n\n\nLa   **varianza**  de una va.a Bernouilli es \n\n$$Var(X)=E(X^2)-\\left(E(X)\\right)^2=p-p^2=p\\cdot (1-p)=p\\cdot q.$$\n\n\nSu desviación típica es \n\n$$\n\\sqrt{Var(X)}=\\sqrt{p \\cdot (1-p)}.\n$$\n\nPongamos en una tabla resumen v.a con distribución Bernoulli\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X$ Bernoulli:  $Ber(p)$ \n\\\\\\hline\n$\\scriptstyle{ D_X=   \\{0,1\\}}$  \n\\\\\\hline\n$\\scriptsize{P_X(x)=P(X=x)=\n\\left\\{\n\\begin{array}{ll}\n1-p=q & \\mbox{ si } x=0\\\\\np & \\mbox{ si } x=1 \\\\\n0  & \\mbox{ en otro caso.}\n\\end{array}\\right.}\n$ \n\\\\\\hline\n$\\scriptsize{  F_X(x)=P(X\\leq X)=\n\\left\\{\n\\begin{array}{ll}\n  0 &   \\mbox{ si } x<0\\\\ \n (1-p)  &  \\mbox{ si } 0\\leq x< 1 \\\\ \n1 & \\mbox{ si } x\\geq 1\n\\end{array}\n\\right.}$.\n\\\\\\hline\n$\\scriptstyle E(X)=p$; $\\scriptstyle  Var(X)= p \\cdot (1-p)$ \\\\\\hline\n\\end{tabular}\n\\end{table}\n\n\n\n::::: callout-ejemplo\n::: callout-title\n<i class=\"bi bi-list-task\"> Ejemplo : Cálculos con R</i> \n:::\n::: callout-body\n\nVeamos los cálculos básicos $Ber(p=0.25)$ en `R`.\n\n```{r binomialfunciones}\ndbinom(0,size=1,prob=0.25)\ndbinom(1,size=1,prob=0.25)\nrbinom(n=20,size = 1,prob=0.25)\n```\n\n\nEl siguiente código dibuja las función de probabilidad y la de distribución de una  $Ber(p=0.25)$\n\n```{r ber_plot_1, fig.align='center',echo=FALSE,out.fig=\"80%\"}\npar(mfrow=c(1,2))\nplot(x=c(0,1),y=dbinom(c(0,1),size=1,prob=0.25),\n     ylim=c(0,1),xlim=c(-1,2),xlab=\"x\",\n     main=\"Función de probabilidad\\n Ber(p=0.25)\")\nlines(x=c(0,0,1,1),y=c(0,0.75,0,0.25), type = \"h\", lty = 2,col=\"blue\")\ncurve(pbinom(x,size=1,prob=0.25),\n      xlim=c(-1,2),col=\"blue\",\n      main=\"Función de distribución\\n Ber(p=0.25)\")\npar(mfrow=c(1,1))\n```\n\n:::\n:::::\n\n\n## Distribución binomial\n\n::::: callout-definicion\n::: callout-title\n<i class=\"bi bi-book\"></i> Distribución binomial\n:::\n::: callout-body\n\nSi repetimos $n$ veces de forma independiente un experimento Bernoulli de parámetro $p$.\n\nEl espacio muestral $\\Omega$ estará formado por cadenas de $E$'s y $F$'s de longitud $n$\nConsideremos la v.a.\n\n$$X(\\overbrace{EFFF\\ldots EEF}^{n})=\\mbox{número de éxitos en la cadena}.$$\nA la variable aleatoria anterior se le conoce como distribución binomial de parámetros $n$ y $p$, y lo denotaremos por $X\\sim B(n,p).$\n\nObviamente se tiene que una v.a. Bernoulli es una binomial con $n=1$\n\n$$B(1,p)=Ber(p).$$\n:::\n:::::\n\n\nLa **función de probabilidad** de una binomial es \n\n$$\nP_{X}(x)=\\left\\{\n\\begin{array}{ll}\n{n\\choose x}\\cdot  p^x \\cdot(1-p)^{n-x} &\\mbox{ si } x=0,1,\\ldots,n\\\\\n0  & \\mbox{ en otro caso}\n\\end{array}\\right..\n$$\n\n\nSu **función de distribución** no tiene una fórmula cerrada. Hay que acumular la función de probabilidad:\n\n\n\\begin{eqnarray*}\nF_{X}(x)=P(X\\leq x) & = & \\sum_{i=0}^x P_X(i)\\\\\n& = & \n\\left\\{\n\\begin{array}{ll}\n0 & \\mbox{ si } x<0\\\\\\displaystyle\n\\sum_{i=0}^k {n\\choose i}\\cdot  p^i \\cdot (1-p)^{n-i} & \\mbox{ si } \n\\left\\{\n  \\begin{array}{l} \n  k\\leq x< k+1\\\\\n  k=0,1,\\ldots,n.\n  \\end{array}\n\\right.\\\\\n1 & \\mbox{ si } n\\leq x\n\\end{array}\n\\right.\n\\end{eqnarray*}\n\n\n\n\nRecordemos los números binomiales con un ejemplo\n\n\n::::: callout-ejemplo\n::: callout-title\n<i class=\"bi bi-list-task\"> Números binomiales</i> \n:::\n::: callout-body\nLos números binomiales calculan el número de equipos de baloncesto distintos que  ($k=5$ jugadores) se pueden hacer con 6 jugadores ($n=6$).\n\nEs decir cuántas  maneras distintas hay para elegir (*choose*) 5 jugadores en un conjunto de 6 jugadores. Todo el mundo diría \n¡¡¡6!!!. Efectivamente con R es \n\n```{r}\nchoose(6,5)\n```\n\nCon 10 jugadores  el número de equipos de  5 distintos es bastante más grande\n\n```{r}\nchoose(10,5)\n```\nY, por ejemplo, con un equipo de fútbol profesional  que tiene en plantilla 22 jugadores  (quitando los guardametas) se pueden formar ¡¡nada menos que!!\n\n```{r}\nchoose(22,10)\n```\nun bonito número capicúa que nos da el número de equipos distintos que se pueden formar.\n:::\n:::::\n\n<br>\n<br>\n\n\n::::: callout-ejemplo\n::: callout-title\n<i class=\"bi bi-list-task\"> Ejercicio</i>\n:::\n::: callout-body\nCalculad las funciones de distribución de una binomial $B(n=1,p=0.3)$ y comprobar que coinciden con  las distribuciones de una $Ber(p=0.3)$.\n:::\n:::::\n\n<br>\n<br>\n\n::::: callout-nota\n::: callout-title\n<i class=\"bi bi-info-circle\"> Observaciones sobre la distribución binomial</i> \n:::\n::: callout-body\n* La probabilidad de fracaso se suele denotar con  $q=1-p$, **sin ningún aviso adicional**, con el fin de acortar  y agilizar la escritura de las  fórmulas.\n* Su **función de distribución no tienen una formula general**, hay que calcularla con una función de R o python... En el siglo pasado se tabulaban en los libros de papel :-).\n* En el material adicional os pondremos unas tablas de esta distribución\npara distintos valores de $n$ y $p$ para que disfrutéis de tan ancestral método de cálculo. \n* Cualquier paquete estadístico, hoja de cálculo dispone de\nfunciones para el cálculo de estas probabilidades, así que el **uso de las tablas** queda **totalmente anticuado**. \n:::\n:::::\n\n<br>\n\nLa **esperanza**  de una v.a. $X$ con distribución  $B(n,p)$  es\n\n$$E(X)=\\displaystyle\\sum_{k=0}^n k \\cdot  {n \\choose k }\\cdot p^k\\cdot q^{n-k} = n\\cdot p.$$\n\nLa esperanza de $X^2$ es \n\n\n\\begin{eqnarray*}\nE(X^2)&=& \\displaystyle\\sum_{k=0}^n k^2 \\cdot  {n \\choose k }\\cdot p^k\\cdot q^{n-k}\\\\\n&=& n\\cdot p\\cdot q+(n\\cdot p)^2.\n\\end{eqnarray*}\n\n\nPor lo tanto su **varianza** se calcula así \n\n$$Var(X)=E(X^2)-\\left(E(X)\\right)^2=n\\cdot p \\cdot q=n\\cdot p\\cdot (1-p).$$\n\nSu desviación  típica es\n \n $$\\sqrt{n\\cdot p\\cdot q}=\\sqrt{n\\cdot p\\cdot (1-p)}.$$\n \n \nEn temas posteriores veremos una forma sencilla del cálculo de la esperanza y varianza de una $B(n,p)$ como las suma de $n$ v.a. $Ber(p)$ independientes.\n\n  \n::::: callout-ejercicio\n::: callout-title\n<i class=\"bi bi-pencil-square\"> Ejercicio</i> \n:::\n\n::: callout-body\nJustificar de forma intuitiva que si $X_i$ con $i=1,2,\\ldots, n$ son v.a. $Ber(p)$ independientes  entonces $X=\\displaystyle\\sum_{i=1}^n X_i$ sigue una distribución $B(n,p).$ \n:::\n:::::\n\n\n### Resumen v.a con distribución binomial $B(n,p)$\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X$ binomial:   $B(n,p)$ \\\\\\hline\n$\\scriptstyle  D_X=   \\{0,1,\\ldots n\\}$  \\\\\\hline\n$\\scriptstyle P_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}\\scriptstyle {n\\choose x}\\cdot  p^x\\cdot  (1-p)^{n-x} & \\mbox{ si } x=0,1,\\ldots,n\\\\0  & \\mbox{ en otro caso.}\\end{array}\\right.$ \\\\\\hline\n$\\scriptstyle  F_X(x)=P(X\\leq X)=\n\\scriptstyle\\left\\{\n\\begin{array}{ll}\n\\scriptstyle  0 & \\scriptstyle  \\mbox{ si } x<0\\\\ \n\\scriptstyle \\sum_{i=0}^k {n\\choose i}\\cdot  p^i\\cdot  (1-p)^{n-i} &  \n\\scriptstyle \\mbox{si } \\scriptstyle k\\leq x< k+1 \\mbox{\\small para } \\scriptstyle k=0,1,\\dots,n \\\\ \n\\scriptstyle 1 & \\scriptstyle  \\mbox{ si } x\\geq n\n\\end{array}\n\\right.$.\\\\\\hline\n$\\scriptstyle E(X)=n\\cdot p$; $\\scriptstyle  Var(X)=n\\cdot p \\cdot (1-p)$ \\\\\\hline\n\\end{tabular}\n\\end{table}\n\n\n### Cálculos binomial con R\n\nVeamos los cálculos básicos con funciones de R para una v.a $X$ con distribución  binomial  $B(n=10,p=0.25)$. \n\nSi queremos calcular con `R` algún valor de la función de distribución como por ejemplo $F_X(0)=P(X\\leq 0)$, tenemos que hacer:\n\n```{r binomialfuncionesA}\npbinom(0,size=10,prob=0.25)\n```\n\ny si queremos por ejemplo $F_X(4)=P(X\\leq 4)$, tenemos que hacer:\n\n```{r}\npbinom(4,size=10,prob=0.25)\n```\n\n\nSin embargo, si queremos calcular algún valor de la función de probabilidad como por ejemplo $P(X=0)$, tenemos que hacer:\n\n```{r binomialfunciones2A_dbinom}\ndbinom(0,size=10,prob=0.25)\n```\n\no por ejemplo para  $P(X=4)$:\n\n```{r}\ndbinom(4,size=10,prob=0.25)\n```\n\n#### Generación de muestras aleatorias con R\n\nGeneraremos una muestra aleatoria  de  100 valores  de una población con distribución $B(20,0.5)$\n\n```{r semilla_binomial,size=\"scriptsize\"}\nset.seed(2019)\nrbinom(100,size = 20,prob=0.5)\n```\n\n  \nQue corresponde a los resultados de repetir 100 veces el experimento de lanzar una moneda  20 veces y contar el número de caras.\n  \n\n###  Cálculos distribución binomial con python\n\nVeamos los cálculos básicos con funciones de python para una v.a $X$ con distribución  binomial  $B(n=10,p=0.25)$.\n\nPrimero importamos la  función `binom` de la librería `scipy.stat`\n\n```{python binomialfunciones2A_python}\nfrom scipy.stats import binom\n```\n\nEn general en el paquete `scipy`, la función de probabilidad se invocará con el método `pmf`, la de distribución con el método `cdf` mientras que una muestra aleatoria que siga esta distribución con el método `rvs`. En todos ellos aparecerá siempre el parámetro `loc` que se utiliza para desplazar el dominio de la variable aleatoria. Por ejemplo, en este caso \n\n```{python eval=F}\nbinom.pmf(k, n, p, loc) =  binom.pmf(k - loc, n, p)\n```\n\n\n\nPara calcular los valores de la función de distribución como por ejemplo $F_X(0)=P(X\\leq 0)$ y $F_X(4)=P(X\\leq 4)$ utilizamos la función `cdf`\n\n```{python bino3_py}\nbinom.cdf(0,n=10,p=0.25)\nbinom.cdf(4,n=10,p=0.25)\n```\n\nNotemos que al no indicar el valor de `loc`, se le asume que toma el valor 0.\n\n##  Cálculos distribución binomial con python\n\nPara calcular los valores de la función de probabilidad $P(X=0)$ y $P(X=4)$ utilizamos la función `pmf`:\n\n```{python bino4_py_2}\nbinom.pmf(0,n=10,p=0.25)\nbinom.pmf(4,n=10,p=0.25)\n```\n\nNotemos que al no indicar el valor de `loc`, se le asume que toma el valor 0.\n\n\n\nSi queremos generar una muestras aleatorias que siga una distribución binomial, podemos usar la función `rvs`. En este caso, generaremos una muestra aleatoria  de  100 valores  de una población $B(20,0.5)$\n\n```{python bino4_py_3}\nbinom.rvs(n=20,p=0.25,size = 100)\n```\n\n\n::::: callout-advertencia\n::: callout-title\n<i class=\"bi bi-exclamation-triangle\"> Observación </i> \n:::\n\n::: callout-body\nNotemos que la secuencia aleatoria generada no es la misma que con `R`. De hecho, si volvemos a ejecutar esta función obtendremos una muestra aleatoria distinta.\n  \n\n```{python bino4_py}\nbinom.rvs(n=20,p=0.25,size = 100)\n```\n:::\n:::::\n\n\n### Cálculos binomial con python\n\nVeamos algunos cálculos básicos con funciones de python para la binomial  $B(n=10,p=0.25)$.\n\n```{python binomialfunciones2A_python2}\nbinom.cdf(5,n=10,p=0.25)\nbinom.pmf(1,n=10,p=0.25)\nbinom.rvs(n=20,p=0.25,size=10)\n```\n\n### Gráficas de la distribución binomial con R \n\nEl siguiente código de R dibuja las función de probabilidad y la de distribución de una  $B(n=10,p=0.25)$\n\n\n```{r fig.align='center',echo=FALSE,out.width = \"55%\"}\npar(mfrow=c(1,2))\naux=rep(0,22)\naux[seq(2,22,2)]=dbinom(c(0:10),size=10,prob=0.25)\nplot(x=c(0:10),y=dbinom(c(0:10),size=10,prob=0.25),\n  ylim=c(0,1),xlim=c(-1,11),xlab=\"x\",\n  main=\"Función de probabilidad\\n B(n=10,p=0.25)\")\nlines(x=rep(0:10,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\ncurve(pbinom(x,size=10,prob=0.25),\n  xlim=c(-1,11),col=\"blue\",\n  main=\"Función de distribución\\n B(n=10,p=0.25)\")\npar(mfrow=c(1,1))\n```\n\n\n### Gráficos de la distribución binomial con python\n\nNecesitaremos usar  estas librerías:\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.stats as stats\n```\n\n\n\n```{python}\n# Parámetros de la distribución binomial\nn = 10\np = 0.7\n\n# Valores posibles de X\nx = np.arange(0, n+1)\n\n# Función de probabilidad (PMF)\npmf_values = stats.binom.pmf(x, n, p)\n\n# Función de distribución acumulada (CDF)\ncdf_values = stats.binom.cdf(x, n, p)\n\n# Graficar la función de probabilidad (PMF)\nplt.figure(figsize=(12, 5))\nplt.subplot(1, 2, 1)\nplt.bar(x, pmf_values, color='blue', alpha=0.7, label='P(X=k)')\nplt.xlabel('Valores de X')\nplt.ylabel('Probabilidad')\nplt.title('Función de Probabilidad (PMF) - Binomial(10, 0.7)')\nplt.xticks(x)\nplt.legend()\nplt.grid(axis='y', linestyle='--', alpha=0.7)\n\n# Graficar la función de distribución acumulada (CDF)\nplt.subplot(1, 2, 2)\nplt.step(x, cdf_values, where='mid', color='red', label='F(X)')\nplt.scatter(x, cdf_values, color='red')\nplt.xlabel('Valores de X')\nplt.ylabel('Probabilidad acumulada')\nplt.title('Función de Distribución Acumulada (CDF) - Binomial(10, 0.7)')\nplt.xticks(x)\nplt.legend()\nplt.grid(axis='y', linestyle='--', alpha=0.7)\n\n# Mostrar gráficos\nplt.tight_layout()\nplt.show()\n```\n\n\n  \n\n::::: callout-ejemplo\n::: callout-title\n<i class=\"bi bi-pencil-square\"> Ejemplo: número de bolas rojas extraídas de una\nurna con reposición </i> \n:::\n::: callout-body\nTenemos una urna con $100$ bolas de las cuales 40 son rojas y 60 son blancas. \nExtraemos al azar una bola, anotamos su color y la devolvemos a (reponemos en) \nla urna.\n\nSupongamos que repetimos este proceso $n=10$ reponiendo en cada ocasión la bola\nextraída. \n\nConsideremos la variable aleatoria $X$ como el número de bolas rojas extraídas \n(con reposición) en $n=10$ repeticiones del mismo experimento de Bernoulli.\n\nBajo estas condiciones repetimos $n=10$ veces el mismo experimento de Bernoulli \ncon probabilidad de éxito (sacar bola roja)\n$$P(Roja)=P(Éxito)=p=\\frac{40}{100}=0.4.$$\n\nAsí que la variable $X$ que es el número de bolas rojas extraídas de la urna (con reposición) en $n=10$ ocasiones sigue una ley binomial  $B(n=10,p=0.4).$\n  \n\n  \nNos preguntamos:\n\n1. ¿Cuál es la probabilidad de que saquemos exactamente $4$ bolas rojas?\n2. ¿Cuál es la probabilidad de que saquemos al menos  $4$ bolas rojas?\n3. ¿Cuál es la probabilidad de que saquemos  menos de $3$ bolas rojas?\n4. ¿Cuál es el valor esperado del número de bolas rojas?\n5. ¿Cuál es la desviación típica  del número de bolas rojas?\n\n**Solución 1**. ¿Cuál es la probabilidad de que saquemos exactamente $4$ rojas?\n\nUtilizando la función de probabilidad, tenemos que:\n\\begin{eqnarray*}\nP(X=4)&=&{10\\choose 4}\\cdot 0.4^4\\cdot (1-0.4)^{10-4}\n= \\frac{10!}{(10-4)!\\cdot 4!}\\cdot 0.4^4\\cdot 0.6^6\\\\\n&=& \\frac{7\\cdot 8\\cdot 9\\cdot 10}{1\\cdot 2\\cdot 3\\cdot 4}\\cdot 0.4^4\\cdot 0.6^6=`r round(choose(10,4)* 0.4^4*0.6^6,7)`.\n\\end{eqnarray*}\n\n\nCon R\n\n```{r}\ndbinom(4,size=10,prob = 0.4)\n```\n\n\n**Solución 2**.  ¿Cuál es la probabilidad de que saquemos al menos  $4$ bolas rojas?\n\nLa probabilidad de sacar al menos 4 rojas se expresa como \n\n$P(X \\geq  4)=1-P(X<4)=1-P(X\\leq 3):$\n\n\n\\begin{eqnarray*}\nP(x\\leq 3)&=& P(X=0)+P(X=1)+P(X=2)+P(X=3)\\\\\n&=& \n {10\\choose 0}\\cdot 0.4^0\\cdot (1-0.4)^{10-0}+ {10\\choose 1}\\cdot 0.4^1\\cdot (1-0.4)^{10-1}\\\\\n&+&{10\\choose 2}\\cdot 0.4^2\\cdot (1-0.4)^{10-2}+ {10\\choose 3}\\cdot 0.4^3\\cdot (1-0.4)^{10-3}\\\\\n&=&`r round(pbinom(3,10,0.4),7)`.\n\\end{eqnarray*}\n\nCon `R`\n\n```{r}\npbinom(3,10,0.4)\n```\n\n\nAsí que\n\n$$P(X \\geq 4 )=1-P(X< 4)=1-P(X\\leq 3)=1-`r round(pbinom(3,10,0.4),7)`=`r round(1-pbinom(3,10,0.4),7)`.$$\n\nOtra manera usando `R` sería:\n\n```{r}\n1-pbinom(3,10,0.4)\n```\n\nAunque en estos casos el parámetro `lower.tail = FALSE` es sin duda nuestra mejor opción: \n\n```{r}\npbinom(3,10,0.4,lower.tail = FALSE)\n```\n\n\n**Solución 3**.  ¿Cuál es la probabilidad de que saquemos  menos  de $3$ bolas rojas?\n\n\\begin{eqnarray*}\nP(X< 3)&=& P(X\\leq 2)=  P(X=0)+P(X=1)+P(X=2)\\\\\n&=& \n{10\\choose 0}\\cdot 0.4^0\\cdot (1-0.4)^{10-0}+ {10\\choose 1}\\cdot 0.4^1\\cdot (1-0.4)^{10-1}\\\\\n&&+\n{10\\choose 2}\\cdot 0.4^2\\cdot (1-0.4)^{10-2}\\\\\n&=&`r round(pbinom(2,10,0.4),7)`.\n\\end{eqnarray*}\n\nEn `R`:\n```{r}\ndbinom(0,10,0.4)+dbinom(1,10,0.4)+dbinom(2,10,0.4)\npbinom(2,10,0.4)\n```\n\n\n**Solución 4**. ¿Cuál es el valor esperado del número de bolas rojas?\n\nComo  $X$ es una $B(n=10,p=0.4)$ sabemos que \n\n$$E(X)=n\\cdot p = 10\\cdot 0.4=`r 10*0.4`.$$\n\nAunque en python tenemos la función `stats` que nos lo calcula directamente:\n\n```{python}\nprint(\"E(X) = {m}\".format(m=binom.stats(n = 10, p = 0.4, moments='m')))\n```\n\n\n**Solución 5**. ¿Cuál es la desviación típica  del número de bolas rojas?\n\n\nLa varianza es:\n$$\nVar(X)=n\\cdot p \\cdot(1-p)=10\\cdot 0.4\\cdot 0.6=`r 10*0.4*0.6`.\n$$\n\n\nPor lo  tanto la desviación típica es \n\n$$\\sqrt{Var(X)}=\\sqrt{`r 10*0.4*0.6`}= `r sqrt(10*0.4*0.6)`.$$\n\nAunque en python tenemos la función `stats` que nos lo calcula directamente:\n\n```{python}\nprint(\"Var(X) = {v}\".format(v=binom.stats(n = 10, p = 0.4, moments='v')))\n```\n\n  \n:::\n:::::\n\n\n\n## Distribución geométrica\n\n* Todos hemos jugado a, por ejemplo, tirar una moneda hasta que obtengamos la primera cara.\n\n* O también tirar una pelota a una canasta de baloncesto hasta obtener la primera canasta.\n\n* Desde otro punto de vista también podemos intentar modelar el número de veces que accionamos una interruptor  y la bombilla se ilumina  hasta que falla. \n\n* O también el número de veces que un cajero automático nos da dinero hasta que falla.\n\nLa **modelización de este tipo de problemas se consigue con la  llamada distribución geométrica**.\n\n\n## Distribución geométrica\n\n\n<l class=\"definition\"> Distribución geométrica </l>\n\n* Repitamos un experimento Bernoulli, de parámetro $p$, de forma independiente hasta obtener el primer éxito.\n* Sea $X$ la v.a. que cuenta el número de fracasos antes del primer éxito. Por ejemplo  que  hayamos tenido  $x$ fracasos  será una cadena de $x$ fracasos culminada con un éxito. Más concretamente \n\n$$P(\\overbrace{FFF\\ldots F}^{x}E)=P(F)^{x}\\cdot P(E)=(1-p)^{x}\\cdot p=q^{x}\\cdot p.$$\n\n\n## Distribución geométrica\n\nSu función de probabilidad es \n\n$$\nP_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}\n(1-p)^{x}\\cdot p & \\mbox{ si } x=0,1,2,\\ldots\\\\\n0 &\\mbox{ en otro caso}\n\\end{array}\\right..\n$$\n\n\n\n\n* La v.a. definida anteriormente diremos que sigue una distribución geométrica de parámetro $p$.\n* La  denotaremos por $Ge(p)$. \n* Su dominio es  $D_X=\\{0,1,2,\\ldots\\}$.\n\n\n## Función de distribución geométrica\n\nCalculemos P($X\\leq 3$).\n\nPor la propiedad de la probabilidad del suceso complementario tenemos que\n\n$$\nP(X\\leq 3 )=1-P(X> 3)=1-P(X\\geq 4)\n$$\n\nEfectivamente, el complementario del evento $X\\leq 3$ nos dice que hemos fracasado más de tres veces hasta conseguir el primer éxito, es decir, **hemos fracasado 4 o más veces**. Podemos simbolizar dicho evento de la forma siguiente:\n$$\n\\{X>3\\}=\\{X\\geq 4\\}= \\{FFFF\\}\n$$\n\n## Función de distribución geométrica\n\nAhora, al  ser los intentos independientes, tenemos que:\n\n\\begin{eqnarray*}\nP(X>3) & = & P(\\{FFFF\\})= P(F)\\cdot P(F)\\cdot P(F)\\cdot P(F)\\\\\n&=& (1-p)\\cdot (1-p)\\cdot (1-p)\\cdot (1-p)= (1-p)^{3+1}\\\\\n&=&(1-p)^{4}.\n\\end{eqnarray*}\n\n\n\nEl valor de la función de distribución de $X$ en $x=3$ será, pues:\n$$F_X(3)=P(X\\leq 3)=1-P(X>3)=1-(1-p)^{3+1}.$$\nGeneralizando el resultado anterior a cualquier entero positivo $k=0,1,2,\\ldots$, tenemos:\n$$F_X(k)=P(X\\leq k)=1-(1-p)^{k+1},\\mbox{ si } k=0,1,2,\\ldots$$\n\n## Función de distribución geométrica\n\n\nEn general, tendremos que:\n$$\nF_X(x)=P(X\\leq x)=\n\\left\\{\\begin{array}{ll} \n0, & \\mbox{ si } x<0,\\\\\n1- (1-p),  & \\mbox{ si } k=0\\leq x <1,\\\\\n1- (1-p)^2, & \\mbox{ si } k=1\\leq x <2,\\\\\n1- (1-p)^3, & \\mbox{ si } k=2\\leq x <3,\\\\\n1- (1-p)^{k+1}, & \\mbox{ si } \\left\\{ \\begin{array}{l}k\\leq x< k+1,\\\\\\mbox{para } k=0,1,2,\\ldots\\end{array}\n    \\right.\n\\end{array}\n\\right..\n$$\n\n\n\n## Función de distribución geométrica\n\nDe forma más compacta, tendremos que \n$$\nF_X(x)=P(X\\leq x)=\n\\left\\{\\begin{array}{ll} \n0, & \\mbox{ si } x<0,\\\\\n1- (1-p)^{k+1}, & \\mbox{ si } \\left\\{ \\begin{array}{l}k\\leq x< k+1,\\\\\\mbox{para } k=0,1,2,\\ldots\\end{array}\n\\right.\n\\end{array}\n\\right..\n$$\n\nNotemos que el límite de la función de distribución es:\n$$\n\\displaystyle\\lim_{k\\to +\\infty } F_X(k)=\\lim_{k\\to +\\infty } 1-(1-p)^{k+1}=\n1,\n$$\nya que $0<1-p<1$.\n\n\n## Sumas derivadas series geométricas \nRecordemos del tema de variables aleatorias que \n\n<l class=\"prop\">Propiedades</l>\n\n\n* Si $|r|<1$  también son convergentes las derivadas, respecto de $r$, de la serie geométrica y convergen a la derivada correspondiente. Así tenemos que\n\n$$\n\\begin{array}{rlrl}\n\\left(\\sum_{k=0}^{+\\infty} r^k\\right)'&= \\sum_{k=1}^{+\\infty}k\\cdot\nr^{k-1} &= \\left(\\frac1{1-r}\\right)'=\\frac1{(1-r)^2}\\\\\n\\left(\\sum_{k=0}^{+\\infty} r^k\\right)^{''}&= \\sum_{k=2}^{+\\infty}k \\cdot(k-1)\\cdot\nr^{k-2}&=\\left(\\frac1{1-r}\\right)^{''}=\\frac2{(1-r)^3}\n\\end{array}\n$$\n\n\n\n\n## Esperanza de una v.a. $Ge(p)$\n\nRecordemos que $P(X=x)=(1-p)^x\\cdot p$ si $x=0,1,2,\\ldots$ y aplicado la fórmula anterior con $r=1-p$\n\n\n\\begin{eqnarray*}\nE(X)&=&\\sum_{x=0}^{+\\infty} x\\cdot P_x(x)=\\sum_{x=0}^{+\\infty} x\\cdot (1-p)^x\\cdot p\\\\\n&=& p\\cdot (1-p) \\cdot \\sum_{x=1}^{+\\infty} x\\cdot (1-p)^{x-1}\\\\\n&=& p\\cdot (1-p)\\cdot \\frac{1}{(1-(1-p))^2}=p\\cdot (1-p)\\cdot \\frac{1}{p^2}=\\frac{1-p}{p}\n\\end{eqnarray*}\n\n\n## Valor $E(X^2)$ de una v.a. $Ge(p)$\n\n\n\\begin{eqnarray*}\nE(X^2)&=&\\sum_{x=0}^{+\\infty} x^2\\cdot P_X(x)=\\sum_{x=1}^{+\\infty} x^2\\cdot (1-p)^x\\cdot p\\\\\n&=& \n\\sum_{x=1}^{+\\infty} (x\\cdot (x-1)+x)\\cdot (1-p)^{x}\\cdot p\\\\\n&=&\n\\sum_{x=1}^{+\\infty} x\\cdot (x-1)\\cdot (1-p)^{x}\\cdot p+\\sum_{x=1}^{+\\infty} x \\cdot (1-p)^{x}\\cdot p\\\\\n&=&\n(1-p)^{2}\\cdot p\\cdot \\sum_{x=2}^{+\\infty} x\\cdot (x-1)\\cdot (1-p)^{x-2}\\\\ \n&  +&   (1-p)\\cdot p\\sum_{x=1}^{+\\infty} x \\cdot (1-p)^{x-1} = \\ldots\n\\end{eqnarray*}.\n\n\n## Valor $E(X^2)$ de una v.a. $Ge(p)$\n\n\n\\begin{eqnarray*}\nE(X^2)&=&\\ldots\\\\\n&=&\n(1-p)^{2}\\cdot p\\cdot \\sum_{x=2}^{+\\infty} x\\cdot (x-1)\\cdot (1-p)^{x-2}\\\\ \n&  +&   (1-p)\\cdot p\\sum_{x=1}^{+\\infty} x \\cdot (1-p)^{x-1}\\\\\n&=&\np\\cdot (1-p)^2 \\frac{2}{(1-(1-p))^3}+  (1-p)\\cdot p \\frac{1}{(1-(1-p))^2}\\\\\n&=&\np\\cdot (1-p)^2 \\frac{2}{p^3}+  (1-p)\\cdot p \\frac{1}{p^2}\\\\\n&=&\\frac{2\\cdot (1-p)^2}{p^2}+\\frac{1-p}{p}.\n\\end{eqnarray*}\n\n\n\n\n## Varianza de una v.a. $Ge(p)$\n\n\n\n\\begin{eqnarray*}\nVar(X)&=&E(X^2)-E(X)^2=\\frac{2\\cdot (1-p)^2}{p^2}+\\frac{1-p}{p}-\\left(\\frac{1-p}{p}\\right)^2\\\\\n&=&\n\\frac{2\\cdot (1-p)^2+p\\cdot(1-p)-(1-p)^2}{p^2}=\\frac{(1-p)^2+p\\cdot(1-p)}{p^2}\\\\\n&=&\n\\frac{1-2\\cdot p + p^2+p-p^2}{p^2}\\\\\n&=& \\frac{1-p}{p^2}.\n\\end{eqnarray*}\n\nY su desviación típica será\n\n$$\\sqrt{Var(X)}=\\sqrt{\\frac{1-p}{p^2}}.$$\n\n\n## Resumen  distribución geométrica $Ge(p)$ empezando en 0\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X=$ Geométrica (empieza en $0$) número de fracasos  para conseguir el primer éxito\n\\\\\\hline\n$D_X=\\{0,1,\\ldots n,\\ldots\\}$ \\\\\\hline\n$P_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}(1-p)^{x}\\cdot p & \\mbox{ si } x=0,1,2,\\ldots \\\\0  & \\mbox{ en otro caso.}\\end{array}\\right.$\\\\\\hline\n$F_X(x)=P(X\\leq X)=\\left\\{\\begin{array}{ll} 0 & \\mbox{ si } x<0\\\\\n  1- (1-p)^{k+1} & \\mbox{ si } \\left\\{ \\begin{array}{l}k\\leq x< k+1\\\\\\mbox{para } k=0,1,2,\\ldots\\end{array}\n    \\right.\\end{array}\\right.$ \\\\\\hline\n$E(X)=\\frac{1-p}{p}$; $Var(X)=\\frac{1-p}{p^2}$\\\\\\hline\n\\end{tabular}\n\\end{table}\n\n\n## La variable geométrica que cuenta los intentos para obtener el primer éxito.\n\n* Supongamos que sólo estamos interesados en el **número de intentos** para obtener el primer éxito. \n* Si definimos $Y$= número de  intentos para obtener el  primer éxito. Entonces $Y=X+1$  donde $X\\sim Ge(p)$.\n* Su dominio es $D_Y=\\{1,2,\\ldots\\}$ \n* La media se incrementa en un intento debido al  éxito  $E(Y)=E(X+1)=E(X)+1=\\frac{1-p}{p}+1=\\frac1{p}$.\n* La varianza es la misma $Var(Y)=Var(X+1)=Var(X)=\\frac{1-p}{p^2}$.\n\n\n## Resumen distribución geométrica $Ge(p)$ empezando en $1$.\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$Y$ geométrica (que cuenta el éxito) número de \\blue{INTENTOS}  para OBTENER el primer éxito\n\\\\\\hline\n$D_Y=\\{1,2,\\ldots n,\\ldots\\}$ \\\\\\hline\n$P_Y(y)=P(Y=y)=\\left\\{\\begin{array}{ll}(1-p)^{y-1}\\cdot p & \\mbox{ si } y=1,2,3,\\ldots\\\\  0  & \\mbox{ en otro caso.}\\end{array}\\right.$\\\\\\hline\n$F_Y(y)=P(Y\\leq y)=\\left\\{\\begin{array}{ll} 0 & \\mbox{ si } y<1\\\\ 1- (1-p)^{k} & \\mbox{ si } \\left\\{ \\begin{array}{l}k\\leq y< k+1\\\\\\mbox{para } k=1,2,3,\\dots \\end{array}    \\right.\\end{array}\\right.$ \\\\\\hline\n$E(X)=\\frac1{p}; Var(X)=\\frac{1-p}{p^2}$\n\\\\\\hline\n\\end{tabular}\n\\end{table}\n\n## Propiedad de la falta de memoria\n\n<l class=\"prop\"> Propiedad de la falta  de memoria </l>\n\nSea $X$ una v.a. discreta con dominio $D_X=\\{0,1,2,\\ldots\\}$, con $P(X=0)=p$.\n\nEntonces $X$ sigue una ley $Ge(p)$ si, y sólo si,\n$$\nP\\left(X> k+j\\big| X\\geq j\\right)=P(X> k)\n$$\npara todo $k,j=0,1,2,3\\ldots$.\n\n## Propiedad de la falta de memoria\n\n  \n**Demostración**\n\nSi $X$ es geométrica entonces el lado derecho de la igualdad es \n\n$$\nP(X>k)=1-P(X\\leq k)=1-\\left(1-(1-p)^{k+1}\\right)=(1-p)^{k+1},\n$$\ny el lado de izquierdo es\n\n\\scriptsize{\n\\begin{eqnarray*}\nP\\left(X> k+j\\big| X\\geq j\\right)&=&\\frac{P\\left(\\{X> k+j\\}\\cap \\{X\\geq j\\} \\right)}{P\\left(X\\geq j\\right)}=\n\\frac{P\\left(X>k+j \\right)}{P\\left(X\\geq j \\right)} = \\frac{1-P(X\\leq k+j)}{1-P(X\\leq j-1)}\\\\\n&=&  \\frac{1-(1-(1-p)^{k+j+1})}{1-(1-(1-p)^{j-1+1})} =\\frac{(1-p)^{k+j+1}}{(1-p)^{j}} = (1-p)^{k+1},\n\\end{eqnarray*}\n}\n\\normalsize\n\nlo que demuestra  la igualdad.\n  \n\n## Propiedad de la falta de memoria\n\n  \nPara demostrar el recíproco, tomemos $j=1$  y $k\\geq 0$. Entonces, por la propiedad de la pérdida de memoria:\n$$\nP\\left(X> k+1\\big| X\\geq 1\\right)=P(X> k)\n$$\nComo $P(X=0)=p$, tenemos que $P(X \\geq 1 )=1-P(X<1)=1-P(X=0)=1-p$.\n\nCombinado las igualdades, tenemos que:\n\n$$\nP\\left(X> k+1\\big| X\\geq 1\\right)=\\frac{P(X>k+1, X\\geq 1)}{P(X\\geq 1)}=\\frac{P(X>k+1)}{P(X\\geq 1)}=P(X>k).\n$$\nAsí podemos poner que \n\n\n\\begin{eqnarray*}\nP(X>k+1)&=&P(X\\geq 1)\\cdot P(X>k)=\\left(1-P(X<1)\\right)\\cdot P(X>k)\\\\\n&=&\\left(1-P(X=0)\\right)\\cdot P(X>k)=(1-p)\\cdot P(X>k).\n\\end{eqnarray*}\n\n  \n\n## Propiedad de la falta de memoria\n\n  \nEs decir  en general tenemos que \n\n$$\nP(X>k+1)=(1-p)\\cdot P(X>k)\n$$\nDel mismo modo para $j=2$\n\n$$\n\\scriptsize{P(X>k+2)=(1-p)\\cdot P(X>k+1)}\n$$\n\nRestando la primera igualdad de la última obtenemos. \n\n$$\n\\scriptsize{P(X>k+1)-P(X>k+2)=(1-p)\\cdot P(X>k)-(1-p)\\cdot P(X>k+1)}\n$$\n\nde donde operando en cada lado de la igualdad obtenemos la recurrencia\n\n$$\n\\scriptsize{[1-P(X\\leq k+1)]-[1-P(X\\leq k+2)]=(1-p)\\cdot [P(X>k)-P(X>k+1)]}\n$$\n\n  \n\n## Propiedad de la falta de memoria\n\n\n  \n\n\nAhora operando \n$$\nP(X\\leq k+2)-P(X\\leq k+1)=(1-p)\\cdot[1-P(X\\leq k)-\\left(1-P(X\\leq k+1)\\right)]\n$$\n$$\nP(X=k+2)=(1-p)\\cdot[P(X\\leq k+1)-P(X\\leq k)]\n$$\n$$\nP(X=k+2)=(1-p)\\cdot P(X=k+1)\n$$\n\n\n\n\n  \n## Propiedad de la falta de memoria\n\n  \n\nDe forma similar obtenemos \n\n$$\nP(X=k+1)=(1-p)\\cdot P(X=k)\n$$\nUtilizando la recurrencia anterior, podemos calcular todas las probabilidades $P(X=k)$ a partir de la $P(X=0)=p$: \n$$\n\\scriptsize{\n\\begin{array}{rl}\nP(X=0)&= p,\\\\\nP(X=1)&=P(X=0+1)= (1-p)\\cdot P(X=0) =(1-p)\\cdot  p,\\\\\nP(X=2)&=P(X=1+1)= (1-p)\\cdot P(X=1)=(1-p)\\cdot (1-p)\\cdot p=(1-p)^2\\cdot p,\\\\\n \\vdots &    \\vdots \\\\\nP(X=k)&=P(X=(k-1)+1)= (1-p)\\cdot P(X=k-1)=(1-p)\\cdot (1-p)^{k-1}\\cdot p=(1-p)^{k}\\cdot p,\n\\end{array}\n}\n$$\nlo que demuestra  el recíproco, es decir, que $X$ es $Geom(p)$.\n  \n\n\n\n## Falta de memoria\n\n<l class=\"observ\"> Observación: Interpretación  de la propiedad</l>\n\nLa propiedad de la falta de memoria\n$$\nP(X> k+j\\big|X \\geq j)=P(X > k),\n$$   \nsignifica que, aunque **ya llevemos al menos  $j$ fracasos**, la probabilidad de **que fracasemos $k$ veces más** no disminuye, es la misma  que era cuando empezamos el experimento.  \n\nA este efecto se le suele etiquetar con la frase  **el experimento carece de memoria** o es un **experimento sin memoria** (*Memoryless Property*).\n\n## Ejemplo falta de memoria\n\nUn ejemplo muy sencillo nos aclarará el alcance de esta propiedad\n\n   **Ejercicio: la llave que abre la puerta**\n\nTenemos un llavero con 10 llaves,  solo una de ellas abre una puerta. Cada vez que probamos una llave y falla olvidamos que llave hemos probado. ¿Cuál es la probabilidad de que  si ya lo hemos intentado  5 veces necesitemos más de 4 intentos adicionales  para abrir la puerta?\n  \n\n\n\nTomemos $k=4,j=5$, aplicando la propiedad de la falta de memoria\n\n$$\nP(X> 4+5/X \\geq 5)=P(X > 4)\n$$\n\nDespués de 5 fracasos no estamos \"más cerca\" de abrir la puerta.\nLa propiedad de la falta de  memoria  nos dice que en **después de cada intento es como si empezásemos  de nuevo a abrir la puerta**. Tras 5 fracasos la probabilidad de que fallemos más de  4 veces  más es la misma que cuando lo intentamos la primera vez.\n  \n\n## Ejemplo falta de memoria \n\n\n\n¿Cuál es el número esperado de fracasos hasta abrir la puerta?\n\n$$\nE(X)=\\frac{1-p}{p}=\\frac{1-\\frac{1}{10}}{\\frac{1}{10}}=\\frac{\\frac{9}{10}}{\\frac{1}{10}}=9.\n$$\n\nLa varianza es \n\n$$\nVar(X)=\\frac{1-p}{p^2}=\\frac{1-\\frac{1}{10}}{\\left(\\frac{1}{10}\\right)^2}=\\frac{\\frac{9}{10}}{\\frac{1}{100}}=\n90.\n$$\n\nLa desviación típica es $\\sqrt{90}=`r sqrt(90)`.$\n  \n\n\n## Ejemplo: El clásico del fútbol\n\n  \n\n\n**Ejemplo: partidos hasta que el Barça gana al Madrid**\n\nLos partidos Real Madrid vs FC Barcelona de **la liga** española se suelen denominar  **El Clásico**, sean en el Bernabeu (estadio del Real Madrid) o en el Camp Nou (estadio del Barça)\n\nSea $X$ la variable que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid sea en el Camp Nou o el Bernabeu.\n\nNuestra amiga Aina es muy culé (hincha del Barça) y quiere averiguar cuántos partidos consecutivos de **El Clásico** tiene que ver hasta ver ganar al Barça por primera vez. \n\nLe interesa estimar cuánto le va a costar este capricho. Tendrá que comprar las entradas y pagar los viajes de Barcelona a Madrid.\n\nEn [datos historicos de **El clásico**  en la wikipedia](https://es.wikipedia.org/wiki/El_Cl%C3%A1sico) están los datos hasta el 3 de marzo de 2019: se han jugado en total 178 **Clásicos** donde el Real Madrid ganó en 72 ocasiones, el Barça, en 72 y empataron 34 veces.\n  \n\n## Ejemplo: El clásico del fútbol\n\n\n  \n\nNos hacemos las siguientes preguntas:\n\n*  Si Aina solo tiene dinero para ir a ver 3 partidos, ¿cuál es la probabilidad de no ver ganar al Barça en al menos tres partidos consecutivos?\n* ¿Cuántos partidos se tienen que jugar de media para ver ganar al Barça por primera vez?\n\n  \n\n \n\nCon los datos anteriores, podemos estimar que la probabilidad de que el Barça gane un clásico cualquiera es:\n\n$$P(\\mbox{Barça})=\\frac{72}{178}=`r round(72/178,4)`.$$\n\nPor tanto, podemos modelar la variable $X$, que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid, con una ley  geométrica empezando en cero con probabilidad de éxito $p=P(\\mbox{Barça})=\\frac{72}{178}$,\n  \n\n\n## Ejemplo: El clásico del fútbol\n\n \n\n\n$$X=Ge\\left(p=\\frac{72}{178}=`r round(72/178,4)`\\right)$$\n\nAsí que  lo que nos pregunta Aina es la siguiente probabilidad\n\n$$P(X\\geq 3)=1-P(X\\leq 2)=1-\\left(1-\\frac{72}{178}\\right)^{2+1}=`r round(1-(1-72/178)^3,4)`.$$\n\nAsí que  Aina tiene una probabilidad del $`r round(1-(1-72/178)^3,4)*100.0`\\%$ de no ver ganar al Barça en al menos 3 partidos antes de ver uno en el sí que gane.\n\n  \n\n\n## Variable geométrica: El clásico\n\n \n\nPara responder a la segunda pregunta, usando que la distribución de $X$ es:\n\n$$X=Ge\\left(p=\\frac{72}{178}=`r round(72/178,4)`\\right)$$\n\nentonces \n\n$$E(X)=\\frac{1-p}{p}=\\frac{1-`r round(72/178,4)`}{`r round(72/178,4)`}=`r round((1- (72/178))/(72/178),4)`$$\n\ny\n\n$$Var(X)=\\frac{1-p}{p^2}=\\frac{1-`r round(72/178,4)`}{`r round(72/178,4)`^2}=`r round((1- (72/178))/(72/178)^2,4)`$$\n\nLa desviación típica es \n$$\\sqrt{`r round((1- (72/178))/(72/178)^2,4)`}=`r round(sqrt((1- (72/178))/(72/178)^2),4)`.$$\n\n  \n\n\n\n## Cálculos con R\n\nVeamos los cálculos básicos con  R para la distribución geométrica  $Ge(p=0.25)$. R implementa la geométrica que cuenta el número de fracasos.\n\n\n$P(X=0)=(1-0.25)^0\\cdot 0.25^1=0.25$\n\n```{r binomialfunciones01}\ndgeom(0,prob=0.25)\n```\n\n$P(X\\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25$\n\n\n\n```{r binomialfunciones02}\npgeom(0,prob=0.25)\n```\n\n\n\n\n\n## Cálculos con R\n\n\n\n$P(X\\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=`r 1-0.75^5`.$\n\n```{r binomialfunciones1}\npgeom(4,prob=0.25)\n```\n\n\nUna muestra aleatoria de tamaño 25 de una $Ge(0.25)$\n\n```{r}\nrgeom(n=25,prob=0.25)\n```\n\n## Gráficos con R el código\n\n::: {.small}\n\n```{r eval=FALSE}\npar(mfrow=c(1,2))\nx=c(0:10)\nplot(x=x,y=dgeom(x,prob=0.25),\n  ylim=c(0,1),xlim=c(-1,11),xlab=\"x\",\n  main=\"Función de probabilidad\\n Ge(p=0.25)\")\nlines(x=rep(0:10,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\naux0=dgeom(c(0:10),prob=0.25)\nceros=rep(0,21)\nceros\naux=ceros\naux[2*(c(1:11))]<-aux0\ncurve(pgeom(x,prob=0.25),\n  xlim=c(-1,10),col=\"blue\",\n  main=\"Función de distribución\\n Ge(p=0.25)\")\npar(mfrow=c(1,1))\n```\n:::\n\n##  Los gráficos con R\n\n\n```{r graficos22, fig.align='center',echo=FALSE,out.width=\"80%\"}\n  par(mfrow=c(1,2))\n  p=0.25\n  n=30\n  aux=rep(0,(n+1)*2)\n  aux[seq(2,(n+1)*2,2)]=dgeom(c(0:n),prob=p)\n  plot(x=c(0:n),y=dgeom(c(0:n),prob=p),\n       ylim=c(0,1),xlim=c(-1,n+1),xlab=\"x\",\n       main=paste0(c(\"Función de probabilidad\\n Ge(p=\",p,\")\"),collapse = \"\"))\n  lines(x=rep(0:n,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\n  curve(pgeom(x,prob=p),\n        xlim=c(-1,n+1),col=\"blue\",\n        main=paste0(c(\"Función de distribución\\n Ge(p=\",p,\")\"),collapse = \"\"))\n  par(mfrow=c(1,1))\n```\n\n\n\n## Cálculos con python\n\nVeamos los cálculos básicos con  python para la distribución geométrica  $Ge(p=0.25)$. scipy.stats implementa la distribución geométrica que cuenta el número  intentos así que empieza en 1\n\n\n\nCargamos la  función de la librería \n\n```{python geom1}\nfrom scipy.stats import geom\n```\n\n\n## Cálculos con python\n\nLa función de probabilidad es `geom.pmf(x,p,loc=0)=geom.pmf(x,p)` es un geométrica que cuenta el número de intentos para obtener el primer éxito el valor por defecto del último parámetro es  `loc=0`.\n\nSi queremos la que cuenta el número de fracasos para obtener el primer éxito (la geométrica que empieza en 0) tenemos que usar `geom.pmf(x,p,loc=-1)`.\n\nEs decir `geom.pmf(x,p,loc=-1)=geom.pmf(x-1,p,loc=0)`\n\n\n\n\nVeamos pues los cálculos para la $Ge(p)$ que empieza en $0$.\n\n$P(X=0)=(1-0.25)^0\\cdot 0.25^1=0.25$\n\n```{python py_geom_funciones1}\ngeom.pmf(0,p=0.25,loc=-1)\n```\n\n$P(X\\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25$\n\n```{python py_geom_funciones2}\ngeom.cdf(0,p=0.25,loc=-1)\n```\n\n\n$P(X\\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=`r 1-0.75^5`.$\n\n```{python py_geom_funciones3}\ngeom.cdf(4,p=0.25,loc=-1)\n```\n\nUna muestra aleatoria de tamaño 25 de una $Ge(0.25)$\n\n```{python py_random_binom}\ngeom.rvs(p=0.25, size=20, loc=-1)\n```\n\n## Cálculos con python \n\n  \n**Ejercicio**\n\nQué probabilidades son las que calcula el siguiente código y qué tipo de variables geométricas son?\n\n  \n\n```{python}\ngeom.cdf(range(5),p=0.3,loc=0)\ngeom.cdf(range(5),p=0.3,loc=-1)\n```\n\n## Cálculos con python  esperanza y  varianza\n\nCon python también podemos calcular directamente algunos parámetros asociado a una función de distribución predefinida\n\n\n```{python py_mean_var_stats}\ngeom.stats(p=0.25, loc=0, moments='mv')\ngeom.stats(p=0.25, loc=-1, moments='mv')\n```\n\n\n## Cálculos con python  esperanza y  varianza\n\n  \n**Ejercicio**\n\nComprobad que las medias y las varianzas calculadas en el código anterior, corresponden a una $Ge(p=0.3)$ empezando en $1$ y a una $Ge(p=0.3)$\nempezando en $0$.\n\n¿Son las varianzas siempre iguales?\n  \n\n\n## Gráficos con python\n\n```{python geom2, eval=F}\np = 0.25\nx = np.arange(geom.ppf(0.01, p),geom.ppf(0.99, p))\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\nax.plot(x, geom.pmf(x, p), 'bo', ms=5, label='geom pmf')\nax.vlines(x, 0, geom.pmf(x, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\nax.plot(x, geom.cdf(x, p), 'bo', ms=5, label='geom pmf')\nax.vlines(x, 0, geom.cdf(x, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfig.suptitle('Distribucion Geometrica')\nplt.show()\n```\n\n\n## Gráficos con python\n\n```{python, echo=F}\np = 0.25\nx = np.arange(geom.ppf(0.01, p),geom.ppf(0.99, p))\n\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\n_=ax.plot(x, geom.pmf(x, p), 'bo', ms=5, label='geom pmf')\n_=ax.vlines(x, 0, geom.pmf(x, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5) \n  \nax = fig.add_subplot(1,2,2)\n_=ax.plot(x, geom.cdf(x,p), 'bo', ms=5, label='geom cdf')\n_=ax.vlines(x, 0, geom.cdf(x, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\n_=fig.suptitle('Distribucion Geometrica')\n_=plt.show()\n```\n\n\n\n\n# Distribución binomial negativa\n\n## El problema de la puerta con dos cerraduras\n\nSupongamos que disponemos de 10 llaves distintas y tenemos que abrir una puerta con **dos cerraduras**.\n\nComenzamos por la primera cerradura, de tal forma que cada vez olvidamos qué llave hemos probado.\n\nUna vez abierta la primera cerradura probamos de igual forma con la segunda hasta que también la abrimos.\n\nSea $X=$ la v.a. que cuenta el número de fracasos hasta abrir la  puerta.\n\nAcertar una llave de la puerta es un experimento Bernoulli con probabilidad de éxito $p=0.1$. Lo repetiremos hasta obtener 2 éxitos.\n\n## Distribución binomial negativa\n\n\nEn general tendremos un experimento de Bernoulli con probabilidad de éxito $0<p<1$ tal que:\n\n* Repetimos el experimento hasta obtener el $n$-ésimo éxito ¡¡abrir la maldita puerta!!.\n* Sea $X$ la v.a. que cuenta el número fallos hasta abrir la puerta, es decir, hasta  conseguir el n-ésimo éxito. Notemos que no contamos los éxitos, solo  contamos los fracasos\n\n## Distribución binomial negativa\n\nSi representamos como es habitual un suceso como una cadena de F's y E's, para $n=2$, algunos sucesos elementales serán:\n $$\\small{\\{EE,FEE,EFE, FFEE,FEFE,EFFE,FFFEE,FFEFE,FEFFE,EFFFE\\}.}$$\n \nCalculemos algunas probabilidades para $n=2$:\n$$\n\\small{\n\\begin{array}{rl}\nP(X=0) & =P(\\{EE\\})=p^2, \\\\\nP(X=1) & =P(\\{FEE,EFE\\})=2\\cdot (1-p)\\cdot p^2, \\\\\nP(X=2) & =P(\\{FFEE,FEFE,EFFE\\})=3\\cdot (1-p)^2\\cdot p^2, \\\\\nP(X=3) & =P(\\{FFFEE,FFEFE,FEFFE,EFFFE\\})=4\\cdot (1-p)^3\\cdot p^2.\n\\end{array}\n}\n$$\n\n## Distribución binomial negativa\n \nEn general su función de probabilidad es\n\n$$\nP_{X}(k)=P(X=k)=\\left\\{\\begin{array}{ll}\n     {k+n-1\\choose n-1} \\cdot (1-p)^{k}\\cdot p^n & \\mbox{si } k=0,1,\\ldots\\\\\n     0 & \\mbox{en otro caso}\\end{array}\\right.\n$$\n     \n\n## Distribución binomial negativa\n\nUna v.a. con este tipo de distribución recibe el nombre de **binomial negativa** y la denotaremos por $BN(n,p)$. \n\nNotemos que $BN(1,p)=Ge(p)$.\n\n## Distribución binomial negativa\n\n  \n**Demostración**\n\nJustifiquemos el resultado. Sea $X$ una $BN(n,p)$ y sea $k=0,1,2,\\ldots$.\n\n$$\\scriptsize{P(X=k)=P(\\mbox{Todas las cadenas de E's y F' con $k$ F, con $n$ E y acabadas en E})}$$\n\n\n$$\n\\scriptsize{\\overbrace{\\underbrace{\\overbrace{EFFF\\ldots EEF}^{n-1 \\quad \\mbox{Éxitos}.}}}_{k \\quad\\mbox{Fracasos}}^{k+n-1\\mbox{ posiciones}}E}\n$$\n\n\n\nDe estas cadenas hay  tantas como maneras de elegir de entre las $k+n-1$ primeras posiciones $n-1$ para colocar los éxitos. Esta cantidad es el número binomial ${k+n-1\\choose n-1}.$\n\n  \n\n\n## Números binomiales negativos\n\n<l class=\"definition\"> Números binomiales negativos</l>\n\nDados dos enteros positivos $n$ y $k$ se  define el número binomial negativo como \n\n$$\\binom{-n}{k}=\\frac{(-n)(-n-1)\\cdots (-n-k+1)}{k!}.$$\n\n\nLos números binomiales negativos generalizan la fórmula de Newton para exponentes negativos:\n$$\n(t+1)^{-n}=\\sum_{k=0}^{+\\infty}\\left(\\begin{array}{c} -n\n\\\\ k\\end{array}\\right) t^{k}\n$$\n\n## Números binomiales negativos\n\n`R` usa la función `choose` para calcular números binomiales, sean negativos o no. Veámoslo con un ejemplo:\n\n$$\n\\begin{array}{rl}\n{-6\\choose 4}&=\\frac{-6\\cdot (-6-1)\\cdot \\cdot (-6-2)\\cdot (-6-3) }{4!}\\\\\n&=  \\frac{-6\\cdot(-7)\\cdot (-8)\\cdot (-9)}{24}\\\\\n&= \\frac{3024}{24}=126.\n\\end{array}\n$$\n\nSi realizamos el cálculo con `R` obtenemos el mismo resultado:\n```{r}\nchoose(-6,4)\n```\n\n## Esperanza de una $BN(n,p)$\n\nSu **esperanza es**\n\n$$E(X)=\\sum_{k=0}^{+\\infty} k\\cdot {k+n-1\\choose n-1} \\cdot (1-p)^{k}\\cdot p^n=n\\cdot\\frac{1-p}{p}.$$\n\n\nLa **esperanza de $X^2$ es**  \n\n$$E(X^2)=\\sum_{k=0}^{+\\infty} k^2\\cdot {k+n-1\\choose n-1} \\cdot (1-p)^{k}\\cdot p^n=n\\cdot\\frac{1-p}{p^2}+\\left(n\\cdot \\frac{1-p}{p}\\right)^2.$$\n\n## Varianza de una $BN(n,p)$\n\nPor último la **varianza es** \n\n$$\nVar(X)=E(X^2)-E(X)^2=\n$$\n\n$$=n\\cdot \\frac{1-p}{p^2}+\\left(n\\cdot \\frac{1-p}{p}\\right)^2-\\left(n\\cdot \\frac{1-p}{p}\\right)^2=\nn\\cdot \\frac{1-p}{p^2}.$$\n\ny por tanto la desviación típica es\n\n$$\\sqrt{Var(X)} = \\frac{\\sqrt{n(1-p)}}{p}$$\n\n## Resumen distribución  Binomial Negativa $BN(n,p)$\n\n\\renewcommand{\\arraystretch}{1.8}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n $X=$ Número de fracasos antes de conseguir el $n$-ésimo éxito, $P(\\mbox{Éxito})=p$. $BN(n,p)$ \n\\\\\\hline\n$D_X=\\{0,1,2,3\\ldots\\}$  \\\\\\hline\n$P_X(k)=P(X=k)=\\left\\{\\begin{array}{ll} {k+n-1\\choose n-1} \\cdot (1-p)^{k}\\cdot p^n, & \\mbox{si }  k=0,1,\\ldots \\\\ 0, & \\mbox{en otro caso.}\\end{array}\\right.$\\\\\\hline\n$\nF_X(x)=P(X\\leq x)=\n\\left\\{\n\\begin{array}{ll} 0, & \\mbox{si } x<0\\\\\\displaystyle\\sum_{i=0}^{k} P(X=i) & \\mbox{si  }\\left\\{\\begin{array}{l}k\\leq x< k+1,\\\\k=0,1,2,\\ldots\\end{array}\\right.\\end{array}\\right.$ \n\\\\\\hline\n$E(X)=n\\cdot\\frac{1-p}{p}$;  $Var(X)=n\\cdot \\frac{1-p}{p^2}.$ \\\\\\hline\n\\end{tabular}\n\\end{table}\n\n## Ejemplo puerta dos cerraduras $BN(n=2,p=0.1)$.\n\n  \n**Ejercicio: Puerta  con dos cerraduras**\n\nRecordemos nuestra puerta con dos cerraduras que se abren secuencialmente. Tenemos un manojo de 10 llaves casi idénticas de manera que cada vez que probamos una llave olvidamos qué llave hemos usado.\n\n\nSea $X$ la v.a que nos da el número de  intentos fallidos hasta abrir  abrir la puerta. \n\n  \n\n## Ejemplo $BN(n,p)$ \n\n\n  \n\nEstamos interesado en modelar  este problema.  La preguntas son:\n\n1. ¿Cuál es la distribución de probabilidad de $X$ la v.a que nos da el número fallos  hasta abrir la puerta? \n2. ¿Cuál es la función de probabilidad y de distribución de $X$?\n3. ¿Cuál es la probabilidad de fallar  exactamente  5 veces antes de abrir la puerta?\n4. ¿Cuál es la probabilidad de fallar más de  4?\n5. ¿Cuál es  el número esperado de fallos? ¿Y su desviación típica?\n\n  \n\n\n## Ejemplo dos cerraduras $BN(n=2,p=0.1)$.\n\n\n\n**Solución 1.**  ¿Cuál es la distribución de probabilidad de $X$ la v.a que nos da el número fallos  hasta abrir la puerta? \n\nBajo estados condiciones tenemos que la probabilidad de \"éxito\" de cada intento es $p=\\frac{1}{10}=0.1$. Como cada vez *olvidamos* qué llave hemos probado, cada intento será independiente del anterior.\n\nAsí que  la variable $X$ que queremos modelar  cuenta el número  fallos  de repeticiones sucesivas e independientes de  un experimento $Ber(p=0.1)$ hasta conseguir 2 éxitos en un experimento.\n\nPor lo tanto  podemos asegurar que $X$ sigue un distribución $BN(n=2,p=0.1).$\n  \n\n\n## Ejemplo $BN(n=2,p=0.1)$ \n\n\n\n\n**Solución 2.** ¿Cuál es la función de probabilidad y de distribución del $X$?\n\nEn general la función de probabilidad  de una $BN(n,p)$ es \n\n\n\n$$\nP_X(k)=P(X=k)=\n\\left\\{\n\\begin{array}{cc} \n{k+n-1\\choose n-1} \\cdot (1-p)^{k}\\cdot p^n & \\mbox{si }  k=0,1,\\ldots \\\\ 0 & \\mbox{en otro caso.}\\end{array}\\right.\n$$\n\nSi aplicamos la expresión anterior para $n=2$ y $p=0.1$, obtenemos:\n$$\nP_X(k)=P(X=k)=\n\\left\\{\n\\begin{array}{cc} \n{k+2-1\\choose 2-1} \\cdot 0.9^{k}\\cdot 0.1^2 & \\mbox{si }  k=0,1,2,\\ldots \\\\ 0 & \\mbox{en otro caso.}\\end{array}\\right.\n$$\n  \n\n## Ejemplo $BN(n=2,p=0.1)$ \n\n\n\n\nSimplificando\n\n\n$$\nP_X(X=k)=P(X=k)=\n\\left\\{\n\\begin{array}{cc} \n0.01\\cdot (k+1)\\cdot 0.9^{k}, & \\mbox{si }  k=0,1,2,\\ldots \\\\ 0 & \\mbox{en otro caso.}\\end{array}\\right.\n$$\n\nLa función de distribución  en general es \n\n$$\nF_X(x)=P(X\\leq x)=\n\\left\\{\n\\begin{array}{ll}\n0 & \\mbox{si } x<0 \\\\\n\\displaystyle\\sum_{i=0}^{k }{i+n-1\\choose n-1} \\cdot (1-p)^{i+n-1}\\cdot p^n \n& \\mbox{si }\\left\\{\\begin{array}{l} k\\leq x< k+1\\\\k=0,1,2,\\ldots\\end{array}\\right. \n\\end{array}\n\\right.\n$$\n\n  \n\n\n## Ejemplo $BN(n=2,p=0.1)$ \n\n\n\n\nSimplificando para $n=2$, $p=0.1$.\n\n$$\nF_X(x)=P(X\\leq x)=\n\\left\\{\n\\begin{array}{ll}\n0, & \\mbox{si } x<0, \\\\\n\\displaystyle\\sum_{i=0}^{k }0.01\\cdot (i+1) \\cdot 0.9^{i+1},\n& \\mbox{si }\\left\\{\\begin{array}{l} k\\leq x< k+1,\\\\k=0,1,2,\\ldots\\end{array}\\right. \n\\end{array}\n\\right.\n$$\n\n\n\n**Solución 3.**  ¿Cuál es la probabilidad de fallar  exactamente  5 veces antes de abrir la puerta?\n\n$$\nP(X=5)= 0.01\\cdot (5+1) \\cdot 0.9^{5}= 0.06 \\cdot 0.9^{5}= `r 6*0.9^5*0.1^2`.\n$$\n\n  \n\n\n## Ejemplo $BN(n=2,p=0.1)$ \n\n\n\n\n**Solución 4.** ¿Cuál es la probabilidad de fallar más de 4?\n\n\n\nNos piden que  \n$$\nP(X>4)=1-P(X\\leq 4).\n$$\n\nCalculemos primero $P(X\\leq 4):$\n\n$$\n\\begin{array}{rl}\nP(X\\leq 4) &=  \\displaystyle\\sum_{x=0}^{4} P(X=x)=P(X=0)+P(X=1)+P(X=2)+P(X=3)+P(X=4)\\\\\n&= 0.01\\cdot (0+1) \\cdot 0.9^{0}+0.01\\cdot (1+1) \\cdot 0.9^{1}+0.01\\cdot (2+1) \\cdot 0.9^{2} \\\\ &\\ \\ \n+0.01\\cdot (3+1) \\cdot 0.9^{3} + 0.01\\cdot (4+1) \\cdot 0.9^{4} \\\\ & =\n0.01 +`r 0.01*2*0.9`+`r 0.01*3*0.9^2`+`r 0.01*4*0.9^3`+`r 0.01*5*0.9^4` = `r 0.01+ 0.01*2*0.9+ 0.01*3*0.9^2+ 0.01*4*0.9^3+ 0.01*5*0.9^4`.\n\\end{array}\n$$\n  \n    \n## Ejemplo $BN(n=2,p=0.1)$ \n\n\n\n\nPor lo tanto \n\n$$\nP(X>4)=1-P(X\\leq 4)=1-`r 0.1^2+ 2* 0.9 * 0.1^2+ 3*0.9^2* 0.1^2 +4*0.9^3* 0.1^2+5*0.9^4* 0.1^2`=\n`r 1- (0.1^2+ 2* 0.9 * 0.1^2+ 3*0.9^2* 0.1^2 +4*0.9^3* 0.1^2+5*0.9^4* 0.1^2)`.\n$$\n\n```{r echo=FALSE,eval=FALSE}\npnbinom(4-2,2,0.1)\n0.1^2+ 2* 0.9 * 0.1^2+ 3*0.9^2* 0.1^2\ndnbinom(0,2,0.1)\n0.1^2\ndnbinom(1,2,0.1)\n2* 0.9 * 0.1^2\ndnbinom(2,2,0.1)\n3*0.9^2* 0.1^2\n```\n\n**Solución 5.**  ¿Cuál es  el número esperado de fallos? ¿Y su desviación típica?\n\n\nComo $X$ sigue una ley $BN(n=2,p=0.1)$\n\n$$E(X)=n\\cdot \\frac{1-p}{p}=2\\cdot \\frac{1-0.1}{0.1}=`r 2*(1-0.1)/0.1`.$$\n\nEl número de fallos esperado es `r 2*(1-0.1)/0.1`. La varianza es\n\n$$\nVar(X)=n\\cdot\\frac{1-p}{p^2}=2 \\cdot \\frac{1-0.1}{0.1^2}=`r 2*(1-0.1)/0.1^2`,\n$$\n\ny su desviación típica $\\sqrt{180}=`r round(sqrt(2*(1-0.1)/0.1^2),5)`.$\n\n  \n\n\n\n## Cálculos con R\n\nLa función de `R` que calcula la función de probabilidad de la  binomial negativa con sus parámetros básicos es: \n\n```\ndnbinom(x, size, prob,...)`\n```\ndonde `size` ($n$) es el número de éxitos y  `prob` ($p$), la probabilidad de éxito.\n\nAsí en el ejemplo de la puerta con dos cerraduras, $X$ es una $BN(n=size=2,p=prob=0.1)$. Por ejemplo, $P(X=5)$ que hemos calculado en el ejemplo anterior, vale:\n\n\n```{r}\ndnbinom(5,size=2,p=0.1)\n```\n\n\n## Cálculos con R\n\nDe forma similar calculamos calculamos $P(X\\leq 4)$, $P(X>4)=1-P(X\\leq 4)$ y $P(X>4)$.\n\n```{r}\npnbinom(4,size=2,p=0.1)\n1-pnbinom(4,size=2,p=0.1)\npnbinom(4,size=2,p=0.1,lower.tail=FALSE)\n```\n\n## Cálculos con python\n\nLa función con python es `nbinom.pmf(k, n, p, loc)`. Hay que cargarla desde `scpi.stats`\n\n```{python}\nfrom scipy.stats import nbinom\n```\n\nRecordemos que de nuevo se cumple que \n```{python, eval=F}\nnbinom.pmf(k, n, p, loc) = nbinom.pmf(k-loc, n, p)`\n```\n\n\n## Cálculos $BN(n,p)$ con python\n\n```{python}\nnbinom.pmf(k=5,n=2,p=0.1)\nnbinom.pmf(k=5,n=2,p=0.1,loc=0)\nnbinom.cdf(k=4,n=2,p=0.1)\n1-nbinom.cdf(k=4,n=2,p=0.1)\n```\n\n\n## Cálculos $BN(n,p)$ con python\n\nGeneremos 100 observaciones aleatorias de una $BN(n=2,0.1)$. Es decir serán las veces que hemos fallado hasta abrir la puerta 100 veces.\n\n```{python}\nnbinom.rvs(n=2, p=0.1, size=100)\n```\n\n## Cálculos $BN(n,p)$ con python\n\nLa **esperanza** y la **varianza**de una $BN(n=2,0.1)$ valen: \n\n```{python}\nn, p=2,0.1\nparams = nbinom.stats(n,p,moments='mv')\nprint(\"E(X)={m}\".format(m=params[0]))\nprint(\"Var(X)={v}\".format(v=params[1]))\n```\n\n## Gráficas de la binomial negativa con R \n\nEl siguiente código de R dibuja las función de probabilidad y la de distribución de una  $BN(n=2,p=0.1)$\n\n::: {.small}\n```{r fig.align='center',echo=TRUE,eval=FALSE,fig.out=\"60%\"}\npar(mfrow=c(1,2))\naux=rep(0,22)\naux[seq(2,22,2)]=dnbinom(c(0:10),size=2,prob=0.1)\nplot(x=c(0:10),y=dnbinom(c(0:10),size=2,prob=0.1),\n  ylim=c(0,1),xlim=c(-1,11),xlab=\"x\",\n  main=\"Función de probabilidad\\n BN(n=2,p=0.1)\")\nlines(x=rep(0:10,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\ncurve(pnbinom(x,size=2,prob=0,1),\n  xlim=c(-1,11),col=\"blue\",\n  main=\"Función de distribución\\n BN(n=2,p=0.1)\")\npar(mfrow=c(1,1))\n```\n:::\n\n## Gráficas de la binomial negativa con R \n\n\n```{r fig.align='center',echo=FALSE}\npar(mfrow=c(1,2))\naux=rep(0,22)\naux[seq(2,22,2)]=dnbinom(c(0:10),size=2,prob=0.1)\nplot(x=c(0:10),y=dnbinom(c(0:10),size=2,prob=0.1),\n  ylim=c(0,1),xlim=c(-1,11),xlab=\"x\",\n  main=\"Función de probabilidad\\n BN(n=2,p=0.1)\")\nlines(x=rep(0:10,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\ncurve(pnbinom(x,size=2,prob=0.1),\n  xlim=c(-1,11),col=\"blue\",\n  main=\"Función de distribución\\n BN(n=2,p=0.1)\")\npar(mfrow=c(1,1))\n```\n\n\n```{r  GRAFICOS_binomial_negativa, eval = FALSE,echo=FALSE}\n\n```\n\n## Gráficos de la binomial negativa con python\n\n  \n**Ejercicio**\n\nBuscad en los manuales de python cómo se dibuja la función de probabilidad y de distribución de una binomial.\nnegativa \n\n  \n\n \nNecesitamos de nuevo más librerías\n\n```{python}\nimport numpy as np\nfrom scipy.stats import nbinom\nimport matplotlib.pyplot as plt\n```\n  \n\n## Gráficos de la binomial negativa con python\n\n\n::: {.small}\n\n```{python dibu_python2222,eval=FALSE}\nn, p = 10, 0.25\nx = np.arange(0,nbinom.ppf(0.99, n, p))\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\nax.plot(x, nbinom.pmf(x, n, p), 'bo', ms=5, label='nbinom pmf')\nax.vlines(x, 0, nbinom.pmf(x, n, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\nax.plot(x, nbinom.cdf(x, n, p), 'bo', ms=5, label='nbinom pmf')\nax.vlines(x, 0, nbinom.cdf(x, n, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfig.suptitle('Distribucion Binomial Negativa')\nplt.show()\n```\n:::\n\n\n## Gráficos de la binomial negativa con python\n\n\n```{python  negativa_py_show,echo=FALSE}\nn, p = 10, 0.25\nx = np.arange(0,nbinom.ppf(0.99, n, p))\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\n_=ax.plot(x, nbinom.pmf(x, n, p), 'bo', ms=5, label='nbinom pmf')\n_=ax.vlines(x, 0, nbinom.pmf(x, n, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\n_=ax.plot(x, nbinom.cdf(x, n, p), 'bo', ms=5, label='nbinom pmf')\n_=ax.vlines(x, 0, nbinom.cdf(x, n, p), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\n_=fig.suptitle('Distribucion Binomial Negativa')\n_=plt.show()\n```\n\n\n## Ejercicio:  Acceso aleatorio a un sistema con triple clave. \n\n\n  \n**Sistema con tres claves de acceso**\n\nSupongamos que tenemos un sistema informático tiene un programa de seguridad que genera accesos con   claves  de  3 dígitos  $000,001,\\ldots 999$. En total 1000 posibilidades.\n\nComo una clave de tres dígitos es fácil de romper proponemos considerar  tres claves consecutivas de acceso al sistema, cada una de 3 dígitos.\n\nPara acceder al sistema hay que dar  las tres claves de forma consecutiva y por orden.\n\nEs decir hasta que no averiguamos la primera clave no pasamos a la segunda clave.\n\nSupongamos que cada vez que ponemos las dos claves olvidamos el resultado y seguimos poniendo claves al azar hasta adivinar la contraseña.\n\nAsí hasta conseguir entrar en el sistema.\n\nSea $X$ la v.a que nos da el número de fallos antes de  entrar en el sistema.\n\n  \n\n## Ejercicio  acceso aleatorio a un sistema con triple clave. \n\n\n  \n\nEstamos interesados en modelar  este problema.  La preguntas son:\n\n1. ¿Cuál es la distribución de probabilidad de $X$, la v.a que nos da el número de fallos antes de acceder al  sistema.\n2. ¿Cuál es la función de probabilidad y de distribución del $X$?\n3. ¿Cuál es la probabilidad de fallar  150 veces antes de acceder en el sistema?\n4. ¿Cuál es la probabilidad de fallar  más de  150  veces antes de entrar en el sistema?\n5. ¿Cuál es  el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?\n\n  \n\n\n## Ejemplo $BN(r,p)$ \n\n\n \n\n**Solución 1.**  ¿Cuál es la distribución de probabilidad de $X$, la v.a que nos da el número de fallos antes de acceder al  sistema?\n\nBajo estados condiciones tenemos que la probabilidad de \"éxito\" de cada intento es $p=\\frac{1}{1000}=0.001$. Y como cada vez *olvidamos* en los dígitos cada intento será independiente del anterior.\n\nAsí que  la variable $X$   cuenta el número de fracasos independientes hasta conseguir 3 éxitos en un experimento $Ber(p=0.001)$ por lo tanto $X$ sigue un distribución $BN(n=3,p=0.001).$\n\n  \n\n\n\n\n\n## Ejemplo $BN(r,p)$ \n\n\n \n\n**Solución 2.** ¿Cuál es la función de probabilidad y de distribución del $X$\n\nEn general la   función de probabilidad  de una $BN(n,p)$ es \n\n\n$$\nP_X(X=x)=P(X=x)=\n\\left\\{\n\\begin{array}{cc} \n{x+n-1\\choose n-1} \\cdot (1-p)^{x}\\cdot p^n & \\mbox{si }  x=0,1,\\ldots \\\\ 0 & \\mbox{en otro caso.}\\end{array}\\right.\n$$\nEn particular la   función de probabilidad  de una $BN(n=3,p=0.001)$ es\n\n\n$$\nP_X(X=x)=P(X=x)=\n\\left\\{\n\\begin{array}{cc} \n{x+2\\choose 2} \\cdot 0.999^{x}\\cdot 0.001^3 & \\mbox{si }  x=0,1,2,\\ldots \\\\ 0 & \\mbox{en otro caso.}\\end{array}\\right.\n$$\n\n\n  \n\n\n\n\n\n## Solución  ejemplo  $BN(n=3,p=0.001)$ \n\n\n \n\n**Solución 3.** ¿Cuál es la probabilidad de fallar  150 veces antes de acceder en el sistema?\n\nNos piden\n\n$$\n\\scriptsize{P(X=150)= {152\\choose 2} \\cdot 0.999^{150}\\cdot 0.001^3.}\n$$\n\nLo calcularemos operando  con R\n\n```{r}\nchoose(152,2)*0.999^150*0.001^3\n```\n\n```{r}\ndnbinom(150,size=3,p=0.001)\n```\n\n## Solución  ejemplo  $BN(n=3,p=0.001)$ \n\n\n \n\n**Solución 3.** ¿Cuál es la probabilidad de fallar  150 veces antes de acceder en el sistema?\n\nNos piden, lo resolveremos con python\n\n$$\nP(X=150)= {152\\choose 2} \\cdot 0.999^{150}\\cdot 0.001^3\n$$\n\n```{python}\nfrom  scipy.special import binom\nbinom(152,2)*0.999**150*0.001**3\nnbinom.pmf(150,n=3,p=0.001)\n```\n\n  \n\n\n\n\n\n## Solución  ejemplo  $BN(n,p)$ \n\n\n\n\n**Solución 4.** ¿Cuál es la probabilidad de fallar  más de  150  veces antes de entrar en el sistema?\n\n\n$$P(X>150)=1-P(X\\leq 150)$$\n\nCalculemos $P(X\\leq 150)$\n\n\n\\begin{eqnarray*}\nP(X\\leq 150) &=& P(X=0)+P(X=1)+P(X=2)+\\ldots+P(X=150)\\\\\n&=& \\sum_{k=0}^{150} {k+3-1\\choose 3-1} \\cdot (0.999)^{k}\\cdot 0.001^3\\ldots = \\ldots =`r pnbinom(150,3,0.001)`\n\\end{eqnarray*}\n\n  \n\n\n\n## Solución  ejemplo  $BN(n,p)$ \n\n\nCon R\n```{r}\npnbinom(150,3,0.001)\n```\nCon python\n\n```{python}\nnbinom.cdf(150,n=3,p=0.001)\n```\n\n## Solución  ejemplo  $BN(n,p)$ \n\nEl valor pedido será pues:\n$$\nP(X>150)=1-P(X\\leq 150)=1-`r pnbinom(150,3,0.001)`=`r 1-pnbinom(150,3,0.001)`.\n$$\nVemos que es muy probable que fallemos más de 150 veces antes de entrar en el sistema.\n\n\n\n## Solución  ejemplo  $BN(n,p)$ \n\n\n\n\n**Solución 5.**  ¿Cuál es  el número esperado de fallos antes de acceder al sistema? ¿Y su desviación típica?\n\nTenemos que $E(X)=n\\cdot \\frac{1-p}{p}=3\\cdot \\frac{1- 0.001}{0.001}=`r 3*(1- 0.001)/0.001`$ y $Var(X)=n\\cdot \\frac{1-p}{p^2}=3\\cdot \\frac{1- 0.001^2}{0.001^2}=`r 3*(1- 0.001)/0.001^2`.$\n\nCon python\n\n```{python}\nparams = nbinom.stats(n=3,p=0.001,moments='mv')\nprint(\"E(X) = {m}\".format(m=params[0]))\nprint(\"Var(X) = {v}\".format(v=params[1]))\n```\n\n  \n\n\n##  ¿Tres claves de tres dígitos o una de 9 dígitos?\n\n  \n\n**Ejercicio**\n\nSupongamos que ponemos una sola clave de 9 dígitos. Estudiemos en este caso la variable aleatoria que da el número de fallos antes de entrar en el sistema y comparemos los resultados.\n\n  \n\n \nSi seguimos suponiendo que cada vez ponemos la contraseña al azar pero esta vez con una  clave de  9 dígitos. La probabilidad de éxito será ahora $p=\\frac{1}{10^{9}}$.\n\nSi llamamos $X_9$  a la variable aleatoria que nos da el número de fallos antes de entra en el sistema seguirá una distribución $Ge(p=\\frac{1}{10^9}=0.000000001)$.\n  \n##  Qué da más seguridad  ¿tres claves de tres dígitos o una de 9 dígitos?\n\n \n\nSu valor esperado es\n\n$$\nE(X_9)=\\frac{1-p}{p}=\\frac{1-0.000000001}{0.000000001}=`r (1-0.000000001)/0.000000001`.\n$$\n\n $1000 000 000$  son  1000 millones de fallos esperados hasta abrir la puerta.\n \n Recordemos que con tres contraseñas de 3 dígitos  el valor esperado de fallos es \n \n $$3\\cdot \\frac{1-0.001}{0.001}=`r 3*(1-0.001)/0.001`.$$\n \nPor lo tanto, desde el punto de vista de la seguridad, es mejor una clave larga de 9 dígitos que tres cortas si escribimos las contraseñas al azar.\n  \n\n# Distribución de Poisson\n\n## Distribución Poisson\n\nDiremos que una v.a. discreta $X$ con $X(\\Omega)=\\mathbf{N}$ tiene distribución de Poisson con parámetro $\\lambda>0$, y lo denotaremos por $Po(\\lambda)$ si su función de probabilidad es:\n\n$$\nP_{X}(x)=P(X=x)=\n\\left\\{\\begin{array}{ll}\n\\frac{\\lambda^x}{x!} e^{-\\lambda}& \\mbox{ si } x=0,1,\\ldots\\\\\n0 & \\mbox{en otro caso}\\end{array}\\right..\n$$\n\n\n\n## Distribución Poisson\n\nUsando que el desarrollo en serie  de Taylor de la función exponencial es \n$$\ne^{\\lambda}=\\sum_{x=0}^{+\\infty} \\frac{\\lambda^x}{x!},\n$$\nes  fácil comprobar que la suma de la función de probabilidad en todos los valores del dominio de $X$, o sea, los enteros positivos, vale 1.\n\n\nAdemás recordemos que   dado $x\\in\\mathbb{R}-\\{0\\}$   se tiene que  \n\n$$\n\\lim_{n\\to\\infty} \\left(1+\\frac{x}{n}\\right)^n=e^x.\n$$\n\n\n## Distribución Poisson\n\nUsando la expresión anterior para $x=-\\lambda$, tenemos:\n\n$$\n\\lim_{n\\to\\infty} \\left(1-\\frac{\\lambda}{n}\\right)^n=\\lim_{n\\to\\infty} \\left(1+\\frac{-\\lambda}{n}\\right)^n=e^{-\\lambda}.\n$$\n\n## La distribución de Poisson como \"límite\" de una binomial.\n\nLa distribución de Poisson ([Siméon Denis Poisson](https://es.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson)) aparece en el conteo de determinados  eventos que se producen en un intervalo de tiempo o en el espacio.\n\nSupongamos que nuestra variable de interés es  $X$, el número de eventos en el intervalo de tiempo $(0,t]$, como por ejemplo el número de llamadas a un *call center* en una hora donde suponemos que se cumplen las siguientes condiciones:\n\n## La distribución Poisson como \"límite\" de una binomial.\n\n1. El número promedio de eventos en el intervalo $(0,t]$ es\n$\\lambda>0$.\n2. Es posible dividir el intervalo de tiempo en un\ngran número de subintervalos (denotemos por $n$ al número de intervalos) de forma que:\n    + La probabilidad de que se produzcan dos o más eventos en un subintervalo es despreciable.\n    + El número de ocurrencias de eventos en un intervalo  es independiente del número de ocurrencias en otro intervalo.\n    + La probabilidad de que un evento ocurra en un subintervalo es $p_n=\\frac{\\lambda}{n}$·\n\n## La distribución Poisson como \"límite\" de una binomial.\n\nBajo estas condiciones, podemos considerar que el número de eventos en el intervalo $(0,t]$ será el número de \"éxitos\" en $n$ repeticiones independientes de un proceso Bernoulli de parámetro $p_n$\n\nEntonces si $n\\to\\infty$ y $p_n\\cdot n$ se mantiene igual a $\\lambda$ resulta que la función de probabilidad de $X$ se puede escribir como\n\n## La distribución Poisson como \"límite\" de una binomial.\n\n$$\n\\begin{array}{rl}\nP(X_n=k)&=\\left(\\begin{array}{c} n\\\\ k\\end{array}\\right) \\cdot p_n^k\\cdot  (1-p_n)^{n-k}\n\\\\\n&= {n\\choose k}\\cdot \\left(\\frac{\\lambda}{n}\\right)^{k}\\cdot \\left(1-\\frac{\\lambda}{n}\\right)^{n-k}\\\\\n&=\n\\frac{\\lambda^k}{k!}\\cdot\\frac{n!}{(n-k)!\\cdot n^k}\\cdot\n\\left(1-\\frac{\\lambda}{n}\\right)^{n}\\cdot \\left(1-\\frac{\\lambda}{n}\\right)^{-k}.\n\\end{array}\n$$\n\n## La distribución Poisson como \"límite\" de una binomial.\n\nSi hacemos tender $n$ hacia $\\infty$, obtenemos:\n$$\n\\lim_{n\\to \\infty} P(X_n=k) = \\lim_{n\\to \\infty} \\frac{\\lambda^k}{k!}\\cdot\\frac{n!}{(n-k)!\\cdot n^k} \\cdot\n\\left(1-\\frac{\\lambda}{n}\\right)^{n}\\cdot \\left(1-\\frac{\\lambda}{n}\\right)^{-k}.\n$$\n\nCalculemos el límite de algunos de los factores de la expresión \n\n$$\n\\displaystyle\\lim_{n\\to \\infty}\\frac{n!}{(n-k)!\\cdot n^k}= \\lim_{n\\to \\infty}\\frac{n\\cdot (n-1)\\cdots (n-k-1)}{n^k}\n=\\lim_{n\\to \\infty}\\frac{n^{k}+\\cdots}{n^k}=1.\n$$\n\n\n## La distribución Poisson como \"límite\" de una binomial.\n\n$$\n\\lim_{n\\to \\infty} \\left(1-\\frac{\\lambda}{n}\\right)^{n}=e^{-\\lambda}\n$$\n\n\nY  también teniendo en cuanta que $k$ es constante.\n\n$$\n\\lim_{n\\to \\infty} \\left(1-\\frac{\\lambda}{n}\\right)^{-k}=\\lim_{n\\to \\infty} 1^{-k}=\\lim_{n\\to \\infty}  1=1.\n$$\n\n## La distribución Poisson como \"límite\" de una binomial.\n\nPara acabar\n\n$$\n\\displaystyle\\lim_{n\\to\\infty} P(X_n=k)=\n\\lim_{n\\to\\infty} \\left(\\begin{array}{c} n\\\\ k\\end{array}\\right)\n\\cdot p_n^k \\cdot (1-p_n)^{n-k}= \\frac{\\lambda^k}{k!}\\cdot 1 \\cdot e^{-\\lambda}\\cdot 1=\\frac{\\lambda^k}{k!}\\cdot e^{-\\lambda}.\n$$\n\nLo que confirma que  límite de una serie de variables \n$B(n,p_n=\\frac{\\lambda}{n})$ sigue una ley $Po(\\lambda)$.\n\n## Procesos de Poisson\n\nLo interesante de las variables Poisson es que podemos modificar (si el modelo lo permite)  el intervalo de tiempo $(0,t]$ en el que contamos los eventos.\n\nClaro que esto no tiene que poder ser así. \n\nPero en general si la variable es poisson en  $(0,t]$  también lo será en cualquier subintervalo $(0,t']$ para todo $t'$ tal que  $0<t'<t$. \n\nAsí que podremos definir una serie de variables $X_t$ de distribución $Po(\\lambda\\cdot t)$.\n\n\n## Procesos de Poisson\n\n<l class=\"prop\"> Definición procesos de Poisson </l>\n\nConsideremos  un experimento *Poisson*  con $\\lambda$ igual\nal promedio de eventos en una unidad de tiempo (u.t.).\n\nSi $t$ es una cantidad de tiempo en u.t., la v.a. $X_{t}$=numero de eventos en el intervalo $(0,t]$ es una $Po(\\lambda\\cdot t)$.\n\nEl conjunto de variables $\\{X_t\\}_{t>0}$ recibe el nombre de **proceso de Poisson**.\n\n\n## Resumen distribución  Poisson  $X\\sim Po(\\lambda)$\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X$ con distribución  Poisson  de media o promedio $\\lambda$,  $Po(\\lambda)$\n\\\\\\hline\n$D_X=\\{0,1,\\ldots \\}$ \\\\\\hline\n$P_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}  \\frac{\\lambda^x}{x!}e^{-\\lambda} & \\mbox{ si } x=0,1,\\ldots\\\\ 0  & \\mbox{ en otro caso.}\\end{array}\\right.$\\\\\\hline\n$\\scriptstyle F_X(x)=P(X\\leq X)=\\left\\{\\begin{array}{ll} 0 & \\mbox{si } x<0\\\\\\displaystyle\\scriptstyle\\sum_{i=0}^{k} P(X=i)= \\displaystyle\\scriptstyle\\sum_{i=0}^{k} \\frac{\\lambda^i}{i!}\\cdot e^{-\\lambda} & \\mbox{si  }\\left\\{\\begin{array}{l}\\scriptstyle k\\leq x< k+1\\\\\\scriptstyle k=0,1,2,\\ldots\\end{array}\\right.\\end{array}\\right.$\n     \\\\\\hline\n$E(X)=\\lambda$; $Var(X)=\\lambda$\\\\\\hline\n\\end{tabular}\n\\end{table}\n\n## Resumen proceso   Poisson  $X_t\\sim Po(\\lambda\\cdot t)$\n\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X_t=$ número de eventos en el intervalo $(0,t]$  $Po(\\lambda\\cdot t)$  donde  $\\lambda$ promedio por u.t. \n\\\\\\hline\n$D_X=\\{0,1,\\ldots \\}$ \\\\\\hline\n$P_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}  \\frac{(\\lambda\\cdot t)^x}{x!}e^{-\\lambda\\cdot t} & \\mbox{ si } x=0,1,\\ldots\\\\ 0  & \\mbox{ en otro caso.}\\end{array}\\right.$\\\\\\hline\n$\\scriptstyle F_X(x)=P(X\\leq X)=\\left\\{\\begin{array}{ll} 0 & \\mbox{si } x<0\\\\\\displaystyle\\scriptstyle\\sum_{i=0}^{k} P(X=i)= \\displaystyle\\scriptstyle\\sum_{i=0}^{k} \\frac{(\\lambda\\cdot t)^i}{i!}\\cdot e^{-\\lambda\\cdot t} & \\mbox{si  }\\left\\{\\begin{array}{l}\\scriptstyle k\\leq x< k+1\\\\\\scriptstyle k=0,1,2,\\ldots\\end{array}\\right.\\end{array}\\right.$\n\n   \\\\\\hline\n$E(X)=\\lambda\\cdot t$; $Var(X)=\\lambda\\cdot t$\\\\\\hline\n\\end{tabular}\n\\end{table}\n\n\n## Aproximación de la distribución binomial por la Poisson\n\nBajo el punto de vista anterior y si $p$ es pequeño y $n$ suficientemente grande  la distribución  $B(n,p)$ se aproxima a una $Po(\\lambda=n\\cdot p)$.\n\nExisten distintos criterios (ninguno perfecto) de cuando la aproximación es buena.\n\nPor ejemplo  si \n\n$$n\\geq 20\\mbox{ o mejor }n\\geq 30, n\\cdot p < 10 \\mbox{ y } p\\leq 0.05,$$\n\n\nla aproximación  de una $B(n,p)$ por una $Po(n\\cdot p)$ es buena. Sobre todo para los valores cercanos a $E(X)=\\lambda$.\n\nCondición deseable $n\\geq 20$,  $n\\cdot p < 10$, $p\\leq 0.05$.\n\n\n## Ejemplo $Po(\\lambda)$ \n\n  \n**Ejemplo**: Trampa insectos.\n\nLa conocida [lámpara antiinsectos o insecticida eléctrico](https://es.wikipedia.org/wiki/Insecticida_el%C3%A9ctrico) atrae a  los insectos voladores con una luz ultravioleta  y los mata por electrocución. \n\nConsideremos la v.a. $X$ que cuenta el número de insectos caídos en la trampa en una hora. Supongamos que el número promedio de insectos que captura la trampa en una hora es $E(X)=20$ y que podemos admitir que $X$ sigue una ley de probabilidad $Po(\\lambda=20)$.\n\n\nNos piden \n\n1.  Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson. \n2.  Escribir de forma explicita la función de probabilidad  y de distribución de $X$.\n3.  Calculad la probabilidad de  que en una hora caigan en la trampa  exactamente 21 insectos.\n4.  Calculad la probabilidad de  que en una hora caigan en la trampa  al menos 6 insectos.\n5.  ¿Cuál es el valor esperando, la varianza y la desviación típica de $X$?\n\n  \n\n\n## Ejemplo $Po(\\lambda)$ \n\n\n\n\n\n**Solución 1.**  Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson. \n\n\n1. El número promedio de eventos en el intervalo $(0,1]$, una hora  es\n$\\lambda=20>0$.\n2. Es posible dividir el intervalo de tiempo  de una hora en un\ngran número de subintervalos (denotemos por $n$ al número de intervalos) de forma que:\n    + La probabilidad de que se produzcan dos o más  electrocuciones un subintervalo es despreciable. No es posible que dos mosquitos se electrocuten al mismo tiempo.\n    + El número de ocurrencias, electrocuciones de insectos, en un intervalo  es independiente del número de electrocuciones en otro intervalo.\n    + La probabilidad de que un evento ocurra en un subintervalo es  $p_n=\\frac{\\lambda}{n}$· Podemos dividir los 20  insectos promedio entre los $n$ intervalos (trozo de hora) de forma que $p_n=\\frac{\\lambda}{n}$. \n    + Por ejemplo si $n=60$ tenemos que $p_n=\\frac{20}{60}=\\frac{1}{3}$. La probabilidad de que en un minuto la trampa chisporrotee es  $\\frac{1}{3}$.\n    \n  \n\n## Ejemplo $Po(\\lambda)$ \n\n\n**Solución 2.** Escribid de forma explicita la función de probabilidad  y de distribución de $X$.\n\n\nLa distribución de probabilidad de un $Po(\\lambda)$ es\n\n$$\nP_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}  \\frac{\\lambda^x}{x!}e^{-\\lambda} & \\mbox{ si } x=0,1,\\ldots\\\\ 0  & \\mbox{ en otro caso.}\\end{array}\\right.\n$$\n\nEn nuestro caso, $\\lambda =20$:\n\n$$\nP_X(x)=P(X=x)=\\left\\{\\begin{array}{ll}\\frac{20^x}{x!}e^{-20} & \\mbox{ si } x=0,1,\\ldots\\\\ 0  & \\mbox{ en otro caso.}\\end{array}\\right.\n$$\n\n  \n\n## Ejemplo $Po(\\lambda)$ \n\n\nLa función de distribución es \n\n$$\nF_X(x)=P(X\\leq X)=\n\\left\\{\\begin{array}{ll} \n0 & \\mbox{si } x<0\\\\\n\\displaystyle\\sum_{i=0}^{k} P(X=i)=\\sum_{i=0}^{k}\\frac{\\lambda^i}{i!}\\cdot e^{-\\lambda} & \\mbox{si  }\n\\left\\{\\begin{array}{l}\nk\\leq x< k+1\\\\k=0,1,2,\\ldots\n\\end{array}\n\\right.\n\\end{array}\n\\right.\n$$     \n\n\nEn nuestro caso \n$$\nF_X(x)=P(X\\leq X)=\n\\left\\{\\begin{array}{ll} \n0 & \\mbox{si } x<0\\\\\n\\displaystyle\\sum_{i=0}^{k} P(X=i)=\\sum_{i=0}^{k}\\frac{20^i}{i!}\\cdot e^{-20} & \\mbox{si  }\n\\left\\{\\begin{array}{l}\nk\\leq x< k+1\\\\k=0,1,2,\\ldots\n\\end{array}\n\\right.\n\\end{array}\n\\right.\n$$ \n \n \n  \n\n## Ejemplo $Po(\\lambda)$ \n\n\n\n\n\n**Solución 3.** Calculad la probabilidad de  que en una hora caigan en la trampa  exactamente 21 insectos.\n\nNos piden la probabilidad siguiente:\n$$\nP(X=21)=\\frac{20^{21}}{21!} e^{-20}=`r 20^(21)/factorial(21)*exp(-20)`.\n$$\n\nPara realizar el cálculo anterior, podemos usar `R` como calculadora o usar la función `dpois` que nos calcula la función de distribución de la variable de Poisson:\n```{r}\n20^21/factorial(21)*exp(-20)\ndpois(21,lambda = 20)\n```\n\n  \n\n## Ejemplo $Po(\\lambda)$ \n\n\n\n**Solución 4.**  Calculad la probabilidad de  que en una hora caigan en la trampa  al menos 6 insectos.\n\n\nNos piden la probabilidad siguiente:\n$$\n\\begin{array}{rl}\n P(X\\geq 6)&=1- P(X<6)=1-P(X\\leq 5)=1-F_X(5)=1-\\displaystyle\\sum_{x=0}^{5} \\frac{20^{x}}{x!}\\cdot e^{-20}\\\\\n &=\n 1-\\left(\\frac{20^{0}}{0!}\\cdot e^{-20}+\\frac{20^{1}}{1!}\\cdot e^{-20}+\\frac{20^{2}}{2!}\\cdot e^{-20}+\\frac{20^{3}}{3!}\\cdot e^{-20}+\\frac{20^{4}}{4!}\\cdot e^{-20}+\\frac{20^{5}}{5!}\\cdot e^{-20}\\right)\\\\\n &=\n 1-e^{-20}\\cdot \\left(1+20+\\frac{400}{4}+\\frac{8000}{6}+\\frac{160000}{24}+\\frac{3200000}{120}\\right)\\\\\n &=\n 1-e^{-20} \\cdot \\left(\\frac{1 \\cdot 120+20\\cdot 120+400\\cdot 30+8000\\cdot 20+160000\\cdot 24+3200000\\cdot 1}{120}\\right)\\\\\n &= 1-e^{-20}\\cdot\\left(\\frac{4186520}{120}\\right)=1-`r exp(-20)+20*exp(-20)+200*exp(-20)+8000/6*exp(-20)+160000/24*exp(-20)+3200000*exp(-20)/120` =`r 1-( exp(-20)+20*exp(-20)+200*exp(-20)+8000/6*exp(-20)+160000/24*exp(-20)+3200000*exp(-20)/120)`.\n\\end{array}\n$$\n\n  \n\n\n\n## Ejemplo $Po(\\lambda)$ \n\n\n\n\n**Solución 5.**  ¿Cuál es el valor esperado, la varianza y la desviación típica de $X$?\n\n \n El valor esperado del número de insectos caídos  en la trampa en una hora es \n\n$$E(X)=\\lambda=20$$\n\nSu varianza es \n$$Var(X)=\\lambda=20$$\n\ny  su desviación típica vale\n$$\\sqrt{Var(X)}=+\\sqrt{\\lambda}=+\\sqrt{20}=`r round(sqrt(20),5)`.$$\n  \n\n## Cálculos con R\n\nConsideremos por ejemplo una v.a. $X$ con distribución $Po(\\lambda=3)$. Calculemos $P_X(0)=P(X=0), P_X(1)=P(X=1)$ con `R`:\n\n```{r}\ndpois(0,lambda = 3)\ndpois(1,lambda = 3)\n```\n\n## Cálculos con R\n\nSi quisiéramos hallar la función de distribución en los mismos valores anteriores, \n$F_X(0)=P(X\\leq 0), F_X(1)=P(X\\leq 1)$, haríamos lo siguiente:\n\n```{r}\nppois(0,lambda = 3)\nppois(1,lambda = 3)\ndpois(0,lambda = 3)+dpois(1,lambda = 3) ## es igual a ppois(1,lambda=3)\n```\n\n## Cálculos con R\n\nA continuación, comprobemos que $F_X(10)=\\sum\\limits_{x=0}^{10} P_X(x)$:\n\n```{r}\ndpois(0:10,3)\nsum(dpois(0:10,3))\nppois(10,3)\n```\n\n## Cálculos distribución Poisson con R\n\nSi quisiéramos generar una secuencia de $100$ observaciones para una distribución de Poisson de parámetro $\\lambda=3$, $Po(3)$, tendríamos que hacer:\n\n```{r random_pois}\nrpois(n=100,lambda = 3)\n```\n\n## Cálculos con R\n\n  \n**Ejercicio de la trampa para insectos (continuación)**\n\nEn   el ejercicio de la trampa para insectos  teníamos que $X$ es una $Po(20)$. Responded con R  a la preguntas 3 y 4 de este ejercicio\n\n  \n\n\n**Pregunta 3.**  Calculad la probabilidad de  que en una hora caigan en la trampa  exactamente 21 insectos.\n\nRecordemos que la probabilidad pedida es $P(X=21)$:\n\n```{r}\ndpois(21,lambda=20)# P(X=21)\n```\n  \n\n## Cálculos con R\n\n\n**Pregunta 4.**  Calculad la probabilidad de  que en una hora caigan en la trampa  al menos 6 insectos.\n\nRecordemos que la probabilidad pedida es $P(X\\geq 6)=1-P(X<6)=1-P(X\\leq 5)$:\n\n```{r}\nppois(5,lambda=20)\n1-ppois(5,lambda=20) # es 1-P(X<=5)=P(X>=6)\nppois(5,lambda=20,lower.tail =FALSE ) # acumula hacia arriba \n# P(X>5)=P(X>=6)=P(X=6)+P(X=7)+...\n```\n  \n\n## Gráficos  de la distribución Poisson con R\n\n\n::: {.tiny}\n```{r  echo = TRUE,eval=FALSE}\nlambda=20; par(mfrow=c(1,2)); n=qpois(0.99,lambda=lambda)\naux=rep(0,(n+1)*2); aux[seq(2,(n+1)*2,2)]=dpois(c(0:n),lambda=lambda)\nymax=max(ppois(0:n,lambda=lambda)) \nplot(x=c(0:n),y=dpois(c(0:n),lambda=lambda),\n     ylim=c(0,ymax),xlim=c(-1,n+1),xlab=\"x\", ylab=\"Función de probabilidad\",\n     main=paste0(c(\"Función de probabilidad\\n  Po(lambda=\",lambda,\")\")\n                 collapse = \"\"))\nlines(x=rep(0:n,each=2),y=aux,pch=21, type = \"h\", lty = 2,col=\"blue\")\ncurve(ppois(x,lambda=lambda),\n      xlim=c(-1,n+1),col=\"blue\",ylab=\"Función de Distribución\",\n      main=paste0(c(\"Función de distribución \\n Po(lambda=\",lambda,\")\"),\n                  collapse = \"\"))\npar(mfrow=c(1,1))\n```\n:::\n\n## Gráficos  de la distribución Poisson con R\n\n```{r graficosPOISON, fig.align='center',echo=FALSE,out.width=\"70%\"}\nlambda=20\npar(mfrow=c(1,2))\nn=qpois(0.99,lambda=lambda)\naux=rep(0,(n+1)*2)\naux[seq(2,(n+1)*2,2)]=dpois(c(0:n),lambda=lambda)\nymax=max(ppois(0:n,lambda=lambda))\nplot(x=c(0:n),y=dpois(c(0:n),lambda=lambda),\n     ylim=c(0,ymax),xlim=c(-1,n+1),xlab=\"x\",ylab=\"Función de probabilidad\",\n     main=paste0(c(\"Función de probabilidad\\n  Po(lambda=\",lambda,\")\"),collapse = \"\"))\nlines(x=rep(0:n,each=2),y=aux,pch=21, type = \"h\", lty = 2,col=\"blue\")\ncurve(ppois(x,lambda=lambda),\n      xlim=c(-1,n+1),col=\"blue\",ylab=\"Función de Distribución\",\n      main=paste0(c(\"Función de distribución \\n Po(lambda=\",lambda,\")\"),collapse = \"\"))\npar(mfrow=c(1,1))\n```\n\n\n\n\n\n\n\n## Cálculos con python\n\nSea $X$ un una v.a. $Po(\\lambda=3)$. Entonces\n\n$P_X(0)=P(X=0), P_X(1)=P(X=1)$   en este orden son \n\n\n```{python poisson_python}\nfrom scipy.stats import poisson\npoisson.pmf(0,mu = 3)\npoisson.pmf(1,mu = 3)\n\n```\n\n\n## Cálculos con python\n\nSea $X$ un una v.a. $Po(\\lambda=3)$. Entonces\n\n$F_X(0)=P(X\\leq 0), F_X(1)=P(X\\leq 1)$   en este orden son \n\n\n```{python poisson_python_bis}\npoisson.cdf(0,mu = 3)\npoisson.cdf(1,mu = 3)\npoisson.pmf(0,mu = 3)+poisson.pmf(1,mu= 3) \n## es igual a poisson.cdf(1,lambda=3)\n```\n\n\n\n## Cálculos con python\nPor ejemplo  podemos comprobar que $F_X(10)=\\displaystyle\\sum_{0}^{10} P_X(x)$\n\n::: {.tiny}\n```{python poisson_python2}\npoisson.pmf(range(0,10),mu=3)\nsum(poisson.pmf(range(0,10),mu=3))\npoisson.cdf(10,mu=3)\n```\n:::\n\n## Cálculos con python\n\n  \nEn   el ejercicio de la trampa para insectos  teníamos que $X$ es una $Po(20)$. Responded con python a la preguntas 3 y 4 de este ejercicio\n\n  \n\n\n**Pregunta 3.**  Calculad la probabilidad de  que en una hora caigan en la trampa  exactamente 21 insectos.\n\n La  respuesta a la pregunta 3 es calcular  $P(X=21)$ \n\n```{python poisson_py3}\npoisson.pmf(21,mu=20)\n# P(X=21)\n```\n  \n\n## Cálculos con python\n\n\n**Pregunta 4.**  Calculad la probabilidad de  que en una hora caigan en la trampa  al menos 6 insectos.\n\nLa pregunta  4 nos pide calcular $P(X\\geq 6)=1-P(X\\leq 5)$\n\n```{python poisson_py4}\n1-poisson.cdf(5,mu=20) \n# es 1-P(X<=5)=P(X>=6)\n```\n  \n\n## Cálculos con  python\n\nComo ya hemos visto con `scipy.stats` podemos pedir los momentos de una variable aleatoria\n$Po(3)$\n\n\n```{python momentosPOISOON}\npoisson.stats(mu=3, moments='mv')\n```\n\nY también generar secuencias de observaciones aleatorias de una población $Po(3)$\n\n```{python}\npoisson.rvs(mu=3,size=40)\n```\n\n\n\n\n\n## Gráficos con python\n\n\n::: {.small}\n```{python py_poiss1,eval=FALSE,echo=TRUE,size=\"scriptsize\"}\nfrom scipy.stats import poisson\nmu = 10 # mu = lambda\nx = np.arange(poisson.ppf(0.01, mu),poisson.ppf(0.99, mu))\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\nax.plot(x, poisson.pmf(x, mu), 'bo', ms=5, label='poisson pmf')\nax.vlines(x, 0, poisson.pmf(x, mu), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks(): \n  tick.label.set_fontsize(5) \n```  \n:::\n\n## Gráficos con python\n\n::: {.small}\n```{python py_poiss1_2,eval=FALSE,echo=TRUE,size=\"scriptsize\"}\nax = fig.add_subplot(1,2,2)\nax.plot(x, poisson.cdf(x, mu), 'bo', ms=5, label='poisson cdf')\nax.vlines(x, 0, poisson.cdf(x, mu), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  tick.label.set_fontsize(5)\nfig.suptitle('Distribucion de Poisson')\nplt.show()\n```\n:::\n\n## Gráficos con python\n\n```{python py_poiss2_plot,eval=TRUE,echo=FALSE}\nfrom scipy.stats import poisson\nmu = 10 # mu = lambda\nx = np.arange(poisson.ppf(0.01, mu),poisson.ppf(0.99, mu))\nfig =plt.figure(figsize=(5, 2.7))\nax = fig.add_subplot(1,2,1)\n_=ax.plot(x, poisson.pmf(x, mu), 'bo', ms=5, label='poisson pmf')\n_=ax.vlines(x, 0, poisson.pmf(x, mu), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\n_=ax.plot(x, poisson.cdf(x, mu), 'bo', ms=5, label='poisson cdf')\n_=ax.vlines(x, 0, poisson.cdf(x, mu), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\n_=fig.suptitle('Distribucion de Poisson')\n_=plt.show()\n```\n\n\n\n\n\n## Ejemplo proceso Poisson\n\n  \n\n**Número de impactos de insectos en la visera de un casco**\n\nUn colega de trabajo, al que llamaremos  JG, es muy aficionado a los grandes premios de velocidad tanto en coches como en motos.\n\nComo es tan aficionado está obsesionado con  muchas de las más extravagantes estadísticas de estos deportes.\nEn particular le propusimos que estudiara el número de insectos que chocan contra la visera de un casco de un  motorista GP  o de un  conductor de fórmula 1 .\n  \n\n\n## Ejemplo proceso Poisson\n\n  \nLa idea es que el número de insectos  está igualmente repartido por todo el circuito y de promedio impactan $\\lambda>0$ insectos por minuto. También es razonable suponer que:\n\n* podemos dividir la superficie de la visera en cuadrados suficientemente pequeños de forma que la probabilidad de que caigan dos insectos en la misma zona es prácticamente 0. \n* la probabilidad de que un insecto impacte en  un cuadrado cualquiera  de la visera es independiente de cualquier otro cuadrado.\n* si hemos dividido la visera en $n$ cuadrados la probabilidad $p_n$ de impacto de un cuadrado vale $p_n=\\frac{\\lambda}{n}$.\n\nBajo estas condiciones,  si denotamos por $X_t$ como el número de insectos que ha impactado en la visera en  el intervalo $(0,t]$ (en $t$ minutos), podemos afirmar que $X_t$  es un proceso de  Poisson $Po(\\lambda\\cdot t)$.\n\n  \n\n\n## Ejemplo proceso Poisson\n\n \n\nSupongamos que nos dicen que  $\\lambda=3$ insectos por minuto. Entonces el proceso de poisson $X_t$ seguirá un ley $Po(3\\cdot t).$ \n\nAhora estamos en condiciones de  preguntar  al  proceso de Poisson. \n\n¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?\n\nEn este caso $t=10$ $X_{10}$= número de insectos que impactan en 10 minutos, el intervalo $[0,10)$ que sigue  una $P(3\\cdot 10=30)$. Por lo tanto \n\n$$P(X>25)=1-P(X\\leq 25)$$\n\nlo resolvemos con R\n\n```{r}\n1-ppois(25,lambda=30)\n```\n\n  \n\n## Ejemplo proceso Poisson\n\n \n\nOtra pregunta interesante es  que tengamos que esperar más de 2 minutos para observar el primer impacto \n\n$$P(X_2=0)=\\frac{(3\\cdot 2)^0}{0!}\\cdot e^{-3\\cdot 2}= e^{-6}=`r round(exp(-6),6)`.$$\n\nCon R\n\n```{r}\n6^0/factorial(0)*exp(-6)\nppois(0,lambda=3*2)\n```\n\n\n  \n\n\n\n\n\n\n# Distribución hipergeométrica\n\n\n## Modelo de la distribución hipergeométrica\n\nSupongamos que disponemos de una  urna de de sorteos que contiene $m$ bolas blancas y $n$ bolas rojas.\n\nEn total en esta urna  hay $m+n$ bolas, $m$ blancas y $n$ rojas. Si extraemos dos bolas de la urna lo podemos hacer de dos formas:\n\n* Extraer una anotar su color y reponerla. Sacar otra y anotar su color. Hemos extraído  la bola con reposición.\n* Extraer simultáneamente dos bolas (sin reposición) y contar el número de bolas blancas.\n\n## Modelo de la distribución hipergeométrica\n\nSea $X$ es la v.a. que cuenta el número de bolas blancas extraídas.\n\n* En el primer caso, $X$ es una $B(n=2,p=\\frac{m}{m+n})$  ya que consiste en  repetir dos veces el mismo experimento de Bernoulli.\n* En el segundo caso, $X$ sigue una distribución hipergeométrica que estudiaremos en esta sección.\n\n\n## Modelo de la distribución hipergeométrica\n\n\n<l class=\"definition\"> Distribución hipergeométrica </l>\n\nSean $n$, $m$ y $k$ tres número enteros positivos y tales  que $k<m+n$.\n\nConsideremos una urna que contiene $m+n$ bolas de las que $m$ son blancas y las restantes $n$ no (son no blancas).\n\nEl número total de bolas es $m+n$. Extraemos  de forma aleatoria $k$ bolas de la urna sin reemplazarlas.\n\n\n## Modelo de la distribución hipergeométrica\n\nSea  $X$ la v.a. que cuenta el número de bolas blancas extraídas. Diremos que la distribución de $X$ es hipergeométrica de parámetros $m$, $n$ y $k$ y la denotaremos por $H(m,n,k)$.\n\nSu dominio es \n\n$$D_X=\\left\\{x\\in\\mathbf{N}\\mid \\max\\{0,k-n\\}\\leq  x \\leq \\min\\{m,k\\}\\right\\}$$\n\n\nPara explicarlo,  veamos varios ejemplos: \n\n* $H(m=5,n=2,k=3)$. Tenemos  $m=5$ bolas blancas, $n=2$ no blancas y sacamos $k=3$ bolas sin reposición.\n  + En este caso el mínimo de bolas blancas extraídas es $1=k-n=3-2$, ya que sólo hay dos no blancas.\n  + En cambio, el máximo si es $k=3$, ya que tenemos bolas blancas de \"sobra\". \n  \n## Modelo de la distribución hipergeométrica \n\n$$D_X=\\left\\{x\\in\\mathbf{N}\\mid \\max\\{0,k-n\\}\\leq  x \\leq \\min\\{m,k\\}\\right\\}$$\n\n* $H(m=2,n=5,k=3)$. Tenemos $m=2$ bolas blancas, $n=5$ no blancas y sacamos $k=3$ bolas sin reposición. \n  + En este caso el mínimo de bolas blancas es $0$ ya que puedo sacar 3 no blancas.\n  + En cambio, el máximo si es $m=2$, ya que aunque saquemos $k=3$ bolas, al llegar a 2 ya hemos  extraído todas las bolas blancas de la urna.  \n\n* $H(m=10,n=10,k=3)$. Tenemos $m=10$ bolas blancas, $n=10$ no blancas y sacamos $k=3$ bolas sin reposición. \n  + En este caso podemos obtener desde $0$ blancas hasta $k=3$ blancas.\n\n\n## Modelo de la distribución hipergeométrica\n\nSu función de probabilidad es:\n\nSu función de probabilidad es:\n$$\nP_{X}(x)=\\left\\{\n\\begin{array}{ll}\n\\frac{\\binom{m}{x}\\cdot \\binom{n}{k-x}}{\\binom{m+n}{k}}, & \\mbox{ si }\n\\max\\{0,k-n\\}\\leq x \\leq \\min\\{m,k\\}, \\mbox { para  } x\\in \\mathbf{N},\\\\\n0,  & \\mbox{en otro caso.}\\end{array}\\right.\n$$\n\n\n## Distribución hipergeométrica\n\n<l class=\"observ\"> **Observación: otras parametrizaciones** </l>\n\n\nEn ocasiones se parametriza una v.a. hipergeométrica mediante $N=m+n$, número total de bolas, \n$k$, número de extracciones y $p$, probabilidad de extraer una bola blanca. \n\n\nAsí podemos **parametrizar alternativamente** la distribución hipergeométrica así \n\n$$H(N,k,p)\\mbox{ donde } p=\\frac{m}{N}.$$\n\n## Resumen distribución   Hipergeométrica  $H(m,n,k)$.\n\n\\renewcommand{\\arraystretch}{1.75}\n\\begin{table}\n\\centering\n\\begin{tabular}{|l|}\n\\hline\\rowcolor{LightBlue}\n$X= \\left\\{\\begin{array}{l}\n\\mbox{número de bolas blancas  en $k$ extracciones}\\\\\n\\mbox{sin reposición de una urna con} $m$\\\\\n\\mbox{bolas blancas y }$n$ \\mbox{ negras.}\n\\end{array}\\right.$;  $H(m,n,k)$\n\\\\\\hline\n$D_X=\\left\\{x\\in\\mathbb{N}\\mid \\max\\{0,k-n\\}\\leq  x \\leq \\min\\{m,k\\}\\right\\}$\\\\\\hline\n$P_X(x)=P(X=x)=\\left\\{\n\\begin{array}{ll}\n\\frac{\\binom{m}{x}\\cdot \\binom{n}{k-x}}{\\binom{m+n}{k}}, & \\mbox{ si }\n\\max\\{0,k-n\\}\\leq x \\leq \\min\\{m,k\\}, \\\\\n0,  & \\mbox{en otro caso.}\\end{array}\\right.$\\\\\\hline\n$F_X(x)=P(X\\leq x)$.\\\\\\hline\n$E(X)=\\frac{k\\cdot m}{m+n}$; $Var(X)=k\\cdot\\frac{m}{m+n}\\cdot\\left(1-\\frac{m}{m+n}\\right) \\cdot\\frac{m+n-k}{m+n-1}$\n\\\\\\hline\n\\end{tabular}\n\\end{table}\n\n\n\n\n## Ejemplo clásico urna $m=15$ blancas, $n=10$ rojas y $k=3$ extracciones sin reposición.\n\n  \n**Urna con bolas blancas y rojas**\n\nTenemos una urna con 15 bolas blancas y 10 bolas rojas. Extraemos al azar tres bolas de la urna sin reposición. Sea  $X$ el número de bolas **blancas** extraídas. Bajo esta condiciones, la v.a. $X$ sigue una ley de distribución $H(m=15,n=10,k=3)$.\n\n  \n\n\n\n\n\nLa función de probabilidad es \n\n\n$$\nP_X(x)=P(X=x)=\\left\\{\n\\begin{array}{ll}\n\\frac{\\binom{m}{x}\\cdot \\binom{n}{k-x}}{\\binom{m+n}{k}} & \\mbox{ si }\n\\max\\{0,k-n\\}\\leq x \\leq \\min\\{m,k\\} \\mbox { para  } x\\in \\mathbf{N}\\\\\n0  & \\mbox{en otro caso}\\end{array}\\right.,\n$$\n\n$$\\mbox{sustituyendo }\\scriptsize{\nP_X(x)=P(X=x)=\\left\\{\n\\begin{array}{ll}\n\\frac{\\binom{15}{x}\\cdot \\binom{10}{3-x}}{\\binom{25}{3}} & \\mbox{ si }\n0\\leq x \\leq 3 \\mbox { para  } x\\in \\mathbf{N}\\\\\n0  & \\mbox{en otro caso}\\end{array}\\right.\n}$$\n\n\n  \n\n\n## Ejemplo clásico urna $m=15$ blancas, $n=10$ rojas y $k=3$ extracciones sin reposición.\n\n\n\nLa probabilidad de sacar 2 blancas será\n\n$$\nP(X=2)=\\frac{\\binom{15}{2}\\cdot \\binom{10}{3-2}}{\\binom{25}{3}}\n$$ \n\n```{r}\nc(choose(15,2), choose(10,1), choose(25,3))\n```\n\n\n$P(X=2)=\\frac{`r choose(15,2)`\\cdot`r choose(10,1)` }{`r choose(25,3)`}=`r choose(15,2)*choose(10,1)/choose(25,3)`.$\n\n```{r eval=FALSE,echo=FALSE}\nphyper(2,15,10,3)\n```\n\n  \n\n## Ejemplo clásico urna $m=15$ blancas, $n=10$ rojas y $k=3$ extracciones sin reposición.\n\n\n\nLa probabilidad de que saquemos más de   1 bola blanca es\n\n$$\n\\begin{array}{rl}\nP(X> 1)&= 1-P(X\\leq 1)=1-(P(X=0)+P(X=1))\\\\\n&=\n1-\\left(\\frac{\\binom{15}{0}\\cdot \\binom{10}{3}}{\\binom{25}{3}}+\n\\frac{\\binom{15}{1}\\cdot \\binom{10}{2}}{\\binom{25}{3}}\\right)\\\\\n&=\n1-\\left(\n\\frac{`r choose(15,0)`\\cdot`r choose(10,3)` }{`r choose(25,3)`}+\\frac{`r choose(15,1)`\\cdot`r choose(10,2)` }{`r choose(25,3)`}\n\\right)=1-\\frac{120+15\\cdot 45}{2300}=`r 1-(choose(15,0)*choose(10,3)+choose(15,1)*choose(10,2))/choose(25,3)`.\n\\end{array}\n$$\n\n  \n\n\n## Ejemplo clásico urna $m=15$ blancas, $n=10$ rojas y $k=3$ extracciones sin reposición.\n\n\n\n\nEl número esperado de  bolas blancas extraídas para una v.a. $X$ $H(m=15,n=10,k=3)$ es \n\n$$E(X)=\\frac{k\\cdot m}{m+n}=\\frac{3\\cdot 15}{15+10}=\\frac{45}{35}=`r round(45/35,6)`.$$\n\n\n\nLa varianza vale:\n$$\n\\begin{array}{rl}\nVar(X)&=k\\cdot\\frac{m}{m+n}\\cdot\\left(1-\\frac{m}{m+n}\\right) \\cdot\\frac{m+n-k}{m+n-1}\\\\\n&=3\\cdot\\frac{15}{15+10}\\cdot\\left(1-\\frac{15}{15+10}\\right) \\cdot\\frac{15+10-3}{15+10-1}\\\\\n&=\n3\\cdot\\frac{15}{25}\\cdot\\left(1-\\frac{15}{25}\\right) \\cdot\\frac{22}{24}= \n3\\cdot\\frac{15}{25}\\cdot\\frac{25-15}{25} \\cdot\\frac{22}{24}\\\\\n&=\n3\\cdot\\frac{15}{25}\\cdot\\frac{10}{25}\\cdot\\frac{22}{24}=`r 3*15/25*10/25*22/24`.\n\\end{array}\n$$\n\nY por lo tanto su desviación típica es $+\\sqrt{Var(X)}=+\\sqrt{0.66}=`r round(sqrt(0.66),6)`.$\n\n\n## Cálculos con R\n\nSea $X$ una v.a. $H(m,n,k)$. La función de `R` para calcular la función de probabilidad en un valor $x$, $P(X=x)$, es `dhyper(x,m,n,k)` y para calcular la función de distribución en un valor $q$, $P(X\\leq q)$, es `phyper(q,m,n,k)`. Para generar una muestra de valores que siga la distribución $H(m,n,k)$, hay que usar la función `rhyper(nn,m,n,k)` donde `nn` es el número de observaciones aleatorias deseado de la muestra.\n\nPor ejemplo, si $X$ es una $H(m=15,n=10,k=3)$, los valores de $P(X=2)$ y que $P(X>1)=1-P(X\\leq 1)$ son:\n\n## Cálculos con R\n\n```{r}\ndhyper(x=2,m=15,10,k=3)\nphyper(q=1,m=15,n=10,k=3)# sí, le han puesto q ya veremos el porqué\n1-phyper(q=1,m=15,n=10,k=3)\n```\n\n## Cálculos con R\n\nUna muestra aleatoria de este experimento de tamaño 200 sería:\n\n```{r}\nrhyper(nn=200,m=15,n=10,k=3)\n```\n\n\n## Gráficas  con R\n\n```{r fig.align='center',echo=FALSE}\npar(mfrow=c(1,2))\nm=15\nn=10\nk=3\na=max(c(0,k-n))\nb=min(c(m,k))\nl=b-a+1\naux=rep(0,2*l)\naux[seq(2,2*l,2)]=dhyper(c(a:b),m=m,n=n,k=k)\nx=a:b\nplot(x,y=dhyper(x,m=m,n=n,k=k),\n  ylim=c(0,0.6),xlim=c(a-1,b+1),xlab=\"x\",\n  main=paste0(\"Función de probabilidad\\n H(m=\",m,\", n=\",n,\", k=\",k,\")\"))\nlines(x=rep(a:b,each=2),y=aux, type = \"h\", lty = 2,col=\"blue\")\ncurve(phyper(x,m=m,n=n,k=k),\n  xlim=c(a-1,b+1),col=\"blue\",\n  main=paste0(\"Función de distribución\\n H(m=\",m,\", n=\",n,\", k=\",k,\")\"))\npar(mfrow=c(1,1))\n```\n\n\n\n## Cálculos con python \n\n\nSea $X$ una $H(m,n,k)$, las funciones de `scipy.stats` cambian los parámetros \n\n\n* $M$ es el número total de bolas. Con nuestra parametrización $M=m+n$.\n* $n$ es el número de bolas blancas. Con nuestra parametrización $n=m$.\n* $N$  es el número de extracciones. Con nuestra parametrización $N=k$.\n\n```{python}\nfrom scipy.stats import hypergeom\n```\n\n## Cálculos con python \n\n```{python}\nhypergeom.pmf(1,M=15+10,n=15,N=3)\nhypergeom.cdf(1,M=15+10,n=15,N=3)\n1-hypergeom.cdf(1,M=15+10,n=15,N=3)\n```\n\n## Cálculos con python \n\nUna muestra aleatoria de este experimento sería... \n```{python}\nhypergeom.rvs(M=15+10,n=15,N=3,size=100)\n```\n\n\n## Gráficos con python\n\n::: {.small}\n```{python py_hyper2:1,eval=FALSE,echo=TRUE}\nfrom scipy.stats import hypergeom\n[M, n, N] = [20, 7, 12] ##20 elementos, 7 del tipo, extraemos 12\nx = np.arange(max(0, N-M+n),min(n, N))\nfig =plt.figure(figsize=(5, 2.7))\n =ax = fig.add_subplot(1,2,1)\n =ax.plot(x, hypergeom.pmf(x, M, n, N), 'bo', ms=5, label='hypergeom pmf')\n =ax.vlines(x, 0, hypergeom.pmf(x, M, n, N), colors='b', lw=2, alpha=0.5)\n =ax.set_ylim([0, max(hypergeom.pmf(x, M, n, N))*1.1])\n```\n:::\n\n\n \n## Gráficos con python\n\n::: {.small}\n```{python py_hyper2_1_0,eval=FALSE,echo=TRUE}\n\nfor tick in ax.xaxis.get_major_ticks():\n   =tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  =tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\n =ax.plot(x, hypergeom.cdf(x, M, n, N), 'bo', ms=5, label='hypergeom cdf')\n =ax.vlines(x, 0, hypergeom.cdf(x, M, n, N), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n   =tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n   =tick.label.set_fontsize(5)\n =fig.suptitle('Distribucion Hipergeometrica')\n =plt.show()\n```\n:::\n\n## Gráficos con python\n\n\n```{python py_hyper2,eval=TRUE,echo=FALSE}\nfrom scipy.stats import hypergeom\n[M, n, N] = [20, 7, 12] ##20 elementos, 7 del tipo, extraemos 12\nx = np.arange(max(0, N-M+n),min(n, N))\nfig =plt.figure(figsize=(5, 2.7))\n_=ax = fig.add_subplot(1,2,1)\n_=ax.plot(x, hypergeom.pmf(x, M, n, N), 'bo', ms=5, label='hypergeom pmf')\n_=ax.vlines(x, 0, hypergeom.pmf(x, M, n, N), colors='b', lw=2, alpha=0.5)\n_=ax.set_ylim([0, max(hypergeom.pmf(x, M, n, N))*1.1])\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5) \nax = fig.add_subplot(1,2,2)\n_=ax.plot(x, hypergeom.cdf(x, M, n, N), 'bo', ms=5, label='hypergeom cdf')\n_=ax.vlines(x, 0, hypergeom.cdf(x, M, n, N), colors='b', lw=2, alpha=0.5)\nfor tick in ax.xaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\nfor tick in ax.yaxis.get_major_ticks():\n  _=tick.label.set_fontsize(5)\n_=fig.suptitle('Distribucion Hipergeometrica')\n_=plt.show()\n```","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":8,"fig-height":6,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["parse-latex"],"output-file":"distibuciones_notables_1.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.6.40","bibliography":["references.bib"],"theme":["materia","custom.scss"],"cover-image":"100_prisoners_boxes_fixed.png","toggle":true,"code-copy":true,"code":{"linenums":true,"highlight":"tango"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":6,"fig-height":4,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","filters":["parse-latex"],"toc":true,"toc-depth":3,"output-file":"distibuciones_notables_1.pdf"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"lang":"es","documentclass":"scrreprt","highlight":"tango","numbersections":true,"code":{"linenums":true,"highlight":"tango"}},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}