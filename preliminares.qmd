# Preliminares: conjuntos y combinatoria

Para aprender cálculo de probabilidades son necesarios conocimientos de:

1.  **Cálculo**: derivadas, integrales, límites, sumas de series…
2.  **Geometría básica y álgebra lineal**: rectas, hiperplanos, volúmenes… matrices, valores propios…
3.  **Teoría de conjuntos y combinatoria** (matemática discreta).

Por experiencia sabemos que la mayoría de estudiantes tienen más conocimientos de cálculo, geometría y matrices. Sin embargo, muchos presentan carencias en teoría básica de conjuntos y combinatoria, que será necesaria en este curso.

## Teoría de conjuntos

La definición de conjunto es una [idea o noción primitiva](https://es.wikipedia.org/wiki/Concepto_primitivo). Es decir, es una idea básica del pensamiento humano: un conjunto es una colección de objetos (números, imágenes, palabras, jugadores de fútbol, colores, etc.).

La teoría de conjuntos **básica** es simple y natural, y es la que necesitamos para este curso.

La teoría de conjuntos **axiomática** es más compleja y presenta varias paradojas si no se formaliza adecuadamente, como la [paradoja de Russell](https://es.wikipedia.org/wiki/Paradoja_de_Russell).

La idea práctica de conjunto es la de una colección de objetos de un cierto tipo. Estas colecciones o conjuntos se pueden definir por:

-   **Comprensión**: reuniendo los objetos que cumplen una propiedad $p$.
-   **Extensión**: dando una lista exhaustiva de los miembros del conjunto.

### Conjuntos básicos

A menudo trabajaremos dentro de un conjunto base (o “universo”). Ejemplos habituales son:

-   $\mathbb{N}=\{0,1,2,\ldots\}$

-   $\mathbb{Z}=\{\ldots,-2,-1,0,1,2,\ldots\}$

-   $\mathbb{Q}=\left\{\frac{p}{q}\ \Big|\ p,q\in \mathbb{Z} \text{ y } q \neq 0\right\}$

-   $\mathbb{R}$: conjunto de los números reales (puntos de una recta).

-   $\mathbb{C}= \left\{a+b\, i\ \big|\ a,b\in \mathbb{R}\right\}$, conjunto de los números complejos.

-   Alfabeto $=\{a,b,c,\ldots, A,B,C,\ldots\}$.

-   Palabras $=\{\text{paz, guerra, amor, probabilidad},\ldots\}$.

Recordemos que $i$ es la unidad imaginaria y cumple $i^2=-1$ (equivalentemente, $i=\sqrt{-1}$).

### Características y propiedades básicas de los conjuntos

Si $x$ es un objeto de $\Omega$, diremos que $x$ es **elemento** del conjunto $\Omega$ y que $x$ **pertenece** a $\Omega$. Lo denotaremos por $x\in \Omega$.

Un **conjunto con un solo elemento**, por ejemplo $\{1\}$, recibe el nombre de **conjunto unitario** (o *singleton*).

Sean $A$ y $B$ dos conjuntos. Diremos que $A$ **es igual a** $B$ si todos los elementos de $A$ están en $B$ y todos los elementos de $B$ están en $A$. Por ejemplo, $A=\{1,2,3\}$ es igual a $B=\{3,1,2\}$.

Diremos que $A$ es un **subconjunto** de $B$ (o que está contenido en $B$) si se cumple que, para todo $x$, si $x\in A$ entonces $x\in B$. Lo denotaremos por $A\subseteq B$.

El conjunto que no tiene elementos se denomina **conjunto vacío** y se denota por $\emptyset$. Dado un conjunto cualquiera $A$, se cumple $\emptyset\subseteq A$.

::::: callout-ejemplo
::: callout-title
Ejemplo
:::
::: callout-body
Tomemos como conjunto base $\Omega=\{1,2,3\}$.

- $\Omega$ es un conjunto de cardinal 3; se denota por $\#(\Omega)=3$ o por $|\Omega|=3$.
- El conjunto $\Omega$ tiene $2^3=8$ subconjuntos:
  - el vacío $\emptyset$ y los unitarios $\{1\}$,\{2\}$,\{3\}$,
  - los subconjuntos de dos elementos: $\{1,2\}$,\{1,3\}$,\{2,3\}$,
  - el conjunto total: $\Omega=\{1,2,3\}$.
:::
:::::

Dado un conjunto $\Omega$, podemos construir el **conjunto de todas sus partes** (todos sus subconjuntos), que denotamos por $\mathcal{P}(\Omega)$.

::::: callout-ejemplo
::: callout-title
Cardinal de las partes de un conjunto
:::
::: callout-body
Por ejemplo para $\Omega=\{1,2,3\}$, el conjunto de todas sus partes es $\mathcal{P}(\{1,2,3\})$ y tiene cardinal

$$
\#\big(\mathcal{P}(\{1,2,3\})\big)=2^{\#(\{1,2,3\})}=2^3=8.
$$
:::
:::::

En efecto,

$$
\mathcal{P}(\{1,2,3\})=\{\emptyset,\{1\},\{2\},\{3\},\{1,2\},\{1,3\},\{2,3\},\{1,2,3\}
\}.
$$


Dado un subconjunto $A\subseteq \Omega$, podemos construir la función característica de $A$,
$\chi_A:\Omega \to \{0,1\}$, y para $\omega\in \Omega$ se define como

$$
\chi_A(\omega)=
\begin{cases}
1 & \text{si }\omega \in A,\\
0 & \text{si }\omega \notin A.
\end{cases}
$$

### Operaciones entre conjuntos

::::: callout-definicion
::: callout-title
**Intersección**
:::
::: callout-body

Sea $\Omega$ un conjunto y $A$ y $B$ dos subconjuntos de $\Omega$.

La **intersección** de $A$ y $B$ es el conjunto formado por todos los elementos que **pertenecen** a $A$ **y** a $B$. Se denota por $A\cap B$.

Más formalmente,
$$
A\cap B=\left\{x\in\Omega \,\big|\, x\in A \text{ y } x\in B\right\}.
$$
:::
:::::

::::: callout-definicion
::: callout-title
**Unión**
:::
::: callout-body
La **unión** de $A$ y $B$ es el conjunto formado por todos los elementos que **pertenecen** a $A$ **o** pertenecen a $B$ (o a ambos). Se denota por $A\cup B$.

Más formalmente,
$$
A\cup B=\left\{x\in\Omega \,\big|\, x\in A \text{ o } x\in B\right\}
$$.
:::
:::::

::::: callout-definicion
::: callout-title
Diferencia
:::
::: callout-body
La **diferencia** de $A$ y $B$ es el conjunto formado por los elementos que pertenecen a $A$ **y no** pertenecen a $B$. Se denota por $A\setminus B$.

Más formalmente,

$$
A\setminus B=\left\{x\in\Omega \,\big|\, x\in A \text{ y } x\notin B\right\}.
$$
:::
:::::

::::: callout-definicion
::: callout-title
Complementario
:::
::: callout-body
El **complementario** de un subconjunto $A$ de $\Omega$ es $\Omega\setminus A$ y se denota por $A^c$ o $\overline{A}$.

Más formalmente,
$$
A^c=\left\{x\in\Omega \,\big|\, x\not\in A\right\}.
$$
:::
:::::

### Más propiedades

Sea $\Omega$ un conjunto y $A$, $B$, $C$ tres subconjuntos de $\Omega$.

-   Se dice que dos conjuntos $A$ y $B$ **son disjuntos** si $A\cap B=\emptyset$.
-   $\Omega^c=\emptyset$.
-   $\emptyset^c=\Omega$.
-   $A\cup B=B \cup A$, $A\cap B=B\cap A$ (conmutativas).
-   $(A\cup B) \cup C = A \cup( B \cup C)$, $(A\cap B) \cap C = A \cap( B \cap C)$ (asociativas).
-   $A\cup (B\cap C)=(A\cup B) \cap (A\cup C)$, $A\cap (B\cup C)=(A\cap B) \cup (A\cap C)$ (distributivas).
-   $\left(A^c\right)^c=A$ (doble complementario).
-   $\left(A\cup B\right)^c=A^c \cap B^c$, $\left(A\cap B\right)^c=A^c \cup B^c$ ([leyes de De Morgan](https://es.wikipedia.org/wiki/Leyes_de_De_Morgan)).

### Con R: ejemplos

Con R los conjuntos se pueden representar como vectores:

```{r}
Omega <- c(1,2,3,4,5,6,7,8,9,10)
A <- c(1,2,3,4,5)
B <- c(1,4,5)
C <- c(4,6,7,8)
Omega
```

```{r}
A
B
C
```

$A\cap B$

```{r}
intersect(A,B)
```

$A\cup B$

```{r}
union(A,B)
```

$B\setminus C$

```{r}
setdiff(B,C)
```

$A^c=\Omega\setminus A$

```{r}
setdiff(Omega,A)
```

### Con Python

```{python}
Omega=set([1,2,3,4,5,6,7,8,9,10])
A=set([1,2,3,4,5])
B=set([1,4,5])
C=set([4,6,7,8])
Omega
```

```{python}
A
B
C
```

```{python}
A & B   # intersección
A | B   # unión
```

```{python}
A - C   # diferencia
Omega - C # complementario
```

## Combinatoria

La combinatoria es una rama de la matemática discreta que, entre otras cosas, cuenta configuraciones posibles de objetos de un conjunto.

Por ejemplo, si tenemos un equipo de baloncesto con 7 jugadores, ¿cuántos equipos distintos de 5 jugadores podemos formar?

### Número binomial

::::: callout-definicion
::: callout-title
Número combinatorio o número binomial
:::
::: callout-body
Da el número de subconjuntos de tamaño $k$ de un conjunto de tamaño $n$. Este número es:
$$
C_n^k=\binom{n}{k} = \frac{n!}{k!\,(n-k)!}.
$$

Recordemos que

$$
n!=1\cdot 2\cdot 3\cdots n.
$$
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejemplo
:::
::: callout-body
En nuestro caso, con 7 jugadores ($n=7$) y equipos de 5 ($k=5$):

$$
\binom{7}{5} = \frac{7!}{5!\,2!}
=\frac{6\cdot 7}{2}
=21.
$$

Por tanto, puedo formar 21 equipos distintos.
:::
:::::

::::: callout-ejercicio
::: callout-title
Ejercicio: el paquete `gtools`
:::
::: callout-body
Carga el paquete `gtools` de R e investiga la función `combinations(n, r, v, set, repeats.allowed)` para calcular todas las combinaciones anteriores.
:::
:::::

### Combinaciones con repetición

En combinatoria, las combinaciones con repetición son selecciones en las que se permite repetir elementos.

::::: callout-definicion
::: callout-title
Combinaciones con repetición
:::
::: callout-body
El número $CR_n^k$ de multiconjuntos de tamaño $k$ escogidos de un conjunto con $n$ elementos es:
$$
CR_n^k = \binom{n+k-1}{k} = \frac{(n+k-1)!}{k!(n-1)!}.
$$
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejemplo: caramelos
:::
::: callout-body
Repartimos 12 caramelos entre 4 personas (A, B, C, D). El número de repartos posibles es:
$$
CR_4^{12} = \binom{4+12-1}{12}=\binom{15}{12}=\texttt{`r choose(15,12)`}.
$$
:::
:::::

### Variaciones (sin repetición)

Con los números $\{1,2,3\}$, ¿cuántos números de dos cifras distintas podemos formar sin repetir ninguna cifra?

Se pueden escribir:
$$
12,13,21,23,31,32.
$$
Luego hay 6 casos: son las variaciones de orden $k=2$ de un conjunto de $n=3$ elementos.

::::: callout-definicion
::: callout-title
Variaciones (sin repetición)
:::
::: callout-body
Denotaremos las variaciones (sin repetición) de $k$ elementos de un conjunto de $n$ elementos por $V_n^k$. Su valor es:
$$
V_n^k=\frac{n!}{(n-k)!}.
$$
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejemplo
:::
::: callout-body
En nuestro ejemplo, con $n=3$ y $k=2$:
$$
V_3^2=\frac{3!}{(3-2)!}=6.
$$
:::
:::::

::::: callout-definicion
::: callout-title
Ejercicio
:::
::: callout-body
Carga el paquete `gtools` de R e investiga la función `permutations(n, r, v, set, repeats.allowed)` para calcular todas las variaciones anteriores.
:::
:::::

### Variaciones con repetición

¿Y si en el caso anterior permitimos que se repita algún dígito?

::::: callout-definicion
::: callout-title
Variaciones con repetición
:::
::: callout-body
Las variaciones de orden $k$ de un conjunto de $n$ elementos permitiendo repeticiones se denotan por $VR_n^k$ y valen:
$$
VR_n^k=n^k.
$$
:::
:::::

::::: callout-definicion
::: callout-title
Ejemplo
:::
::: callout-body
En nuestro caso:
$$
11,12,13,21,22,23,31,32,33,
\qquad
VR_3^2=3^2=9.
$$
:::
:::::

### Permutaciones

::::: callout-definicion
::: callout-title
Permutaciones
:::
::: callout-body
Las permutaciones de un conjunto de cardinal $n$ son las variaciones de orden máximo $n$. Se denotan por $P_n$ y valen:
$$
P_n=V_n^n=n!.
$$
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejemplo (R)
:::
::: callout-body
Por ejemplo, todas las permutaciones de $\{1,2,3\}$ son:

```{r,warning=FALSE,message=FALSE}
library(combinat)
for(permutacion in permn(3)) print(permutacion)
```

Efectivamente, $P_3=3!=1\cdot 2\cdot 3$.
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejercicio
:::
::: callout-body
En R, investiga la función `permn` del paquete `combinat`.

En Python, investiga el paquete `itertools` y la función `comb` de `scipy.special` para las distintas formas de contar vistas en este tema (evita `scipy.misc`, que está deprecado).
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejercicio (función Gamma)
:::
::: callout-body
La función Gamma de Euler cobrará mucha importancia en el curso de estadística. Comprueba que `gamma(x+1)` da el mismo valor que `factorial(x)` en R para todo $x\in\{1,2,3,\ldots,10\}$.
:::
:::::

### Números multinomiales. Permutaciones con repetición

::::: callout-definicion
::: callout-title
Permutaciones con repetición (multinomial)
:::
::: callout-body
Consideremos un conjunto de elementos $\{a_1, a_2, \ldots, a_k\}$.

Si cada objeto $a_i$ aparece repetido $n_i$ veces (para $i=1,\ldots,k$) y $n=n_1+n_2+\cdots+n_k$, entonces el número de permutaciones con repetición es:

$$
PR_n^{n_1,\ldots,n_k}
= \binom{n}{n_1\ n_2\ \cdots n_k}
= \frac{n!}{n_1!\,n_2!\cdots n_k!}.
$$
:::
:::::

::::: callout-ejemplo
::: callout-title
Ejercicio
:::
::: callout-body
¿Cuántas palabras diferentes se pueden formar con las letras de la palabra `PROBABILIDAD`?

Las letras A, B, D e I aparecen 2 veces cada una; y L, O, P, R aparecen 1 vez cada una. Por tanto:
$$
\frac{12!}{(2!)^4}=29\,937\,600.
$$
:::
:::::

## Para acabar

### Principios básicos para contar cardinales de conjuntos

::::: callout-teorema
::: callout-title
El principio de la suma
:::
::: callout-body
Sean $A_1, A_2,\ldots, A_n$ conjuntos disjuntos dos a dos, es decir, $A_i\cap A_j=\emptyset$ para todo $i\neq j$. Entonces
$$
\#\left(\bigcup_{i=1}^n A_i\right)=\sum_{i=1}^n \#(A_i).
$$
:::
:::::

::::: callout-teorema
::: callout-title
Principio de inclusión-exclusión (para 2 conjuntos)
:::
::: callout-body
Para dos conjuntos cualesquiera $A_1, A_2$, el cardinal de su unión es:
$$
\#(A_1\cup A_2)=\#(A_1)+\#(A_2)-\#(A_1\cap A_2).
$$
:::
:::::

::::: callout-teorema
::: callout-title
El principio del producto
:::
::: callout-body
Sean $A_1,A_2,\ldots,A_n$. Entonces:
$$
\#(A_1\times \cdots \times A_n)
=\prod_{i=1}^n \#(A_i).
$$
:::
:::::

### Otros aspectos a tener en cuenta

Nos hemos dejado otras propiedades básicas de teoría de conjuntos y combinatoria, como:

- Propiedades de los números binomiales:
  1. $\binom{m}{0}=1$ y $\binom{m}{m}=1$ para todo $m\in \mathbb{N}$.
  2. $\binom{m}{n}=\binom{m}{m-n}$.
  3. $\binom{m}{n}=\binom{m-1}{n}+\binom{m-1}{n-1}$.

- Binomio de Newton:
$$
(a+b)^n=\sum_{k=0}^n  \binom{n}{k}\, a^k\, b^{n-k}.
$$
En particular,
$$
(1+1)^n=\sum_{k=0}^n \binom{n}{k}=2^n,
\qquad
(1-1)^n=\sum_{k=0}^n \binom{n}{k}(-1)^{n-k}=0.
$$

- Número multinomial y multinomio:

$$
(a_1+\cdots + a_k)^n
=\sum_{n_1+\cdots + n_k=n}
\binom{n}{n_1\, \cdots\, n_k}\,
a_1^{n_1}\cdots a_k^{n_k},
$$

donde


$$
\binom{n}{n_1\, \cdots\. n_k}
= \frac{n!}{n_1!\cdots n_k!}.
$$
Además, se cumple la siguiente identidad
$$
\binom{n}{n_1\ \cdots\ n_k}
=  \binom{n}{n_1}\binom{n-n_1}{n_2}\cdots \binom{n-n_1-\cdots -n_{k-1}}{n_k}.
$$

Si nos son necesarias, las volveremos a utilizar a lo largo del curso o bien daremos enlaces para que las podáis estudiar en paralelo.
